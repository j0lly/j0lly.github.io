<!DOCTYPE html>
<html lang="it" prefix="og: http://ogp.me/ns#">
	<head>
		<link href="http://gmpg.org/xfn/11" rel="profile">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta http-equiv="content-type" content="text/html; charset=utf-8">

		<!-- Metadata -->
	<meta name="description" content="Sono Josè, un Systems Engineer appassionato di informatica ed altre cose più o meno adrenaliniche... Cerco ogni giorno di imparare e trasmettere quello che sò ">
	<meta property="og:description" content="Sono Josè, un Systems Engineer appassionato di informatica ed altre cose più o meno adrenaliniche... Cerco ogni giorno di imparare e trasmettere quello che sò ">
	<meta property="og:title" content="[Python] I Socket: un client TCP-IP" />
	<meta property="og:type" content="article" />
	<meta property="og:url" content="https://www.j0llyb0x.org/2013/python-i-socket-un-client-tcp-ip.html" />
		<meta property="og:image" content="https://www.j0llyb0x.org/images/logo-color.png" />

		<!-- Enable responsiveness on mobile devices-->
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

		<title>j0llyb0x - Learn or die trying</title>

		<!-- CSS -->
		<link href="//fonts.googleapis.com/" rel="dns-prefetch">
		<link href="//fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic|Abril+Fatface|PT+Sans:400,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet">

		<link rel="stylesheet" href="https://www.j0llyb0x.org/theme/css/poole.css" />
		<link rel="stylesheet" href="https://www.j0llyb0x.org/theme/css/hyde.css" />
		<link rel="stylesheet" href="https://www.j0llyb0x.org/theme/css/syntax.css" />
			<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.1.7/css/fork-awesome.min.css" crossorigin="anonymous">

		<!-- Feeds -->
<link href="https://www.j0llyb0x.org/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="j0llyb0x Full Atom Feed" />
<link href="https://www.j0llyb0x.org/feeds/programming.atom.xml" type="application/atom+xml" rel="alternate" title="j0llyb0x Categories Atom Feed" />

		<!-- Analytics -->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-18259053-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-18259053-2');
</script>
	</head>

	<body class="theme-base-0b">
<div class="sidebar">
	<div class="container sidebar-sticky">
		<div class="sidebar-about">

			<h1>
				<a href="/">
					<img class="profile-picture" src="https://www.j0llyb0x.org/images/logo-color.png">
					j0llyb0x
				</a>
			</h1>
			<p class="lead"></p>
			<p class="lead">Sono Josè, un Systems Engineer appassionato di informatica ed altre cose più o meno adrenaliniche... Cerco ogni giorno di imparare e trasmettere quello che sò  </p>
			<p></p>
		</div>
			<ul class="sidebar-nav">
					<li><a href="/categories.html">Categories</a></li>
					<li><a href="/archives.html">All Articles</a></li>
			</ul>
		<nav class="sidebar-social">
					<a class="sidebar-social-item" href="mailto:jos.ferraris@gmail.com">
						<i class="fa fa-envelope"></i>
					</a>
					<a class="sidebar-social-item" href="https://github.com/j0lly" target="_blank">
						<i class="fa fa-github"></i>
					</a>
					<a class="sidebar-social-item" href="https://www.linkedin.com/in/joseferraris/" target="_blank">
						<i class="fa fa-linkedin"></i>
					</a>
			<a class="sidebar-social-item" href="https://www.j0llyb0x.org/feeds/all.atom.xml">
				<i class="fa fa-rss"></i>
			</a>
		</nav>
			<p class="sidebar-footer">&copy; j0llyb0x.org 2011-2015</p>
	</div>
</div>		<div class="content container">
<div class="post">
	<h1 class="post-title">[Python] I Socket: un client TCP-IP</h1>
	<span class="post-date">Tue 18 June 2013</span>
	<p>Ho trovato alcune guide molto interessanti per la programmazione dei socket in Python, ed ho deciso di cominciare a studiare un po il linguaggio.</p>
<p><img alt="socket" src="https://www.j0llyb0x.org/images/socket-2.jpg">
Quale situazione migliore se non quella di commentare gli esercizi per fissare il tutto e, per chi fosse interessato, insegnare qualcosa.</p>
<p>Premetto che il codice e la procedure è tutto tranne farina del mio sacco:</p>
<p><a href="http://www.binarytides.com/">Quest blog</a> ha ottimi articoli sul Networking e, ovviamente, su Python :)</p>
<p>In particolare ho utilizzato una <a href="http://www.binarytides.com/python-socket-programming-tutorial/">Guida introduttiva ai Sockets in Python</a>; fate tesoro del sito, perché è davvero ottimo.</p>
<p>Per aiutarmi ed aiutarvi, metto anche il link alle pagine di <a href="http://docs.python.org/2/library/socket.html">manuale sui sockets</a> (è python 2.7).</p>
<p>L'articolo sul blog del link è composto di due parti:</p>
<ul>
<li>
<p>la costruzione di un client python che si connette ad un server, invia dati sul socket e attende la risposta prima di chiudere la comunicazione;</p>
</li>
<li>
<p>la creazione di un server, sempre in python, che si mette in ascolto su una porta e fa da "pappagallo" stampando a schermo quello che ricevere dal mittente, anche in multi-threading.</p>
</li>
</ul>
<p>Oggi io descriverò il client, lasciano il server python per la prossima..</p>
<h3>Il client</h3>
<p>Ed ecco il mio primo socket:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="ch">#!/usr/bin/env python2</span>
<span class="kn">import</span> <span class="nn">socket</span> <span class="c1"># :)</span>
<span class="kn">import</span> <span class="nn">sys</span>  <span class="c1"># per exit code</span>
<span class="k">try</span><span class="p">:</span>
    <span class="c1"># creo il socket TCP/IP</span>
    <span class="n">sockMe</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
<span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span>
    <span class="k">print</span> <span class="s1">&#39;Failed to create a socket. Error Code: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; , error  message: &#39;</span> <span class="o">+</span> <span class="n">msg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">();</span>
<span class="k">print</span> <span class="s1">&#39;il mio primo Socket esiste!&#39;</span>
</code></pre></div></td></tr></table></div>

<p>La mia intestazione deriva dal fatto che utilizzando Archlinux ho Python3 come interprete di _default _mentre questo codice è stato creato per python 2.x. La maggior parte delle distribuzioni utilizzano python 2.x quindi dovreste poter utilizzare</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="ch">#!/usr/bin/env python</span>
</code></pre></div></td></tr></table></div>

<p>Senza stare troppo a divagare, in queste quattro righe di codice si importano le librerie standard pyhton per i <em>sockets</em> (import socket) e di quelle di sistema (guarda un po) per la gestione dell'I/O, l'imput utente etcetc..</p>
<p>Visto che, chi ha fatto la guida è una persona colta, lui ha utilizzato un metodo di gestione delle "eccezioni" del tipo: prova a fare <em>questo</em> e se non riesci, giustificati con <em>questo</em>.</p>
<p>La forma è try:/except: e come tutte le cose in python gli spazi e l'indentazione contano.</p>
<p>Quel che si "<em>prova</em>" (try) a fare è creare un socket, associando la variabile sockMe:</p>
<p><code>socket.AF_INET, socket.SOCK_STREAM</code>
Dove AF_INET sta per protocollo IP e SOCK_STREAM è il portocollo tcp (indovinate cosa è SOCK_DATAGRAM..).</p>
<p>Andando avanti col codice, aggiungiamo un po di pezzi dato che un socket da solo non fa la felicità..</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="ch">#!/usr/bin/env python2</span>

<span class="c1">## My fist approach to sockets</span>

<span class="kn">import</span> <span class="nn">socket</span> <span class="c1"># :)</span>
<span class="kn">import</span> <span class="nn">sys</span> <span class="c1"># for exit code</span>
<span class="k">try</span><span class="p">:</span>
    <span class="c1"># creo il socket TCP/IP</span>
    <span class="n">sockMe</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
<span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span>
    <span class="k">print</span> <span class="s1">&#39;Failed to create a socket. Error Code: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; , error message: &#39;</span> <span class="o">+</span> <span class="n">msg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">();</span>

<span class="k">print</span> <span class="s1">&#39;il mio primo Socket esiste!&#39;</span>

<span class="n">host</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">port</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">remote_ip</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">gethostbyname</span><span class="p">(</span> <span class="n">host</span> <span class="p">)</span>
<span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">gaierror</span><span class="p">:</span>
    <span class="c1"># non posso risolvere: non ho internet o il dns non funziona</span>
    <span class="k">print</span> <span class="s1">&#39;Hostname non trovato.&#39;</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">();</span>

<span class="k">print</span> <span class="s2">&quot;L&#39;IP di &quot;</span> <span class="o">+</span> <span class="n">host</span> <span class="o">+</span> <span class="s2">&quot; e&#39; &quot;</span> <span class="o">+</span> <span class="n">remote_ip</span>

<span class="k">print</span> <span class="s1">&#39;ed ora connettiamoci...&#39;</span>

<span class="c1"># connettiamoci a ip-porta</span>
<span class="n">sockMe</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="n">remote_ip</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>

<p>Facciamo faville :)</p>
<p>Ora stiamo usando il socket, connettendoci ad un <em>host</em> ed una _porta _che definiamo con _argv (_cioè dall'input passando due argomenti allo script tipo "./client.py google.com 80").</p>
<p>socket.gethostbyname, invece, è il resolver python, che cerca di risolvere l'hostname tramite dns o file /etc/hosts; anche questa volta <em>proviamo</em> a risolvere e, se tutto fila liscio, eseguiamo un sockMe.connect per aprire la connessione con l'host (risolto come IP) e la porta definiti.</p>
<p>Ora che abbiamo un bel socket aperto e connesso all'altro capo della linea, perché non inviamo un bel messaggio al nostro interlocutore:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="ch">#!/usr/bin/env python2</span>

<span class="c1">## My fist approach to sockets</span>

<span class="kn">import</span> <span class="nn">socket</span> <span class="c1"># :)</span>
<span class="kn">import</span> <span class="nn">sys</span> <span class="c1"># for exit code</span>
<span class="k">try</span><span class="p">:</span>
    <span class="c1"># creo il socket TCP/IP</span>
    <span class="n">sockMe</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>

<span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span>
    <span class="k">print</span> <span class="s1">&#39;Failed to create a socket. Error Code: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; , error message: &#39;</span> <span class="o">+</span> <span class="n">msg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">();</span>

<span class="k">print</span> <span class="s1">&#39;il mio primo Socket esiste!&#39;</span>

<span class="n">host</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">port</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="k">try</span><span class="p">:</span>
     <span class="n">remote_ip</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">gethostbyname</span><span class="p">(</span> <span class="n">host</span> <span class="p">)</span>
<span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">gaierror</span><span class="p">:</span>
    <span class="c1"># non posso risolvere: non ho internet o il dns non funziona</span>
    <span class="k">print</span> <span class="s1">&#39;Hostname non trovato.&#39;</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">();</span>

<span class="k">print</span> <span class="s2">&quot;L&#39;IP di &quot;</span> <span class="o">+</span> <span class="n">host</span> <span class="o">+</span> <span class="s2">&quot; e&#39; &quot;</span> <span class="o">+</span> <span class="n">remote_ip</span>

<span class="k">print</span> <span class="s1">&#39;ed ora connettiamoci...&#39;</span>

<span class="c1"># connettiamoci a ip-porta</span>
<span class="n">sockMe</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="n">remote_ip</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>

<span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;W000t W000T&quot;</span>

<span class="k">try</span><span class="p">:</span>
<span class="c1">#inviamo tutto</span>
<span class="n">sockMe</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

<span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span><span class="p">:</span>
    <span class="k">print</span> <span class="s1">&#39;Errore! Non ho potuto inviare i pacchetti&#39;</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

<span class="k">print</span> <span class="s1">&#39;messaggio consegnato&#39;</span>
</code></pre></div></td></tr></table></div>

<p>Semplicemente, con un altro metodo try/except inviamo il messaggio salvato nel buffer con il comando _sendall. _Questo comando svuota il buffer inviando tutto quello che trova all'altro capo della connessione.</p>
<p>Ed ora, il tocco finale: riceviamo la risposta, la leggiamo, la stampiamo e in fine chiudiamo la comunicazione da bravi sviluppatori (non vogliamo lasciare appese le sessioni giusto?!).</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="ch">#!/usr/bin/env python2</span>

<span class="c1">## My fist approach to sockets</span>

<span class="kn">import</span> <span class="nn">socket</span> <span class="c1"># :)</span>
<span class="kn">import</span> <span class="nn">sys</span> <span class="c1"># for exit code</span>
<span class="k">try</span><span class="p">:</span>
<span class="c1"># creo il socket TCP/IP</span>
<span class="n">sockMe</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>

<span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span>
    <span class="k">print</span> <span class="s1">&#39;Failed to create a socket. Error Code: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; , error message: &#39;</span> <span class="o">+</span> <span class="n">msg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">();</span>

<span class="k">print</span> <span class="s1">&#39;il mio primo Socket esiste!&#39;</span>

<span class="n">host</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">port</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">remote_ip</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">gethostbyname</span><span class="p">(</span> <span class="n">host</span> <span class="p">)</span>

<span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">gaierror</span><span class="p">:</span>
    <span class="c1"># non posso risolvere: non ho internet o il dns non funziona</span>
    <span class="k">print</span> <span class="s1">&#39;Hostname non trovato.&#39;</span>
<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">();</span>

<span class="k">print</span> <span class="s2">&quot;L&#39;IP di &quot;</span> <span class="o">+</span> <span class="n">host</span> <span class="o">+</span> <span class="s2">&quot; e&#39; &quot;</span> <span class="o">+</span> <span class="n">remote_ip</span>

<span class="k">print</span> <span class="s1">&#39;ed ora connettiamoci...&#39;</span>

<span class="c1"># connettiamoci a ip-porta</span>
<span class="n">sockMe</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="n">remote_ip</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>

<span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;W000t W000T&quot;</span>

<span class="k">try</span><span class="p">:</span>
<span class="c1">#inviamo tutto</span>
<span class="n">sockMe</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

<span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span><span class="p">:</span>
    <span class="k">print</span> <span class="s1">&#39;Errore! Non ho potuto inviare i pacchetti&#39;</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

<span class="k">print</span> <span class="s1">&#39;messaggio consegnato&#39;</span>

<span class="c1">#e ora ricevo</span>
<span class="n">reply</span> <span class="o">=</span> <span class="n">sockMe</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>

<span class="k">print</span> <span class="n">reply</span>

<span class="n">sockMe</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>

<p><em>recv</em> è impostato per ricevere una certa quantità di dati (nel nostro caso 1024 byte). Per concludere in bellezza lo script, la sessione e l'articolo, chiudiamo il nostro socket python invocando la funzione close().</p>

		<span class="post-tags">
			Tags:
			<ul>
					<li><a href="https://www.j0llyb0x.org/tag/python.html">python</a></li>
					<li><a href="https://www.j0llyb0x.org/tag/socket.html">socket</a></li>
					<li><a href="https://www.j0llyb0x.org/tag/tutorial.html">tutorial</a></li>
			</ul>
		</span>

<div id="disqus_thread"></div>
<script type="text/javascript">
	var disqus_shortname = 'j0llyshares';
	(function() {
		var d = document, s = d.createElement('script'); s.type = 'text/javascript'; s.async = true;
		s.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
		s.setAttribute('data-timestamp', +new Date());
		(d.head || d.body).appendChild(s);
	})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
</div>
		</div>
	</body>
</html>