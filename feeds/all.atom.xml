<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>j0llyb0x</title><link href="https://www.j0llyb0x.org/" rel="alternate"></link><link href="https://www.j0llyb0x.org/feeds/all.atom.xml" rel="self"></link><id>https://www.j0llyb0x.org/</id><updated>2015-06-17T00:00:00+02:00</updated><subtitle>Hacker Inside</subtitle><entry><title>from Postach.io to Pelican</title><link href="https://www.j0llyb0x.org/2015/from-postachio-to-pelican.html" rel="alternate"></link><published>2015-06-17T00:00:00+02:00</published><updated>2015-06-17T00:00:00+02:00</updated><author><name>j0lly</name></author><id>tag:www.j0llyb0x.org,2015-06-17:/2015/from-postachio-to-pelican.html</id><summary type="html">&lt;p&gt;Finalmente un nuovo progetto che mi darà soddisfazione: &lt;a href="http://blog.getpelican.com/"&gt;Pelican&lt;/a&gt;!&lt;/p&gt;
&lt;p&gt;&lt;img alt="enter image description here" src="https://lh3.googleusercontent.com/-nf2VBXR_Yf8/VYGGM9qiu2I/AAAAAAAABxU/CHvX6rxAZ_U/s0/pelican-800px.png" title="pelican-800px.png"&gt; &lt;/p&gt;
&lt;p&gt;Dopo mesi di travagliati problemi, ho trovato qualche giorno per ricominciare ad interessarmi del blog e, soprattuto, ad uscire dal tunnel di postach.io: i simpatici developers hanno deciso di rendere tutto a pagamento (dovevo imamginarmelo non avendo mai letto di …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Finalmente un nuovo progetto che mi darà soddisfazione: &lt;a href="http://blog.getpelican.com/"&gt;Pelican&lt;/a&gt;!&lt;/p&gt;
&lt;p&gt;&lt;img alt="enter image description here" src="https://lh3.googleusercontent.com/-nf2VBXR_Yf8/VYGGM9qiu2I/AAAAAAAABxU/CHvX6rxAZ_U/s0/pelican-800px.png" title="pelican-800px.png"&gt; &lt;/p&gt;
&lt;p&gt;Dopo mesi di travagliati problemi, ho trovato qualche giorno per ricominciare ad interessarmi del blog e, soprattuto, ad uscire dal tunnel di postach.io: i simpatici developers hanno deciso di rendere tutto a pagamento (dovevo imamginarmelo non avendo mai letto di alcun contratto di licenza GPL etc).&lt;/p&gt;
&lt;p&gt;Comunque, a parte le disavventure, sono finalmente di nuovo in pista e, questa volta, sono tornato sui miei passi decidendo di hostare proprio tutto, dal contenuto, al software di blogging, ma anche l'host: infatti adesso ci sarà una marea di downtime a causa del server che hosta il sito (giù in cantina).&lt;/p&gt;
&lt;p&gt;Il vento delle novità questa volta porta &lt;a href="http://blog.getpelican.com/"&gt;pelican&lt;/a&gt;, un motore per generare siti web statici; per intenderci, un &lt;a href="http://jekyllrb.com/"&gt;Jekyll&lt;/a&gt; scritto in python!&lt;/p&gt;
&lt;p&gt;La &lt;a href="http://docs.getpelican.com"&gt;documentazione&lt;/a&gt; è abbastanza accurata e, nonostante la fretta che avevo di riportare il blog up, ho messo in piedi il sito in davvero poco tempo.&lt;/p&gt;
&lt;p&gt;I punti di forza di questo software sono la possibilità di scrivere le pagine in vari formati, tra cui, il markdown; essendo molto popolare oggi, ho deciso di prendere la palla al balzo e, con Pelican, di cominciare un percorso di apprendimento di alcune tecnologie che avrei voluto fare mie:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;python&lt;/li&gt;
&lt;li&gt;markdown&lt;/li&gt;
&lt;li&gt;&lt;a href="http://jinja.pocoo.org/docs/dev/"&gt;jinja2&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Grazie a Pelican, infatti, potrò cominciare a masticare meglio il pyhton e, soprattutto, il suo motore di templating (per i temi) che è usato anche da molti software davvero fighi; uno tra tutti, &lt;a href="http://saltstack.com/"&gt;saltstack&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Come potete mmaginare, il blog è ora scritto utilizzando Pelican; il blog è hostato su &lt;a href="https://github.com/j0lly/blog"&gt;github&lt;/a&gt;; ho anche fatto qualche test con &lt;a href="https://pages.github.com/"&gt;pages di github&lt;/a&gt; ed ora il blog è una bomba... beh credo manchi qualche gingillo, ma sono convinto che nelle prossime settimane troverò qualche ora per studiare meglio jinja2 e creare un bel tema ad-hoc.&lt;/p&gt;
&lt;p&gt;Speriamo di rivederci presto :P&lt;/p&gt;
&lt;p&gt;Stay Tuned&lt;/p&gt;</content><category term="pelican"></category><category term="pyhton"></category><category term="blog"></category></entry><entry><title>OpenResolver.py, open DNS crawler</title><link href="https://www.j0llyb0x.org/2014/openresolverpy-open-dns-crawler.html" rel="alternate"></link><published>2014-11-23T00:00:00+01:00</published><updated>2014-11-23T00:00:00+01:00</updated><author><name>j0lly</name></author><id>tag:www.j0llyb0x.org,2014-11-23:/2014/openresolverpy-open-dns-crawler.html</id><summary type="html">&lt;p&gt;Week-end felice: ho trovato voglia e tempo per scrivere un po di (orribile) python!&lt;/p&gt;
&lt;p&gt;&lt;img alt="odin" src="https://www.j0llyb0x.org/images/odin-1.jpg"&gt;&lt;/p&gt;
&lt;p&gt;Dato che la tecnica del &lt;a href="http://it.wikipedia.org/wiki/DNS_Amplification_Attack"&gt;DNS Amplification Attack&lt;/a&gt; è didatticamente molto interessante, ho deciso di fare un po di esercizi di scripting e creare un piccolo programma in python che potesse ricercare i famosi Open Resolver …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Week-end felice: ho trovato voglia e tempo per scrivere un po di (orribile) python!&lt;/p&gt;
&lt;p&gt;&lt;img alt="odin" src="https://www.j0llyb0x.org/images/odin-1.jpg"&gt;&lt;/p&gt;
&lt;p&gt;Dato che la tecnica del &lt;a href="http://it.wikipedia.org/wiki/DNS_Amplification_Attack"&gt;DNS Amplification Attack&lt;/a&gt; è didatticamente molto interessante, ho deciso di fare un po di esercizi di scripting e creare un piccolo programma in python che potesse ricercare i famosi Open Resolver in giro per la rete.&lt;/p&gt;
&lt;p&gt;Si chiama Openresolver.py (che classe :P) ed è hostato sul mio github: https://github.com/j0lly/openresolvers.&lt;/p&gt;
&lt;p&gt;Per ora è solo un'accozzaglia di righe di codice, ma il suo sporco lavoro lo fa:&lt;/p&gt;
&lt;p&gt;basta passare un ip o un range di ip in formato CIDR e lui comincerà a testare tutti i target per trovare quelli che risolvono query DNS arbitrarie.&lt;/p&gt;
&lt;p&gt;&lt;img alt="shot" src="https://www.j0llyb0x.org/images/openresolver-1.png"&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Esempio:&lt;/em&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[root@newsun][~/openresolvers]&lt;/span&gt;
&lt;span class="na"&gt;16:42:43 # git com./openresolver.py -t 91.98.29.244/24 -c 120 -o resolvers.txt&lt;/span&gt;
&lt;span class="na"&gt;resolving with 91.98.29.0&lt;/span&gt;
&lt;span class="na"&gt;resolving with 91.98.29.1&lt;/span&gt;
&lt;span class="na"&gt;resolving with 91.98.29.2&lt;/span&gt;

&lt;span class="k"&gt;[..]&lt;/span&gt;

&lt;span class="na"&gt;resolving with 91.98.29.118&lt;/span&gt;
&lt;span class="na"&gt;resolving with 91.98.29.119&lt;/span&gt;
&lt;span class="na"&gt;fd-fp3.wg1.b.yahoo.com.&lt;/span&gt;
&lt;span class="na"&gt;adding 91.98.29.26 to the list&lt;/span&gt;
&lt;span class="na"&gt;fd-fp3.wg1.b.yahoo.com.&lt;/span&gt;
&lt;span class="na"&gt;adding 91.98.29.22 to the list&lt;/span&gt;
&lt;span class="na"&gt;fd-fp3.wg1.b.yahoo.com.&lt;/span&gt;
&lt;span class="na"&gt;adding 91.98.29.86 to the list&lt;/span&gt;
&lt;span class="na"&gt;fd-fp3.wg1.b.yahoo.com.&lt;/span&gt;
&lt;span class="na"&gt;adding 91.98.29.66 to the list&lt;/span&gt;
&lt;span class="na"&gt;fd-fp3.wg1.b.yahoo.com.&lt;/span&gt;
&lt;span class="na"&gt;adding 91.98.29.68 to the list&lt;/span&gt;
&lt;span class="na"&gt;fd-fp3.wg1.b.yahoo.com.&lt;/span&gt;
&lt;span class="na"&gt;adding 91.98.29.69 to the list&lt;/span&gt;
&lt;span class="na"&gt;fd-fp3.wg1.b.yahoo.com.&lt;/span&gt;
&lt;span class="na"&gt;adding 91.98.29.67 to the list&lt;/span&gt;
&lt;span class="na"&gt;fd-fp3.wg1.b.yahoo.com.&lt;/span&gt;
&lt;span class="na"&gt;adding 91.98.29.10 to the list&lt;/span&gt;
&lt;span class="na"&gt;fd-fp3.wg1.b.yahoo.com.&lt;/span&gt;
&lt;span class="na"&gt;adding 91.98.29.70 to the list&lt;/span&gt;
&lt;span class="na"&gt;resolving with 91.98.29.120&lt;/span&gt;


&lt;span class="k"&gt;[..]&lt;/span&gt;

&lt;span class="na"&gt;I found 14 resolvers!&lt;/span&gt;
&lt;span class="na"&gt;dumped list to resolvers.txt&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Al momento è molto verboso e non fornisce molte opzioni, ma cercherò di migliorarne il contenuto se avrò tempo; ovviamente se qualcuno volesse contribuire, sarei felicissimo di accettare qualche commit!&lt;/p&gt;
&lt;p&gt;Spero che qualcuno trovi lo script interessante, o per lo meno curioso :P&lt;/p&gt;
&lt;p&gt;Stay tuned!&lt;/p&gt;
&lt;p&gt;J0lly&lt;/p&gt;</content><category term="odin"></category><category term="python"></category><category term="dns"></category><category term="hacking"></category></entry><entry><title>NAT networks in Ovirt</title><link href="https://www.j0llyb0x.org/2014/nat-networks-in-ovirt.html" rel="alternate"></link><published>2014-11-20T00:00:00+01:00</published><updated>2014-11-20T00:00:00+01:00</updated><author><name>j0lly</name></author><id>tag:www.j0llyb0x.org,2014-11-20:/2014/nat-networks-in-ovirt.html</id><summary type="html">&lt;p&gt;Questo blog è prima di tutto un luogo dove pubblicare i miei appunti, in modo che servano a me e, all'occorrenza a chiunque si possa trovare nella mia stessa situazione.&lt;/p&gt;
&lt;p&gt;Scrivo in italiano perché, nel 90% dei casi, quello di cui tratto è sicuramente già stato scritto da qualcuno, e …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Questo blog è prima di tutto un luogo dove pubblicare i miei appunti, in modo che servano a me e, all'occorrenza a chiunque si possa trovare nella mia stessa situazione.&lt;/p&gt;
&lt;p&gt;Scrivo in italiano perché, nel 90% dei casi, quello di cui tratto è sicuramente già stato scritto da qualcuno, e probabilmente in maniera più chiara della mia :P.&lt;/p&gt;
&lt;p&gt;Quindi, Di seguito la rodata procedura per attivare un network virtuale su oVirt 3.5.&lt;/p&gt;
&lt;p&gt;Grazie al nuovo Hook per oVirt che gestisce il NAT lato Gui, è decisamente molto più semplice creare una rete Nattata su oVirt; per schematizzare, questi sono i passaggi:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;installazione dell'Hook;&lt;/li&gt;
&lt;li&gt;creazione di una rete NAT virtuale sull'host [tutti gli host del cluster] via libvirt;&lt;/li&gt;
&lt;li&gt;aggiunta della periferica virtuale (Vnic) appena creata ad una o più delle VM.&lt;/li&gt;
&lt;li&gt;Enjoy :)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Qui ricapitolo le specifiche della mia infrastruttura:&lt;/p&gt;
&lt;p&gt;Host = Centos 7&lt;/p&gt;
&lt;p&gt;Engine = Centos 6 [attualmente non supportato Centos 7 come Engine] Self Hosted&lt;/p&gt;
&lt;p&gt;Ovirt = 3.5 Version&lt;/p&gt;
&lt;p&gt;vdsm-hook-extnet = 4.16.7-1.gitdb83943.el7.noarch&lt;/p&gt;
&lt;p&gt;Installazione dell'Hook&lt;/p&gt;
&lt;p&gt;Se come me, avete installato il repository di oVirt 3.5,&lt;/p&gt;
&lt;p&gt;Su tutti gli &lt;em&gt;host&lt;/em&gt; del cluster, installate semplicemente l'hook:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;yum&lt;/span&gt; &lt;span class="n"&gt;install&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="n"&gt;vdsm&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;hook&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;extnet&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Sull'&lt;em&gt;engine&lt;/em&gt;, abilitate l'hook:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;engine&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;config&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="n"&gt;CustomDeviceProperties&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;{type=interface;prop={extnet=^[a-zA-Z0-9_ ---]+$}}&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Non ricordo se sia necessario un reboot dell'host, ma non credo..&lt;/p&gt;
&lt;p&gt;Creazione di una rete Nat, per ogni Host
Ora è necessario creare una rete NAT direttamente via Virsh, perché oVirt  non supporta ancora questo tipo di rete:&lt;/p&gt;
&lt;p&gt;Per prima cosa, è necessario, se ancora non ce l'abbiamo, un utente autorizzato ad accedere all'hypervisor:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;saslpasswd2&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;libvirt&lt;/span&gt; &lt;span class="n"&gt;root&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;digitate la password per due volte, ed abilitate l'accesso a libvirt via SASL [richiesto da ovirt].
Creare una rete Nat classica con ovirt, usate un xml per utilizzare il comando net-define; il mio è molto semplice:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;network&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
 &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nv"&gt;cluster_nat&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
 &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;forward&lt;/span&gt; &lt;span class="nv"&gt;mode&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;nat&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;nat&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
   &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;port&lt;/span&gt; &lt;span class="nv"&gt;start&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;1024&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;65535&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class="o"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nv"&gt;nat&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
 &lt;span class="o"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nv"&gt;forward&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
 &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;bridge&lt;/span&gt; &lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;virbr1&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="nv"&gt;stp&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;on&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="nv"&gt;delay&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;0&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
 &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;ip&lt;/span&gt; &lt;span class="nv"&gt;address&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;172.16.31.1&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="nv"&gt;netmask&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;255.255.255.0&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
 &lt;span class="o"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nv"&gt;ip&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="o"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nv"&gt;network&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;L'importante è che vi ricordiate il nome che avete dato al network, e di non creare una virtual interface già esistente [virbr1].&lt;/p&gt;
&lt;p&gt;NB&lt;/p&gt;
&lt;p&gt;Aggiungete il dhcp se non ne avete già uno nella rete Nat che andate a creare, altrimenti dovrete restartare il network e le VM che ci girano dentro se volete aggiungere il DHCP alla configurazione!&lt;/p&gt;
&lt;p&gt;Loggatevi in virsh, nel vostro Hypervisor, create la rete, settatela in auto-start e lanciatela (su tutti i nodi del cluster):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nv"&gt;virsh&lt;/span&gt;
&lt;span class="k"&gt;connect&lt;/span&gt; &lt;span class="nv"&gt;qemu&lt;/span&gt;:&lt;span class="o"&gt;///&lt;/span&gt;&lt;span class="nv"&gt;system&lt;/span&gt;
&lt;span class="nv"&gt;net&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;define&lt;/span&gt; &lt;span class="nv"&gt;_nome_del_file_xml_&lt;/span&gt;
&lt;span class="nv"&gt;net&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;autostart&lt;/span&gt; &lt;span class="nv"&gt;_cluster_nat&lt;/span&gt; &lt;span class="nv"&gt;_&lt;/span&gt;
&lt;span class="nv"&gt;net&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;start&lt;/span&gt; &lt;span class="nv"&gt;_cluster_nat_&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Questi passaggi vanno fatti su tutti gli host del cluster che intendete fornire di un NAT.&lt;/p&gt;
&lt;p&gt;Assicuratevi che la nuova rete sia un &amp;amp; running e che tra le periferiche sia listata la nuova interfaccia.&lt;/p&gt;
&lt;p&gt;NB&lt;/p&gt;
&lt;p&gt;Se utilizzate iptables (che viene autogestito dall'engine quando create nuovi virtual network) dovrete creare le regole a mano, perché VDSM non è in grado di gestire questa rete.&lt;/p&gt;
&lt;p&gt;aggiunta del profilo vNIC tramite GUI&lt;/p&gt;
&lt;p&gt;Non resta che collegarsi alla console di amministrazione di oVirt e creare un profilo ad-hoc per gestire questa rete; l'hook installato aggiunge una  _custom property _che permette la gestione del NAT.&lt;/p&gt;
&lt;p&gt;Loggatevi e create un nuovo profile in uno dei vostri networks:&lt;/p&gt;
&lt;p&gt;&lt;img alt="ovirt" src="https://www.j0llyb0x.org/images/ovirt-2.png"&gt;&lt;/p&gt;
&lt;p&gt;Nel profilo, aggiungete la proprietà extnet, e come valore, inserite il nome che avete dato al network via virsh:&lt;/p&gt;
&lt;p&gt;&lt;img alt="ovirt" src="https://www.j0llyb0x.org/images/ovirt-1.png"&gt;&lt;/p&gt;
&lt;p&gt;Perfect! ora potete aggiungere il nic alle vostre VM:&lt;/p&gt;
&lt;p&gt;&lt;img alt="ovirt" src="https://www.j0llyb0x.org/images/ovirt-3.png"&gt;&lt;/p&gt;
&lt;p&gt;Et voilà, il NAT network è servito!&lt;/p&gt;
&lt;p&gt;Stay Tuned&lt;/p&gt;</content><category term="libvirt"></category><category term="kvm"></category><category term="nat"></category><category term="ovirt"></category></entry><entry><title>find open proxy</title><link href="https://www.j0llyb0x.org/2014/find-open-proxy.html" rel="alternate"></link><published>2014-08-23T00:00:00+02:00</published><updated>2014-08-23T00:00:00+02:00</updated><author><name>j0lly</name></author><id>tag:www.j0llyb0x.org,2014-08-23:/2014/find-open-proxy.html</id><summary type="html">&lt;p&gt;Un poco annoiato, ieri ho deciso di annotarmi qualche proxy aperto che potesse servire a vari scopi... :P&lt;/p&gt;
&lt;p&gt;&lt;img alt="nmap" src="https://www.j0llyb0x.org/images/nmap-1.jpg"&gt;&lt;/p&gt;
&lt;p&gt;H pensato sarebbe stato un ottimo playground per python e xml (xml.minidom,xml.etree,BeautifulSoup) ma sono rimasto scottato dalle mie risorse; il Vps sul quale sto lavorando è un Lxc …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Un poco annoiato, ieri ho deciso di annotarmi qualche proxy aperto che potesse servire a vari scopi... :P&lt;/p&gt;
&lt;p&gt;&lt;img alt="nmap" src="https://www.j0llyb0x.org/images/nmap-1.jpg"&gt;&lt;/p&gt;
&lt;p&gt;H pensato sarebbe stato un ottimo playground per python e xml (xml.minidom,xml.etree,BeautifulSoup) ma sono rimasto scottato dalle mie risorse; il Vps sul quale sto lavorando è un Lxc (Linux container) openvz con 512Mb di ram.&lt;/p&gt;
&lt;p&gt;Dato che le liste di indirizzi sono /16, il file in formato xml  è grosso più di 20Mb, python si mangiava tutta la memoria all'atto di importare il file.&lt;/p&gt;
&lt;p&gt;Certo, avrei potuto cominciare studiando la maniera di ottimizzare il codice e prende chunk di dati, ma dato che volevo produrre qualcosa di funzionante prima di lasciare un'altra idea a metà, ho rifatto tutto in 3 linee di bash senza nemmeno utilizzare un decimo della memoria che python utilizza, solo a leggere il file...&lt;/p&gt;
&lt;p&gt;Con questo non voglio dire nulla, se non che le mie conoscenze di python sono così basse che non mi permettono nemmeno di implementare 3 righe di script senza perdere 3 giorni; pazienza, sarà per la prossima idea (tanto quelle non finiscono mai :P ).&lt;/p&gt;
&lt;p&gt;Quindi, passando al topic, ho creato un piccolo script che facesse al caso mio.&lt;/p&gt;
&lt;p&gt;Le dipendenze sono:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;nmap,&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;nc,&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;grep&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;mailx,&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;uuencode.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Nulla di più.&lt;/p&gt;
&lt;p&gt;Il codice lo trovate nel &lt;a href="https://gist.github.com/j0lly/89c82bb5aac9116c5b7e"&gt;gist&lt;/a&gt; linkato.&lt;/p&gt;
&lt;p&gt;Lo script è triviale, ma vale la pena annotare qualche switch e comando utilizzato in modo da risparmiare tempo la prossima volta che ci si trova ad affrontare certi problemi.&lt;/p&gt;
&lt;p&gt;Per prima cosa il comando nmap utilizzato:&lt;/p&gt;
&lt;p&gt;nmap --script http-open-py.roxnse  -Pn -P0 -n --unprivileged  -T4 $1.0.0/16  -p 8080 -oX ${1}.0.0&lt;/p&gt;
&lt;p&gt;lo script http-open-proxy.nse è utilizzato per testare la porta 8080 (nel codice ho trovato riferimenti a 4 porte, ma non ho avuto tempo di capire se aggiungendo porte allo switch -p vengono scansionate anch'esse) e cercare di scremare i target possibili.&lt;/p&gt;
&lt;p&gt;altro switch degno di nota è --unprivileged, dal man page:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;--unprivileged&lt;/code&gt; (Assume that the user lacks raw socket privileges)&lt;/p&gt;
&lt;p&gt;This option is the opposite of &lt;code&gt;--privileged&lt;/code&gt;. It tells Nmap to treat the user as lacking network raw socket and sniffing privileges. This is useful for testing, debugging, or when the raw network functionality of your operating system is somehow broken. The &lt;code&gt;NMAP_UNPRIVILEGED&lt;/code&gt; environment variable may be set as an equivalent alternative to &lt;code&gt;--unprivileged&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Questo flag è stato indispensabile affinché nmap funzionasse a causa di due concorrenti cause:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;la macchian è un Ovz container è probabilmente il network ha qualche configurazione particolare nella gestione dei raw sockets;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;lanciando il comando da root, nmap assume l'utilizzo di yutte quelle capabilities da superutente che sono sì più precise, ma si basano sull'utilizzo di chiamate evidentemente proibite all'interno di un Linux Container.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In ultima analisi, ho creato un output in formato xml; perché, direte? Dato che stavo tentando di parsare con pyhton e lo scan era già a metà, non me la sono sentita di cambiare :P&lt;/p&gt;
&lt;p&gt;Magari cambierò il formato in "greppable" con -oG, ma non credo diminirebbe la grandezza del log..&lt;/p&gt;
&lt;p&gt;Passando al test del proxy vero e proprio, il protagonista è netcat (il mio tool favorito):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;echo&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt; &lt;span class="ss"&gt;&amp;quot;GET http://google.com HTTP/1.0\n\host: google.com\n&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;nc&lt;/span&gt; &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="mi"&gt;8080&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;grep&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Location: http://www.google.&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;questa stringa invia semplicemente due righe all'ip /porta in questione tentando di fare una GET della pagina di google.com.&lt;/p&gt;
&lt;p&gt;Se il server è configurato per fare da proxy, instraderà la richiesta passando indietro la pagina di google classica se ci si connette via http:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;HTTP/1.1 302 Found
Cache-Control: private
Content-Type: text/html; charset=UTF-8
Location: http://www.google.it/?gfe_rd=cr&lt;span class="ni"&gt;&amp;amp;amp;&lt;/span&gt;ei=_5H4U7jVB6rD8gee1oDgCA
Content-Length: 258
Date: Sat, 23 Aug 2014 13:07:11 GMT
Server: GFE/2.0
Alternate-Protocol: 80:quic

&lt;span class="nt"&gt;&amp;lt;HTML&amp;gt;&lt;/span&gt;
 &lt;span class="nt"&gt;&amp;lt;HEAD&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;meta&lt;/span&gt; &lt;span class="na"&gt;http-equiv=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;content-type&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;content=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;text/html;charset=utf-8&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt; 
  &lt;span class="nt"&gt;&amp;lt;TITLE&amp;gt;&lt;/span&gt;302 Moved&lt;span class="nt"&gt;&amp;lt;/TITLE&amp;gt;&lt;/span&gt;
 &lt;span class="nt"&gt;&amp;lt;/HEAD&amp;gt;&lt;/span&gt;
 &lt;span class="nt"&gt;&amp;lt;BODY&amp;gt;&lt;/span&gt; 
  &lt;span class="nt"&gt;&amp;lt;H1&amp;gt;&lt;/span&gt;302 Moved&lt;span class="nt"&gt;&amp;lt;/H1&amp;gt;&lt;/span&gt; 
   The document has moved &lt;span class="nt"&gt;&amp;lt;A&lt;/span&gt; &lt;span class="na"&gt;HREF=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;http://www.google.it/?gfe_rd=cr&amp;amp;amp;ei=_5H4U7jVB6rD8gee1oDgCA&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;here&lt;span class="nt"&gt;&amp;lt;/A&amp;gt;&lt;/span&gt;. 
 &lt;span class="nt"&gt;&amp;lt;/BODY&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/HTML&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Ho messo l'accento sul grep, per considerare (ci ho messo un po a capire) che google rimanda alla homepage del paese di provenienza dell'ip e, dato che stiamo scansionando reti grandi, gli ip potrebbero arrivare da chissà dove, restituendo, come nel caso sopra, l Location a google.it invece che la richiesta (google.com).&lt;/p&gt;
&lt;p&gt;Poco altro c'è da dire sullo script, se non che manda una mail all'interessato al termine dello scan, che dura parecchie ore, con in allegato la lista di ip, se almeno un ip è risultato positivo dopo il check incrociato.&lt;/p&gt;
&lt;p&gt;Fonti:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href="http://it-ovid.blogspot.se/2012/05/nmap-routedstnetlink-cant-find.html"&gt;it-ovid&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://nmap.org/book/man.html"&gt;nmap.org&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://www.unix.com/shell-programming-and-scripting/24289-need-attach-txt-file-while-sending-mail.html"&gt;unix.com&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Happy Hacking &amp;amp; stay TuNeD&lt;/p&gt;</content><category term="nmap"></category><category term="bash"></category><category term="proxy"></category><category term="hacking"></category></entry><entry><title>remote weechat notification via urxvt &amp; tmux</title><link href="https://www.j0llyb0x.org/2014/remote-weechat-notification-via-urxvt-tmux.html" rel="alternate"></link><published>2014-08-20T10:20:00+02:00</published><updated>2014-08-20T10:20:00+02:00</updated><author><name>j0lly</name></author><id>tag:www.j0llyb0x.org,2014-08-20:/2014/remote-weechat-notification-via-urxvt-tmux.html</id><summary type="html">&lt;p&gt;oggi è un grande giorno perché ho finalmente (e nuovamente) le notifiche desktop di weechat, grazie a urxvt.&lt;/p&gt;
&lt;p&gt;&lt;img alt="weechat" src="https://www.j0llyb0x.org/images/weechat-1.png"&gt;&lt;/p&gt;
&lt;p&gt;Prerequisiti:&lt;/p&gt;
&lt;p&gt;*urxvt sulla macchina guest&lt;/p&gt;
&lt;p&gt;*libnorify sulla amchcina guest&lt;/p&gt;
&lt;p&gt;*weechat sulla macchina server &lt;/p&gt;
&lt;p&gt;Questo metodo è abbastanza hacker, ma su internet ho visto cose veramente più brutte e questa è la più …&lt;/p&gt;</summary><content type="html">&lt;p&gt;oggi è un grande giorno perché ho finalmente (e nuovamente) le notifiche desktop di weechat, grazie a urxvt.&lt;/p&gt;
&lt;p&gt;&lt;img alt="weechat" src="https://www.j0llyb0x.org/images/weechat-1.png"&gt;&lt;/p&gt;
&lt;p&gt;Prerequisiti:&lt;/p&gt;
&lt;p&gt;*urxvt sulla macchina guest&lt;/p&gt;
&lt;p&gt;*libnorify sulla amchcina guest&lt;/p&gt;
&lt;p&gt;*weechat sulla macchina server &lt;/p&gt;
&lt;p&gt;Questo metodo è abbastanza hacker, ma su internet ho visto cose veramente più brutte e questa è la più elegante che ho trovato, per ci più mi ha fatto scoprire cose di urxvt che non sapevo e che mi fa capire come mai molti lo utilizzano così massivamente.&lt;/p&gt;
&lt;p&gt;per prima cose è necessario aggiungere la gestione delle notifiche urgenti dei programmi via shell aggiungendo la line nel file .Xresources (o .Xdefaults):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;urxvt&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;urgentOnBell&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="k"&gt;True&lt;/span&gt;

&lt;span class="n"&gt;xrdb&lt;/span&gt; &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Xresources&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ed ora aprendo una nuova shell, basta lanciare un comando di prova tipo sleep 5 e spostarsi in un altro workspace (o comunque mettendo fuori fuoco la finestra) e dovrebbe illuminarsi all'uscita del comando.&lt;/p&gt;
&lt;p&gt;ora che abbiamo i nostri luccichii, passiamo alla gestione delle notifiche vere e proprie e, se si vuole, anche il segnale acustico..&lt;/p&gt;
&lt;p&gt;create questo script mettendolo in una directory che preferite (io in .urxvt/notifier):&lt;/p&gt;
&lt;p&gt;[gist url="https://gist.github.com/j0lly/f99df5b9676faf2e231b"]&lt;/p&gt;
&lt;p&gt;ora modificate ancora il vostro .Xresources in modo da utilizzare il nuovo plugin:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt; &lt;span class="k"&gt;beep&lt;/span&gt; &lt;span class="nv"&gt;via&lt;/span&gt; &lt;span class="nv"&gt;urxvt&lt;/span&gt; &lt;span class="nv"&gt;signals&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nv"&gt;amp&lt;/span&gt;&lt;span class="c1"&gt;; perl extension&lt;/span&gt;
&lt;span class="nv"&gt;URxvt&lt;/span&gt;.&lt;span class="nv"&gt;perl&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;lib&lt;/span&gt;: &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nv"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nv"&gt;j0lly&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;.&lt;span class="nv"&gt;urxvt&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;
&lt;span class="nv"&gt;URxvt&lt;/span&gt;.&lt;span class="nv"&gt;perl&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;ext&lt;/span&gt;: &lt;span class="nv"&gt;notifier&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;reload delle funzioni coma sopra e tutto dovrebbe funzionare (controllate di avere aplay e notify-send installati e funzionanti, e scegliete un suono che vi aggrada); non resta che provare:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;echo&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;ne&lt;/span&gt; &lt;span class="ss"&gt;&amp;quot;\033]777;notify;titolo;Ciao Mondo\007\007&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Ho notato che ci sono alcune mancanze, come la possibilità di avere un subject della notifica separato da spazi, ed altre limitazioni, mo ci sarà tempo di affinare.
Ora, spostandoci sul server che ospita la sessione di weechat dentro il multiplexer (tmux o screen), ed aggiungiamo questo script 
[gist url="https://gist.github.com/j0lly/8803d4067bb00c05ab23"]&lt;/p&gt;
&lt;p&gt;in ~/.weechat/python/osc_notify.py&lt;/p&gt;
&lt;p&gt;ed un link per l'autostart:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;cd&lt;/span&gt; &lt;span class="o"&gt;~/&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;weechat&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;pyhton&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;autoload&lt;/span&gt; &lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;ln&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;osc_notify&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt; &lt;span class="n"&gt;osc_notify&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;e su weechat:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;script&lt;/span&gt; &lt;span class="k"&gt;load&lt;/span&gt; &lt;span class="n"&gt;osc_notify&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;perfetto, da ora ogni notifica via weechat verrà instradata come messaggio osc e gestito da urxvt.&lt;/p&gt;
&lt;p&gt;Una nota:&lt;/p&gt;
&lt;p&gt;Lo script per weechat utilizza una stringa di notifica diversa da quella nello script sul guest; questo perché è necessario un escape del multiplexer, producendo una stringa del tipo:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="mi"&gt;033&lt;/span&gt;&lt;span class="n"&gt;Ptmux&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="mi"&gt;033&lt;/span&gt;&lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="mi"&gt;033&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="mi"&gt;777&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="k"&gt;notify&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;titolo&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;messaggio&lt;/span&gt; &lt;span class="n"&gt;di&lt;/span&gt; &lt;span class="n"&gt;testo&lt;/span&gt;&lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="mi"&gt;007&lt;/span&gt;&lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="mi"&gt;007&lt;/span&gt;&lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="mi"&gt;033&lt;/span&gt;&lt;span class="err"&gt;\\\&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;per la sessione screen, i caratteri di escape dovrebbero essere:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="mi"&gt;033&lt;/span&gt;&lt;span class="n"&gt;P&lt;/span&gt;&lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="mi"&gt;033&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="mi"&gt;777&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="k"&gt;notify&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;titolo&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;messaggio&lt;/span&gt; &lt;span class="n"&gt;di&lt;/span&gt; &lt;span class="n"&gt;testo&lt;/span&gt;&lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="mi"&gt;007&lt;/span&gt;&lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="mi"&gt;007&lt;/span&gt;&lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="mi"&gt;033&lt;/span&gt;&lt;span class="err"&gt;\\\&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ma non ne sono sicuro non avendo provato.&lt;/p&gt;
&lt;p&gt;Spero sia servito.&lt;/p&gt;
&lt;p&gt;Stay TuNeD&lt;/p&gt;
&lt;p&gt;Fonti:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href="https://snippet.phyks.me/index.php?tag=Weechat"&gt;phyks&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://artisan.karma-lab.net/ajouter-notification-a-urxvt"&gt;karma-lab&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://mlomnicki.com/ruby/linux/2011/02/09/irc-notifications.html"&gt;mlomnicki&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="https://bbs.archlinux.org/viewtopic.php?pid=1364337"&gt;archlinux&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://comments.gmane.org/gmane.comp.terminal-emulators.tmux.user/1322ù"&gt;gmane&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;</content><category term="bash"></category><category term="tmux"></category><category term="weechat"></category></entry><entry><title>[kvm] pxe installation over console</title><link href="https://www.j0llyb0x.org/2014/kvm-pxe-installation-over-console.html" rel="alternate"></link><published>2014-08-19T10:20:00+02:00</published><updated>2014-08-19T10:20:00+02:00</updated><author><name>j0lly</name></author><id>tag:www.j0llyb0x.org,2014-08-19:/2014/kvm-pxe-installation-over-console.html</id><summary type="html">&lt;p&gt;Questo articolo vuole essere una prima bozza che raccogliesse i passaggi compiuti per arrivare all'automazione di installazioni Centos (a breve debian e qualche opzione supplementare di installazione). &lt;/p&gt;
&lt;p&gt;&lt;img alt="kvm" src="https://www.j0llyb0x.org/images/kvm-1.jpg"&gt;&lt;/p&gt;
&lt;p&gt;i prerequisiti, non trattati in questa sede:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;un hypervisor kvm basato su libvirt&lt;/li&gt;
&lt;li&gt;un guest all'interno dello stesso network virtuale nel quale verranno …&lt;/li&gt;&lt;/ul&gt;</summary><content type="html">&lt;p&gt;Questo articolo vuole essere una prima bozza che raccogliesse i passaggi compiuti per arrivare all'automazione di installazioni Centos (a breve debian e qualche opzione supplementare di installazione). &lt;/p&gt;
&lt;p&gt;&lt;img alt="kvm" src="https://www.j0llyb0x.org/images/kvm-1.jpg"&gt;&lt;/p&gt;
&lt;p&gt;i prerequisiti, non trattati in questa sede:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;un hypervisor kvm basato su libvirt&lt;/li&gt;
&lt;li&gt;un guest all'interno dello stesso network virtuale nel quale verranno creati i nuovi guests:&lt;/li&gt;
&lt;li&gt;esso funge da pxe/tftpd server;&lt;/li&gt;
&lt;li&gt;repository (facoltativo) per l'installazione dei pacchetti. &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;i principali componenti, trattati in questo articolo sono:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;modifica del network virtuale di riferimento per gestire il pxe booting;&lt;/li&gt;
&lt;li&gt;installazione e configurazione del pxe booting sul guest di riferimento;&lt;/li&gt;
&lt;li&gt;installazione e configurazione di un webserver per la gestione dei file kickstart/preseed;&lt;/li&gt;
&lt;li&gt;configurazione del webserver come repository di pacchetti (opzionale).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Ovviamente sono passato da varie fasi di affinamento ed è per questo che spero di evirare qualche grattacapo a voi.&lt;/p&gt;
&lt;p&gt;Per prima cosa, è indispensabile modificare il network utilizzato; io ho utilizzato quello di default perché virt-manager lo utilizza per le nuove installazioni, ma questo non è così importante quindi scegliete voi il network che preferite.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;network&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
 &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nv"&gt;default&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;uuid&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nv"&gt;xxxxxxxxxxxxxxxxxxxxxxxxxxxxx&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nv"&gt;uuid&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;forward&lt;/span&gt; &lt;span class="nv"&gt;mode&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;nat&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
   &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;nat&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;port&lt;/span&gt; &lt;span class="nv"&gt;start&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;1024&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;65535&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
   &lt;span class="o"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nv"&gt;nat&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="o"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nv"&gt;forward&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;bridge&lt;/span&gt; &lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;virbr0&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="nv"&gt;stp&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;on&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="nv"&gt;delay&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;0&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;mac&lt;/span&gt; &lt;span class="nv"&gt;address&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;52:54:00:d1:f9:75&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;dns&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
   &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;forwarder&lt;/span&gt; &lt;span class="nv"&gt;addr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;8.8.8.8&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
   &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;host&lt;/span&gt; &lt;span class="nv"&gt;ip&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;192.168.122.1&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;hostname&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nv"&gt;meh&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nv"&gt;hostname&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
   &lt;span class="o"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nv"&gt;host&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="o"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nv"&gt;dns&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;ip&lt;/span&gt; &lt;span class="nv"&gt;address&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;192.168.122.1&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="nv"&gt;netmask&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;255.255.255.0&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
   &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;dhcp&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
   &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;range&lt;/span&gt; &lt;span class="nv"&gt;start&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;192.168.122.2&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;192.168.122.20&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
   &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;host&lt;/span&gt; &lt;span class="nv"&gt;mac&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;52:54:00:92:c7:98&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;mysql01.cluster.io&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="nv"&gt;ip&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;192.168.122.51&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
   &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;host&lt;/span&gt; &lt;span class="nv"&gt;mac&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;52:54:00:3e:31:f3&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;mysql02.cluster.io&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="nv"&gt;ip&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;192.168.122.52&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
   &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;host&lt;/span&gt; &lt;span class="nv"&gt;mac&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;52:54:00:d8:40:7d&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;mysql03.cluster.io&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="nv"&gt;ip&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;192.168.122.53&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
   &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;host&lt;/span&gt; &lt;span class="nv"&gt;mac&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;52:54:00:74:d8:b4&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;diablo.cluster.io&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="nv"&gt;ip&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;192.168.122.90&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
   &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;host&lt;/span&gt; &lt;span class="nv"&gt;mac&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;52:54:00:45:72:3c&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;booter.cluster.io&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="nv"&gt;ip&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;192.168.122.91&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
   &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;bootp&lt;/span&gt; &lt;span class="nv"&gt;file&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;pxelinux.0&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="nv"&gt;server&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;192.168.122.91&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class="o"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nv"&gt;dhcp&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
 &lt;span class="o"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nv"&gt;ip&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="o"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nv"&gt;network&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;le parti in rosso sono quelle necessarie per creare un pxe boot server:&lt;/p&gt;
&lt;p&gt;In particolare, l'opzione &lt;bootp /&gt; ha come parametro file il nome del bootloader di rete, posizionato sul server 192.168.122.91.&lt;/p&gt;
&lt;p&gt;Se non si volesse utilizzare un server tftpd esterno, è possibile (e più rapido) specificare l'host come tftpd server, eliminando l'opzione server= ed aggiungendo  &lt;tftp root='/tftpboot'/&gt; come figlio del tag &lt;ip&gt;, allo stesso livello del tag &lt;dhcp&gt;, per intenderci.&lt;/p&gt;
&lt;p&gt;dopo aver apportato questa modifica, è necessario riavviare il network; per fare cioò ricordatevi di spegnere tutte le macchine al suo interno perché, al meno con la mia versione, restartando il network con VM accese dentro, quelle stesse macchine non saranno più raggiungibili via network.&lt;/p&gt;
&lt;p&gt;Dopo aver fatto ciò, basta stoppare il network e startarlo di nuovo:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;virsh&lt;/span&gt; &lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="k"&gt;destroy&lt;/span&gt; &lt;span class="k"&gt;default&lt;/span&gt;
&lt;span class="n"&gt;virsh&lt;/span&gt; &lt;span class="k"&gt;start&lt;/span&gt; &lt;span class="k"&gt;default&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ora possiamo spostarci sulla VM che ospiterà tutto l'essenziale per l'installazione headless.&lt;/p&gt;
&lt;p&gt;La mia macchina di riferimento è una Centos 6, con 1G Ram e 1Vcpu; sul repository ufficiale è già presente tutto l'occorrente per il pxe booting.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;yum&lt;/span&gt; &lt;span class="n"&gt;install&lt;/span&gt; &lt;span class="n"&gt;tftp&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;server&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;nella directory /tftpboot sarà ora presente il bootloader pxelinux con i relativi files.&lt;/p&gt;
&lt;p&gt;per configurare il nostro booloader in bodo che ci permetta di scegliere che tipo di installazione fare, è necessario creare una directory all'interno del folder:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;mkdir&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;tftpboot&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;pxelinux&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cfg&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="n"&gt;centos6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;debian7&lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;all'interno della cartella pxelinux.cfg è necessario anche creare il file di configurazione che pxelinux cercherà come default, con il nome, appunto, default:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;default&lt;/span&gt; &lt;span class="n"&gt;grml32&lt;/span&gt;
&lt;span class="k"&gt;implicit&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;span class="n"&gt;prompt&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="n"&gt;timeout&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;
&lt;span class="n"&gt;ontimeout&lt;/span&gt; &lt;span class="n"&gt;localboot&lt;/span&gt;
&lt;span class="n"&gt;console&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;span class="nb"&gt;serial&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="mi"&gt;115200&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;span class="n"&gt;display&lt;/span&gt; &lt;span class="n"&gt;boot&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;msg&lt;/span&gt;
&lt;span class="n"&gt;F1&lt;/span&gt; &lt;span class="n"&gt;boot&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;msg&lt;/span&gt;

&lt;span class="n"&gt;LABEL&lt;/span&gt; &lt;span class="n"&gt;centos6&lt;/span&gt;
&lt;span class="n"&gt;MENU&lt;/span&gt; &lt;span class="n"&gt;LABEL&lt;/span&gt; &lt;span class="n"&gt;CENTOS6&lt;/span&gt; &lt;span class="mi"&gt;64&lt;/span&gt; &lt;span class="nb"&gt;bit&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Minimal&lt;/span&gt; &lt;span class="n"&gt;Installation&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;kernel&lt;/span&gt; &lt;span class="n"&gt;centos6&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;vmlinuz&lt;/span&gt;
&lt;span class="n"&gt;append&lt;/span&gt; &lt;span class="n"&gt;initrd&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;centos6&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;initrd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;img&lt;/span&gt; &lt;span class="n"&gt;ks&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="mi"&gt;192&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;168&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;122&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;91&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ks_centos6&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cfg&lt;/span&gt; &lt;span class="n"&gt;console&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ttyS0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;115200&lt;/span&gt; &lt;span class="n"&gt;earlyprint&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;serial&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;ttyS0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;115200&lt;/span&gt;

&lt;span class="n"&gt;LABEL&lt;/span&gt; &lt;span class="n"&gt;debian&lt;/span&gt;
&lt;span class="n"&gt;MENU&lt;/span&gt; &lt;span class="n"&gt;LABEL&lt;/span&gt; &lt;span class="n"&gt;DEBIAN&lt;/span&gt; &lt;span class="n"&gt;AMD64&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Debian&lt;/span&gt; &lt;span class="n"&gt;Testing&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;kernel&lt;/span&gt; &lt;span class="n"&gt;debian7&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;
&lt;span class="n"&gt;append&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="mi"&gt;192&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;168&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;122&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;91&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;base&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cfg&lt;/span&gt; &lt;span class="n"&gt;priority&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;critical&lt;/span&gt; &lt;span class="n"&gt;DEBIAN_FRONTEND&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;noninteractive&lt;/span&gt; &lt;span class="n"&gt;install&lt;/span&gt; &lt;span class="n"&gt;debconf&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;priority&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;medium&lt;/span&gt; &lt;span class="n"&gt;debian&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;installer&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;allow_unauthenticated&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;true&lt;/span&gt; &lt;span class="n"&gt;vga&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;true&lt;/span&gt; &lt;span class="n"&gt;initrd&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;debian7&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;initrd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gz&lt;/span&gt; &lt;span class="c1"&gt;-- console=ttyS0,115200 earlyprint=serial,ttyS0,115200&lt;/span&gt;

&lt;span class="n"&gt;LABEL&lt;/span&gt; &lt;span class="n"&gt;localboot&lt;/span&gt;
&lt;span class="n"&gt;MENU&lt;/span&gt; &lt;span class="n"&gt;LABEL&lt;/span&gt; &lt;span class="n"&gt;LOCALBOOT&lt;/span&gt;
&lt;span class="n"&gt;localboot&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;La configurazione prevede un file boot.msg in /tftpboot; un semplice file di test che faccia un print a video delle opzioni da poter utilizzare:&lt;/p&gt;
&lt;p&gt;!!!!!!PXE BOOT MENU!!!!!!!
    centos6 - minimal CentOS 64bit
    debian - Debian GNU/Linux Preseed&lt;/p&gt;
&lt;p&gt;in questo modo, sarà sempre possibile sapere cosa cercare all'avvio.&lt;/p&gt;
&lt;p&gt;è anche impostato un fallback per l'avvio da HD allo scadere del timout o, semplicemente, digitando localboot.&lt;/p&gt;
&lt;p&gt;Tra le impostazioni è anche necessario settare una console per la redirezione dell'output, segnate in grassetto. è importante mettere il richiamo al file boot.msg dopo la console, in modo da vederne l'output; alra cosa importante, è quella di settare la stessa velocità di baud tra pxelinux e l'installer kickstart/preseed (non è importante la velocità, dato che stiamo parlando di seriali virtuali :P ).&lt;/p&gt;
&lt;p&gt;come avrete notato, all'interno delle definizioni dei due tipi di installazione sono specificati i file locali dovre trovare kernel ed ramdisk (non dimenticate di copiare i binari nelle cartelle suddette, prendendoli direttamente dai siti delle distro), mentre il file di installazione automatico è reperibile via http. altra considerazione è l'aggiunta ai parametri di boot della console virtuale.
Per abilitare il tftpd server, è ora necessario modficare le linee del file /etc/xinetd.d/tftp:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nv"&gt;service&lt;/span&gt; &lt;span class="nv"&gt;tftp&lt;/span&gt;
{
&lt;span class="nv"&gt;socket_type&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;dgram&lt;/span&gt;
&lt;span class="nv"&gt;protocol&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;udp&lt;/span&gt;
&lt;span class="k"&gt;wait&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;yes&lt;/span&gt;
&lt;span class="nv"&gt;user&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;root&lt;/span&gt;
&lt;span class="nv"&gt;server&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nv"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nv"&gt;sbin&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nv"&gt;in&lt;/span&gt;.&lt;span class="nv"&gt;tftpd&lt;/span&gt;
&lt;span class="nv"&gt;server_args&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;s&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nv"&gt;tftpboot&lt;/span&gt;
&lt;span class="nv"&gt;disable&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;no&lt;/span&gt;
&lt;span class="nv"&gt;per_source&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;11&lt;/span&gt;
&lt;span class="nv"&gt;cps&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;
&lt;span class="nv"&gt;flags&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;IPv4&lt;/span&gt;
}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;le modifiche sono solo 2, come sottolineato.&lt;/p&gt;
&lt;p&gt;Ora un bel:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;kill&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;HUP&lt;/span&gt; &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pidof&lt;/span&gt; &lt;span class="n"&gt;xinetd&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;oppure&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;service&lt;/span&gt; &lt;span class="n"&gt;xinetd&lt;/span&gt; &lt;span class="k"&gt;start&lt;/span&gt;

&lt;span class="n"&gt;chkconfig&lt;/span&gt; &lt;span class="n"&gt;xinetd&lt;/span&gt; &lt;span class="k"&gt;on&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ed il nostro tftp server dovrebbe essere in ascolto sulla porta 69 udp:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;netstat&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;nlp&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;grep&lt;/span&gt; &lt;span class="n"&gt;xinetd&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Per la parte di webserver, ho utilizzato lighttpd, dato che la richiesta di risorse è infima, anche se ho perso qualche minuto per alcune configurazioni di default.&lt;/p&gt;
&lt;p&gt;Ovviamente, potete usare qualsiasi webserver, in grado di servire i files kickstart/preseed e, se l'avete configurato, il repository con i pacchetti da installare.&lt;/p&gt;
&lt;p&gt;Per prima cosa è necessario scaricare il binario dal repo epel, dato che centos non lo mette a disposizione:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;wget&lt;/span&gt; &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="n"&gt;dl&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fedoraproject&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;org&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;pub&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;epel&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;x86_64&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;lighttpd&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;35&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;el6&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;x86_64&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rpm&lt;/span&gt;
&lt;span class="n"&gt;rpm&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="n"&gt;lighttpd&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;35&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;el6&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;x86_64&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rpm&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ora, è necessario modificare un paconsole=ttyS0,115200 earlyprint=serial,ttyS0,115200io di parametri, per bindare correttamente il server e per la gestione del directory listing.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;sed&lt;/span&gt;  &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;/^/#/&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;lighttpd&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;lighttpd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;conf&lt;/span&gt;
&lt;span class="n"&gt;sed&lt;/span&gt;  &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dir&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;listing&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;activate&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;disable&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;enable&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;lighttpd&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;conf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dirlisting&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;conf&lt;/span&gt;
&lt;span class="n"&gt;mkdir&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;www&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;lighttpd&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="n"&gt;centos6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;debian7&lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;
&lt;span class="n"&gt;service&lt;/span&gt; &lt;span class="n"&gt;lighttpd&lt;/span&gt; &lt;span class="k"&gt;start&lt;/span&gt;
&lt;span class="n"&gt;chkconfig&lt;/span&gt; &lt;span class="n"&gt;lighttpd&lt;/span&gt; &lt;span class="k"&gt;on&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ora, non resta che creare i files kickstart/preseed (al momento ho solo un kickstart funzionante):&lt;/p&gt;
&lt;p&gt;ks_centos6.cfg:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="cp"&gt;#version=DEVEL&lt;/span&gt;
&lt;span class="n"&gt;install&lt;/span&gt;
&lt;span class="cp"&gt;#SYSTEM&lt;/span&gt;
&lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nl"&gt;http&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="c1"&gt;//192.168.122.91/cconsole=ttyS0,115200 earlyprint=serial,ttyS0,115200entos6&lt;/span&gt;
&lt;span class="n"&gt;lang&lt;/span&gt; &lt;span class="n"&gt;it_IT&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;UTF&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;
&lt;span class="n"&gt;keyboard&lt;/span&gt; &lt;span class="n"&gt;it&lt;/span&gt;
&lt;span class="n"&gt;network&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;onboot&lt;/span&gt; &lt;span class="n"&gt;yes&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;device&lt;/span&gt; &lt;span class="n"&gt;eth0&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;bootproto&lt;/span&gt; &lt;span class="n"&gt;dhcp&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;ipv6&lt;/span&gt; &lt;span class="k"&gt;auto&lt;/span&gt;
&lt;span class="n"&gt;rootpw&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;iscrypted&lt;/span&gt; &lt;span class="n"&gt;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&lt;/span&gt;
&lt;span class="n"&gt;firewall&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;service&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ssh&lt;/span&gt;
&lt;span class="n"&gt;authconfig&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;enableshadow&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;passalgo&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;sha512&lt;/span&gt;
&lt;span class="n"&gt;selinux&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;enforcing&lt;/span&gt;
&lt;span class="n"&gt;timezone&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;utc&lt;/span&gt; &lt;span class="n"&gt;Europe&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Rome&lt;/span&gt;
&lt;span class="n"&gt;bootloader&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;location&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;mbr&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;driveorder&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;vda&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;crashkernel=auto console=ttyS0,115200 earlyprint=serial,ttyS0,115200&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;skipx&lt;/span&gt;
&lt;span class="n"&gt;text&lt;/span&gt;
&lt;span class="n"&gt;reboot&lt;/span&gt;
&lt;span class="n"&gt;services&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;disabled&lt;/span&gt; &lt;span class="n"&gt;ip6tables&lt;/span&gt;
&lt;span class="n"&gt;services&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;enabled&lt;/span&gt; &lt;span class="n"&gt;ntpd&lt;/span&gt;
&lt;span class="n"&gt;zerombr&lt;/span&gt;
&lt;span class="n"&gt;clearpart&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;initlabel&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;all&lt;/span&gt;
&lt;span class="n"&gt;autopart&lt;/span&gt;

&lt;span class="cp"&gt;#PKGS&lt;/span&gt;
&lt;span class="n"&gt;repo&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;CentOS&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;baseurl&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nl"&gt;http&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="c1"&gt;//192.168.122.91/centos6/ --cost=100&lt;/span&gt;
&lt;span class="nf"&gt;%packages&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;nobase&lt;/span&gt;
&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="n"&gt;core&lt;/span&gt;
&lt;span class="nf"&gt;%end&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Le parti sottolineate sono ovviamente le più importanti affinché si possa generare un'installazione completamente automatica secondo i nostri criteri; in particolare, utilizzo un repository locale prodotto da una minimal iso di centos scaricabile dal sito della &lt;a href="http://mirrors.prometeus.net/centos/6.5/isos/x86_64/CentOS-6.5-x86_64-minimal.iso"&gt;distro&lt;/a&gt; copiando il conttenuto in /var/www/lighttpd/centos6/ (e kernel e initrd in /tftpboot/centos6 ).&lt;/p&gt;
&lt;p&gt;Per generare l'hash della passwd di root:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;openssl&lt;/span&gt; &lt;span class="n"&gt;passwd&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="ss"&gt;&amp;quot;mypasswd&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;anche qui, ho specificato la console con lo stesso baud rate degli altri componenti, in modo che grub passi al kernel la console da utilizzare dopo l'installazione. In questo modo, con una sola linea di codice sarà possibile installare una VM e trovarsi al suo prompt, in meno di 5 minuti!!!!&lt;/p&gt;
&lt;p&gt;compiuti questi passaggi siamo pronti per installare la nostra prima vm; torniamo sull'host e installiamo una VM con il seguente comando:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;virt&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;install&lt;/span&gt; &lt;span class="c1"&gt;--name test2 --virt-type kvm \&lt;/span&gt;
&lt;span class="c1"&gt;--vcpus=1 --ram 1072 --network network=default,model=virtio \ &lt;/span&gt;
&lt;span class="c1"&gt;--disk path=/home/j0lly/images/test02,size=8 \&lt;/span&gt;
&lt;span class="c1"&gt;--pxe  --nographics --os-variant=rhel6 --os-type=linux --autostart --debug&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;la parte magica qui è vestita dallo switch --pxe, che abilita il pxe booting durante l'installazione; da notare anche il network di riferimento, cioè quello utilizzato durante tutta la procedura del post.&lt;/p&gt;
&lt;p&gt;Questa Guida è un draft, scritto di fretta per non dimenticare le cose fatte.&lt;/p&gt;
&lt;p&gt;Spero di poter amliare, impaginare meglio ed aggiornare qualche conf, per ottimizzare la cosa.&lt;/p&gt;
&lt;p&gt;Stay TuNeD&lt;/p&gt;
&lt;p&gt;Fonti:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href="http://www.stephenwagner.com/?p=336"&gt;stephenwagner&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://andreasmarschke.wordpress.com/2012/11/04/pxe-setup-with-libvirt-and-kvm/"&gt;andreasmarschke&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://redmine.lighttpd.net/projects/1/wiki/Docs_ModDirlisting"&gt;lighttpd&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Virtualization_Host_Configuration_and_Guest_Installation_Guide/sect-Virtualization_Host_Configuration_and_Guest_Installation_Guide-Guest_Installation-Installing_guests_with_PXE.html"&gt;redhat&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://www.cyberciti.biz/faq/kvm-install-centos-redhat-using-kickstart-ks-cfg/"&gt;cyberciti&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://lists.soekris.com/pipermail/soekris-tech/2012-August/018541.html"&gt;soekris&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;</content><category term="kvm"></category><category term="libvirt"></category><category term="console"></category></entry><entry><title>[howto] from wordpress to postach.io!!!</title><link href="https://www.j0llyb0x.org/2014/howto-from-wordpress-to-postachio.html" rel="alternate"></link><published>2014-08-07T00:00:00+02:00</published><updated>2014-08-07T00:00:00+02:00</updated><author><name>j0lly</name></author><id>tag:www.j0llyb0x.org,2014-08-07:/2014/howto-from-wordpress-to-postachio.html</id><summary type="html">&lt;p&gt;Quando installai il mio primo blog personale, la presi come un'operazione didattica:
ho utilizzato uno sgarrupato vps che non stava manco in piedi (30Mb di RAM!!!) per installare tutto il necessario [mysql,php,nginx,wordpress] con relative costumizzazione etc.
Memore della mia performance e grato di aver appreso il necessario …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Quando installai il mio primo blog personale, la presi come un'operazione didattica:
ho utilizzato uno sgarrupato vps che non stava manco in piedi (30Mb di RAM!!!) per installare tutto il necessario [mysql,php,nginx,wordpress] con relative costumizzazione etc.
Memore della mia performance e grato di aver appreso il necessario sono ora senza molto tempo da dedicare al blog e, soprattuto, alla sua gestione quotidiana.
Ecco perché ho deciso di muovermi verso qualcosa di semplice, che richeidesse poco tempo per la gestione e che mi invogliasse a fare quello per il quale il blog è fatto: scrivere.   
ed ecco &lt;a href="http://postach.io/"&gt;postach.io&lt;/a&gt;, la soluzione davvero comoda per i pigri: i post, come tutta la tecnologia che sta dietro questa piattaforma di blogging, è evernote! dal video è subito chiaro quanto sia facile scrivere un articolo, formattarlo e, senza fronzoli, metterlo subito sul blog; in pratica ora, ogni volta che prenderò degli appunti, il passagio da pezzo di informazione a post utile alla comunità è davvero corto.&lt;/p&gt;
&lt;p&gt;Questo è il mio primo post su postach.io e, tra l'altro, parla proprio di come ho fatto a convertire il piei aricoli wordpress in formato leggibile da postach.io ed importarli direttamente in evernote.
Su internet c'è poco, ma fortunatamente qualcuno ha già fatto il 90% del lavoro: &lt;a href="https://github.com/jjg/wp2evernote"&gt;https://github.com/jjg/wp2evernote&lt;/a&gt; ha creato uno script in python (2.7) per l'importazione massiva dei propri post wordpress in evernote, già formattati per postach.io. Lo scrit però, come dice l'autore, è abbastanza rudimentale ed ha necessitato non pochi sforzi prima di arrivare al risultato. Ho anche deciso di provare a migliorare lo script avendo già alcune idee, sperando che anche il tempo abbondi..&lt;/p&gt;
&lt;p&gt;Premetto che le operazioni sono state fatte tramite il mio sistema Arch, quindi le librerie e versioni potrebbero variare leggermente nel vostro caso.
In breve, i passaggi necessari per convertire tutti  i nostri post wordpress in evernote sono i seguenti:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;creare un account su postach.io e creare la raccolta postach.io su evernote&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;richiedere un dev token su evernote per la manipolazione dell'account tramite API, all'indirizzo &lt;a href="https://www.evernote.com/api/DeveloperToken.action"&gt;https://www.evernote.com/api/DeveloperToken.action&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;installare evernote pyhton sdk: &lt;a href="https://github.com/evernote/evernote-sdk-python"&gt;https://github.com/evernote/evernote-sdk-python&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;disabilitare tutti  i plugins perché alcuni interferiscono con l'archivio xml prodotto da wordpress.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;esportare i propri articoli da wordpress: Tools&amp;gt;Export&amp;gt;Posts.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Aggiungere un tag radice (E.G. &lt;root&gt; &lt;/root&gt;) altrimenti l'archivio non viene parsato dallo script di import:&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="postach.io" src="https://www.j0llyb0x.org/images/fail-1.png"&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;prendi script da github: &lt;a href="https://github.com/jjg/wp2evernote"&gt;https://github.com/jjg/wp2evernote&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;fare un check del file xml perché titoli mancanti o problemi simili faranno inceppare lo script (es. &lt;title&gt;&lt;/title&gt; )&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="postach.io" src="https://www.j0llyb0x.org/images/fail-2.png"&gt;&lt;/p&gt;
&lt;p&gt;Dopo un paio di tentativi dovreste avere la vostra bella raccolta di articoli imoprtati in evernote: ricordate che sarann otuti già marcati come pubblicati e verranno quindi esposti (anche le draft)&lt;/p&gt;
&lt;p&gt;Durante la mia piccola oddissea di una giornata ho riscontrato alcuni errori di carattere più personale che potrebbero essere di scarso valore per il resto del mondo, ma un'informazione in più è meglio di una in meno :P&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;thrift-arch:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Il pacchetto Aur per le API evernote-python su Archlinux è probabilmente non aggiornato, perché elimina la libreria Thrift embeddata nell'SDK ma la libreria servita da Arch è forse troppo recente e comunque non funziona bene con le API dell'SDK:&lt;/p&gt;
&lt;p&gt;&lt;img alt="postach.io" src="https://www.j0llyb0x.org/images/fail-3.png"&gt;&lt;/p&gt;
&lt;p&gt;modificando il PKGBUILD e lasciando la libreria originale, lo script funziona correttamente. 
Durante l'importazione dei post, ho riscontrato alcuni fallimenti, dovuti a post malformati o non perfettamente gestiti da Wordpress (ad esempio quelli embeddati via altri servizi )&lt;/p&gt;
&lt;p&gt;&lt;img alt="postach.io" src="https://www.j0llyb0x.org/images/fail-4.png"&gt;&lt;/p&gt;
&lt;p&gt;Questo è un semplice draft che spero di riaggiornare quand oavrò il tempo di mettere le mani sullo script di import sopra menzionato.&lt;/p&gt;
&lt;p&gt;Stay tuned!&lt;/p&gt;
&lt;p&gt;EDIT:&lt;/p&gt;
&lt;p&gt;Dopo l'import del sito ho notato che le imagini venivano gestite come link e non direttamente scaricate; questo non è bene per evernote dato che dovrebbe essere il nostro cesto dei ricordi e, se il link è rotto, addio ricordo :P.
Nel caso della migrazione da Wp, questo è ancora peggio, dato che i link puntano ad un blog wordpress che deve essere dismesso..
Con un po di volontà e tanta voglia di riscoprire il python, ho voluto contribuire allo script linkato sopra, per aggiungere la funzionalità di upload delle immagini, migliorando anche qualche errore in fase di parsing e gestione caratteri utf-8! Ho già fatto una pull request, ma se qualcuno ( :D ) volesse utilizzare lo script da subito, &lt;a href="https://github.com/j0lly/wp2evernote/tree/beautifulsoup"&gt;questo&lt;/a&gt; è il mio github forkato ed aggiornato; il branch è beautifulsoap perché ho aggiunto &lt;a href="http://www.crummy.com/software/BeautifulSoup/"&gt;la libreria&lt;/a&gt; alle dipendenze, che va installata separatamente.&lt;/p&gt;
&lt;p&gt;EDIT 2 [2015-06-17]:&lt;/p&gt;
&lt;p&gt;Ormai da qualche tempo postach.io (maledetto lui) è diventato a pagamento, revocando tutti i siti nell'arco di 20 giorni.
La cosa penosa è stato scoprire che non esistono metodi semplici per riprendersi tutti i post migrati da wordpress su evernote, soprattutto considerando che non ho più molto tempo da dedicare al blog...
Alla fine sono riuscito a migrare nuovamente da evernote (sintassi proprietaria) e postach.io (maledetti e 2) ad un metodo di storage dei documenti su markdown, ed utilizzando un motore di generazione di siti statici chiamato pelican (python) molto simile nella sostanza a jekyll, per chi lo conosce.
Sto ancora migrando, a fatica immagine econtenuti, oltre che correggere vari problemi di encoding dovuti alle varie migrazioni, ma suppongo di riuscire a migrare tutto a breve.&lt;/p&gt;
&lt;p&gt;Farò probabilemnte un nuovo articolo per presentare Pelican e come ho deciso di hostare il nuovo sito.&lt;/p&gt;
&lt;p&gt;Stay Tuned&lt;/p&gt;</content><category term="fail"></category><category term="xml"></category><category term="evernote"></category><category term="python"></category></entry><entry><title>[parte II] DNS, questo sconosciuto.. Configurazione di un Master autoritativo puro</title><link href="https://www.j0llyb0x.org/2014/parte-ii-dns-questo-sconosciuto-configurazione-di-un-master-autoritativo-puro.html" rel="alternate"></link><published>2014-06-19T00:00:00+02:00</published><updated>2014-06-19T00:00:00+02:00</updated><author><name>j0lly</name></author><id>tag:www.j0llyb0x.org,2014-06-19:/2014/parte-ii-dns-questo-sconosciuto-configurazione-di-un-master-autoritativo-puro.html</id><summary type="html">&lt;p&gt;Eccomi per la configurazione personale del mio Bind9 Master, autoritativo per il mio dominio, ed assolutamente non ricorsivo :).&lt;/p&gt;
&lt;p&gt;&lt;img alt="bind9" src="https://www.j0llyb0x.org/images/bind-1.png"&gt;&lt;/p&gt;
&lt;p&gt;Nell'articolo mostro anche dei test con dig per verificare le configurazioni ed il livello di sicurezza; consiglio di leggere la teoria alla base delle scelte di configurazione scritte nell'articolo &lt;a href="http://j0llyb0x.org/parte-i-dns-questo-sconosciuto-06-2014/"&gt;I sui DNS …&lt;/a&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;Eccomi per la configurazione personale del mio Bind9 Master, autoritativo per il mio dominio, ed assolutamente non ricorsivo :).&lt;/p&gt;
&lt;p&gt;&lt;img alt="bind9" src="https://www.j0llyb0x.org/images/bind-1.png"&gt;&lt;/p&gt;
&lt;p&gt;Nell'articolo mostro anche dei test con dig per verificare le configurazioni ed il livello di sicurezza; consiglio di leggere la teoria alla base delle scelte di configurazione scritte nell'articolo &lt;a href="http://j0llyb0x.org/parte-i-dns-questo-sconosciuto-06-2014/"&gt;I sui DNS&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Premetto che la maggior parte del lavoro di configurazione è stato preso da &lt;a href="http://d.stavrovski.net/blog/post/how-to-setup-and-configure-a-master-dns-bind-server-in-debian-wheezyjessie"&gt;questo articolo&lt;/a&gt;, dove l'autore sembra davvero competente. Lui ha utilizzato una confgurazioen in chroot; io spero di poter testare la cosa in futuri, come compendio ad un terzo articolo sugli slave o magari sull'implementazione di un dns interno con forwarding etc.&lt;/p&gt;
&lt;p&gt;La mia confgurazione consiste in:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;un server bind 9.8.4&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Debian 7.5&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;bind in ascolto sull'interfaccia esterna come su localhost&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;configurazione Master (con già la predisposizione agli slaves e lo zone transfer)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Bind, dall'esterno, risolve solo le zone per le quali è autoritativo (mio dominio)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;dall'interno (localhost) è possibile fare richieste DNS utilizzando la ricorsività direttamente verso i root servers; in realtà la macchina usa google come DNS, ma lasciare quest'opzione aperta non è male, soprattutto in fase di test.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Bind9 su debian utilizza 4 principali files di configurazione:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;named.conf&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;named.conf.default-zones&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;named.conf.options&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;named.conf.local&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;named.conf fa semplicemente il source degli altri 3 files.&lt;/p&gt;
&lt;p&gt;named.conf.default-zones contiene le zone di default, tra cui gli indirizzi dei root servers e le zone per localhost (necessarie se si usa bind come resolver interno); anche questo file può non essere toccato.&lt;/p&gt;
&lt;p&gt;Named.conf.options è il file che gestisce tutte le regole globali del NameServer, non specificatamente definite all'interno dei contesti "zone".&lt;/p&gt;
&lt;p&gt;Ecco il mio:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="cm"&gt;/*&lt;/span&gt;
&lt;span class="cm"&gt;* Deny transfers by default except for the listed hosts.&lt;/span&gt;
&lt;span class="cm"&gt;* If we have other name servers, place them here.&lt;/span&gt;
&lt;span class="cm"&gt;*/&lt;/span&gt;
&lt;span class="nv"&gt;acl&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="s"&gt;xfer&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; {
&lt;span class="nv"&gt;xxx&lt;/span&gt;.&lt;span class="nv"&gt;xxx&lt;/span&gt;.&lt;span class="nv"&gt;xxx&lt;/span&gt;.&lt;span class="nv"&gt;xxx&lt;/span&gt;&lt;span class="c1"&gt;;&lt;/span&gt;
}&lt;span class="c1"&gt;;&lt;/span&gt;

&lt;span class="cm"&gt;/*&lt;/span&gt;
&lt;span class="cm"&gt;* You might put in here some ips which are allowed to use the cache or&lt;/span&gt;
&lt;span class="cm"&gt;* recursive queries&lt;/span&gt;
&lt;span class="cm"&gt;*/&lt;/span&gt;
&lt;span class="nv"&gt;acl&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="s"&gt;trusted&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; {
&lt;span class="mi"&gt;127&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="c1"&gt;;&lt;/span&gt;
}&lt;span class="c1"&gt;;&lt;/span&gt;

&lt;span class="nv"&gt;options&lt;/span&gt; {
&lt;span class="nv"&gt;directory&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="s"&gt;/var/cache/bind&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="c1"&gt;;&lt;/span&gt;
&lt;span class="nv"&gt;pid&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;file&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="s"&gt;/var/run/named/named.pid&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="c1"&gt;;&lt;/span&gt;
&lt;span class="nv"&gt;dump&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;file&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="s"&gt;/tmp/named_master_dump.db&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="c1"&gt;;&lt;/span&gt;

&lt;span class="nv"&gt;listen&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;on&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;v6&lt;/span&gt; { &lt;span class="nv"&gt;none&lt;/span&gt;&lt;span class="c1"&gt;; };&lt;/span&gt;
&lt;span class="o"&gt;//&lt;/span&gt; &lt;span class="nv"&gt;listen&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;on&lt;/span&gt; { &lt;span class="mi"&gt;127&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="c1"&gt;; };&lt;/span&gt;
&lt;span class="nv"&gt;listen&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;on&lt;/span&gt; { &lt;span class="nv"&gt;any&lt;/span&gt;&lt;span class="c1"&gt;; };&lt;/span&gt;

&lt;span class="cm"&gt;/*&lt;/span&gt;
&lt;span class="cm"&gt;* Accept queries from our &amp;quot;trusted&amp;quot; ACL. We will&lt;/span&gt;
&lt;span class="cm"&gt;* allow anyone to query our master zones below.&lt;/span&gt;
&lt;span class="cm"&gt;* This prevents us from becoming a free DNS server&lt;/span&gt;
&lt;span class="cm"&gt;* to the masses.&lt;/span&gt;
&lt;span class="cm"&gt;*/&lt;/span&gt;
&lt;span class="nv"&gt;allow&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;query&lt;/span&gt; {
&lt;span class="nv"&gt;trusted&lt;/span&gt;&lt;span class="c1"&gt;;&lt;/span&gt;
}&lt;span class="c1"&gt;;&lt;/span&gt;

&lt;span class="cm"&gt;/* Use the cache for the &amp;quot;trusted&amp;quot; ACL. */&lt;/span&gt;
&lt;span class="nv"&gt;allow&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;query&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;cache&lt;/span&gt; {
&lt;span class="nv"&gt;trusted&lt;/span&gt;&lt;span class="c1"&gt;;&lt;/span&gt;
}&lt;span class="c1"&gt;;&lt;/span&gt;

&lt;span class="cm"&gt;/* Only trusted addresses are allowed to use recursion. */&lt;/span&gt;
&lt;span class="nv"&gt;allow&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;recursion&lt;/span&gt; {
&lt;span class="nv"&gt;trusted&lt;/span&gt;&lt;span class="c1"&gt;;&lt;/span&gt;
}&lt;span class="c1"&gt;;&lt;/span&gt;

&lt;span class="cm"&gt;/* Zone tranfers are denied by default. */&lt;/span&gt;
&lt;span class="nv"&gt;allow&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;transfer&lt;/span&gt; {
&lt;span class="nv"&gt;none&lt;/span&gt;&lt;span class="c1"&gt;;&lt;/span&gt;
}&lt;span class="c1"&gt;;&lt;/span&gt;

&lt;span class="cm"&gt;/* Don&amp;#39;t allow updates, e.g. via nsupdate. */&lt;/span&gt;
&lt;span class="nv"&gt;allow&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;update&lt;/span&gt; {
&lt;span class="nv"&gt;none&lt;/span&gt;&lt;span class="c1"&gt;;&lt;/span&gt;
}&lt;span class="c1"&gt;;&lt;/span&gt;

&lt;span class="cm"&gt;/* if you have problems and are behind a firewall: */&lt;/span&gt;
&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="nv"&gt;query&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;source&lt;/span&gt; &lt;span class="nv"&gt;address&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="nv"&gt;port&lt;/span&gt; &lt;span class="mi"&gt;53&lt;/span&gt;&lt;span class="c1"&gt;;&lt;/span&gt;

&lt;span class="nv"&gt;dnssec&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;validation&lt;/span&gt; &lt;span class="nv"&gt;auto&lt;/span&gt;&lt;span class="c1"&gt;;&lt;/span&gt;
&lt;span class="nv"&gt;auth&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;nxdomain&lt;/span&gt; &lt;span class="nv"&gt;no&lt;/span&gt;&lt;span class="c1"&gt;; # conform to RFC1035&lt;/span&gt;
&lt;span class="nv"&gt;version&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="s"&gt;windows NT&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="c1"&gt;;&lt;/span&gt;

&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="nv"&gt;forward&lt;/span&gt; &lt;span class="nv"&gt;first&lt;/span&gt;

&lt;span class="o"&gt;//&lt;/span&gt; &lt;span class="nv"&gt;forwarders&lt;/span&gt; {
&lt;span class="o"&gt;//&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="c1"&gt;;&lt;/span&gt;
&lt;span class="o"&gt;//&lt;/span&gt; }&lt;span class="c1"&gt;;&lt;/span&gt;
}&lt;span class="c1"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;In soldoni, questo file crea alcune acl: la prima da applicare al xfer transfer, nel caso creiate degli slave, basta aggiungere i loro ip sostituendoli alle xxx; la seconda crea un gruppo di ip trusted che potranno usare il NameServer come resolver ricorsivo (a la Google DNS).&lt;/p&gt;
&lt;p&gt;Alla configurazione di default ho aggiunto l'opzione dump-file, perché esiste un bug (per lo meno nel pacchetto debian) che di default scrive il dump delle zone in una cartella non accessibile a bind, facendomi impazzire in fase di troubleshooting; più in basso è stato disabilitato l'IPv6..&lt;/p&gt;
&lt;p&gt;Le direttive successive in pratica abilitano query, lettura record in cache e recursion solo per gli IP trusted (localhost) e vedremo che queste opzioni vengono sovrascritte all'interno della nostra zona particolare.&lt;/p&gt;
&lt;p&gt;Ultima direttiva utile è il deny del trasfer che, anch'esso, verrà riabilitato per determinati host in sede di opzioni di zona.&lt;/p&gt;
&lt;p&gt;la direttiva version che ho aggiunto, beh, ne parlo dopo :P&lt;/p&gt;
&lt;p&gt;Named.conf.local è il file preposto alla gestione delle zone personali, con confgurazioni ad-hoc e il richiamo al file.db con i dati della zona; il mio è così:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;
&lt;span class="o"&gt;//&lt;/span&gt; &lt;span class="k"&gt;Do&lt;/span&gt; &lt;span class="nv"&gt;any&lt;/span&gt; &lt;span class="nv"&gt;local&lt;/span&gt; &lt;span class="nv"&gt;configuration&lt;/span&gt; &lt;span class="nv"&gt;here&lt;/span&gt;
&lt;span class="o"&gt;//&lt;/span&gt;

&lt;span class="o"&gt;//&lt;/span&gt; &lt;span class="nv"&gt;Consider&lt;/span&gt; &lt;span class="nv"&gt;adding&lt;/span&gt; &lt;span class="nv"&gt;the&lt;/span&gt; &lt;span class="mi"&gt;1918&lt;/span&gt; &lt;span class="nv"&gt;zones&lt;/span&gt; &lt;span class="nv"&gt;here&lt;/span&gt;, &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nv"&gt;they&lt;/span&gt; &lt;span class="nv"&gt;are&lt;/span&gt; &lt;span class="nv"&gt;not&lt;/span&gt; &lt;span class="nv"&gt;used&lt;/span&gt; &lt;span class="nv"&gt;in&lt;/span&gt; &lt;span class="nv"&gt;your&lt;/span&gt;
&lt;span class="o"&gt;//&lt;/span&gt; &lt;span class="nv"&gt;organization&lt;/span&gt;
&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="k"&gt;include&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="s"&gt;/etc/bind/zones.rfc1918&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="c1"&gt;;&lt;/span&gt;

&lt;span class="o"&gt;//&lt;/span&gt; &lt;span class="nv"&gt;We&lt;/span&gt; &lt;span class="nv"&gt;are&lt;/span&gt; &lt;span class="nv"&gt;the&lt;/span&gt; &lt;span class="nv"&gt;master&lt;/span&gt; &lt;span class="nv"&gt;server&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nv"&gt;j0llyb0x&lt;/span&gt;.&lt;span class="nv"&gt;org&lt;/span&gt;
&lt;span class="nv"&gt;zone&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="s"&gt;j0llyb0x.org&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; {
&lt;span class="nv"&gt;type&lt;/span&gt; &lt;span class="nv"&gt;master&lt;/span&gt;&lt;span class="c1"&gt;;&lt;/span&gt;
&lt;span class="nv"&gt;file&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="s"&gt;/etc/bind/db.j0llyb0x.org&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="c1"&gt;;&lt;/span&gt;
&lt;span class="nv"&gt;allow&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;query&lt;/span&gt; { &lt;span class="nv"&gt;any&lt;/span&gt;&lt;span class="c1"&gt;; };&lt;/span&gt;
&lt;span class="nv"&gt;allow&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;transfer&lt;/span&gt; { &lt;span class="nv"&gt;xfer&lt;/span&gt;&lt;span class="c1"&gt;; };&lt;/span&gt;
}&lt;span class="c1"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Nella configurazione di zona, come si vede, si punta al file (ricordate il path assoluto!) che hosta i records, per i quali siamo Master; le due direttive allow-query e allow-transfer, servono a gestire questa zona particolare, permettendo le query non ricorsive (la cache dei record e la ricorsività restano disabilitati a livello di conf globali) per i record specifici e il transfer da parte degli host slave "sicuri".&lt;/p&gt;
&lt;p&gt;Da notare che non ho ancora configurato i PTR records, ma non è complesso partendo da quello di default per localhost (127.in-addr.arpa). In questo file viene specificata una zona di competenza, per la quale bind è autoritativo e Master.&lt;/p&gt;
&lt;p&gt;Ed ecco il contenuto del mio file di zona db.j0llyb0x.org:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;;&lt;/span&gt;
&lt;span class="c1"&gt;; Zone file for j0llyb0x.org&lt;/span&gt;
&lt;span class="c1"&gt;;&lt;/span&gt;
$&lt;span class="nv"&gt;TTL&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="nv"&gt;D&lt;/span&gt;
@ &lt;span class="mi"&gt;100&lt;/span&gt; &lt;span class="nv"&gt;IN&lt;/span&gt; &lt;span class="nv"&gt;SOA&lt;/span&gt; &lt;span class="nv"&gt;ns1&lt;/span&gt;.&lt;span class="nv"&gt;j0llyb0x&lt;/span&gt;.&lt;span class="nv"&gt;org&lt;/span&gt;. &lt;span class="nv"&gt;admin&lt;/span&gt;.&lt;span class="nv"&gt;j0llyb0x&lt;/span&gt;.&lt;span class="nv"&gt;org&lt;/span&gt;. &lt;span class="ss"&gt;(&lt;/span&gt;

&lt;span class="mi"&gt;201406181&lt;/span&gt; &lt;span class="c1"&gt;; serial, todays date+todays serial&lt;/span&gt;
&lt;span class="mi"&gt;28800&lt;/span&gt; &lt;span class="c1"&gt;; refresh, seconds&lt;/span&gt;
&lt;span class="mi"&gt;7200&lt;/span&gt; &lt;span class="c1"&gt;; retry, seconds&lt;/span&gt;
&lt;span class="mi"&gt;360000&lt;/span&gt; &lt;span class="c1"&gt;; expire, seconds&lt;/span&gt;
&lt;span class="mi"&gt;86400&lt;/span&gt; &lt;span class="c1"&gt;; minimum, seconds&lt;/span&gt;
&lt;span class="ss"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;; DEFINE NS RECORDS&lt;/span&gt;
&lt;span class="nv"&gt;ns1&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt; &lt;span class="nv"&gt;IN&lt;/span&gt; &lt;span class="nv"&gt;A&lt;/span&gt; &lt;span class="nv"&gt;xxx&lt;/span&gt;.&lt;span class="nv"&gt;xxx&lt;/span&gt;.&lt;span class="nv"&gt;xxx&lt;/span&gt;.&lt;span class="nv"&gt;xxx&lt;/span&gt;
@ &lt;span class="mi"&gt;100&lt;/span&gt; &lt;span class="nv"&gt;IN&lt;/span&gt; &lt;span class="nv"&gt;NS&lt;/span&gt; &lt;span class="nv"&gt;ns1&lt;/span&gt;.&lt;span class="nv"&gt;j0llyb0x&lt;/span&gt;.&lt;span class="nv"&gt;org&lt;/span&gt;.
&lt;span class="c1"&gt;; DEFINE A RECORDS&lt;/span&gt;
@ &lt;span class="mi"&gt;100&lt;/span&gt; &lt;span class="nv"&gt;IN&lt;/span&gt; &lt;span class="nv"&gt;A&lt;/span&gt; &lt;span class="nv"&gt;xxx&lt;/span&gt;.&lt;span class="nv"&gt;xxx&lt;/span&gt;.&lt;span class="nv"&gt;xxx&lt;/span&gt;.&lt;span class="nv"&gt;xxx&lt;/span&gt;
&lt;span class="nv"&gt;madhatter&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt; &lt;span class="nv"&gt;IN&lt;/span&gt; &lt;span class="nv"&gt;A&lt;/span&gt; &lt;span class="nv"&gt;xxx&lt;/span&gt;.&lt;span class="nv"&gt;xxx&lt;/span&gt;.&lt;span class="nv"&gt;xxx&lt;/span&gt;.&lt;span class="nv"&gt;xxx&lt;/span&gt;
&lt;span class="nv"&gt;newsun&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt; &lt;span class="nv"&gt;IN&lt;/span&gt; &lt;span class="nv"&gt;A&lt;/span&gt; &lt;span class="nv"&gt;xxx&lt;/span&gt;.&lt;span class="nv"&gt;xxx&lt;/span&gt;.&lt;span class="nv"&gt;xxx&lt;/span&gt;.&lt;span class="nv"&gt;xxx&lt;/span&gt;
&lt;span class="nv"&gt;mail&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt; &lt;span class="nv"&gt;IN&lt;/span&gt; &lt;span class="nv"&gt;A&lt;/span&gt; &lt;span class="nv"&gt;xxx&lt;/span&gt;.&lt;span class="nv"&gt;xxx&lt;/span&gt;.&lt;span class="nv"&gt;xxx&lt;/span&gt;.&lt;span class="nv"&gt;xxx&lt;/span&gt;

&lt;span class="c1"&gt;; DEFINE CNAME&lt;/span&gt;
&lt;span class="nv"&gt;www&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt; &lt;span class="nv"&gt;IN&lt;/span&gt; &lt;span class="nv"&gt;CNAME&lt;/span&gt; @
&lt;span class="nv"&gt;ftp&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt; &lt;span class="nv"&gt;IN&lt;/span&gt; &lt;span class="nv"&gt;CNAME&lt;/span&gt; &lt;span class="nv"&gt;newsun&lt;/span&gt;
&lt;span class="nv"&gt;ns&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt; &lt;span class="nv"&gt;IN&lt;/span&gt; &lt;span class="nv"&gt;CNAME&lt;/span&gt; &lt;span class="nv"&gt;madhatter&lt;/span&gt;

&lt;span class="c1"&gt;; DEFINE MX RECORDS&lt;/span&gt;
@ &lt;span class="mi"&gt;100&lt;/span&gt; &lt;span class="nv"&gt;IN&lt;/span&gt; &lt;span class="nv"&gt;MX&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="nv"&gt;mail&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Non ho studiato molto i parametri e valori ottimali per timeout etc, ma credo che questi (presi dal blog già referenziato sopra) siano più che accettabili per un uso didattico.&lt;/p&gt;
&lt;p&gt;La lista è semplice: viene richiamato un record SOA che punta al NS Master primario per il dominio j0llyb0x.org (@ sta per il nome referenziato nel file di zona in named.conf.local); come seconda cosa, ho referenziato il NS con un record A e, poi, definendolo come NS per il dominio.&lt;/p&gt;
&lt;p&gt;Successivamente ho impostato alcuni record A ad alcuni server; infine dei CNAME ed un MX server (totalmente fittizio dato che non ho un server di posta :P ).&lt;/p&gt;
&lt;p&gt;Non sto qui a spiegare cosa fanno i vari record perché esiste una marea di documentazione e, soprattutto, esistono gli RFC &lt;a href="https://www.rfc-editor.org/rfc/rfc1034.txt"&gt;1034&lt;/a&gt; e &lt;a href="https://www.rfc-editor.org/rfc/rfc1035.txt"&gt;1035&lt;/a&gt;!&lt;/p&gt;
&lt;p&gt;Come chicca, vorrei lasciare alcune info che ho reperito sulla rete rispetto al discovery di informazioni sensibili da parte del Server Bind (alcuni post sull'argomento risalgono al 2006 :P):&lt;/p&gt;
&lt;p&gt;all'interno del codice di Bind, si trovano dei record di zona non dichiarati esplicitamente, che possono mostrare alcune info importanti come:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;versione del server BIND&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;autori per la versione&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;hostname della macchina&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;"ID" per il quale non ho capito l'utilizzo&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;dal codice:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;&lt;/span&gt;
&lt;span class="ss"&gt;#&lt;/span&gt;
&lt;span class="ss"&gt;# Zones in the &amp;quot;&lt;/span&gt;&lt;span class="n"&gt;_bind&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot; view are NOT counted in the count of zones.&lt;/span&gt;
&lt;span class="ss"&gt;#&lt;/span&gt;
&lt;span class="ss"&gt;view &amp;quot;&lt;/span&gt;&lt;span class="n"&gt;_bind&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot; chaos {&lt;/span&gt;
&lt;span class="ss"&gt;recursion no&lt;/span&gt;
&lt;span class="ss"&gt;notify no&lt;/span&gt;
&lt;span class="ss"&gt;allow-new-zones no&lt;/span&gt;

&lt;span class="ss"&gt;zone &amp;quot;&lt;/span&gt;&lt;span class="k"&gt;version&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot; chaos {&lt;/span&gt;
&lt;span class="ss"&gt;type master&lt;/span&gt;
&lt;span class="ss"&gt;database &amp;quot;&lt;/span&gt;&lt;span class="n"&gt;_builtin&lt;/span&gt; &lt;span class="k"&gt;version&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;&lt;/span&gt;
&lt;span class="ss"&gt;}&lt;/span&gt;

&lt;span class="ss"&gt;zone &amp;quot;&lt;/span&gt;&lt;span class="n"&gt;hostname&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot; chaos {&lt;/span&gt;
&lt;span class="ss"&gt;type master&lt;/span&gt;
&lt;span class="ss"&gt;database &amp;quot;&lt;/span&gt;&lt;span class="n"&gt;_builtin&lt;/span&gt; &lt;span class="n"&gt;hostname&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;&lt;/span&gt;
&lt;span class="ss"&gt;}&lt;/span&gt;

&lt;span class="ss"&gt;zone &amp;quot;&lt;/span&gt;&lt;span class="n"&gt;authors&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot; chaos {&lt;/span&gt;
&lt;span class="ss"&gt;type master&lt;/span&gt;
&lt;span class="ss"&gt;database &amp;quot;&lt;/span&gt;&lt;span class="n"&gt;_builtin&lt;/span&gt; &lt;span class="n"&gt;authors&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;&lt;/span&gt;
&lt;span class="ss"&gt;}&lt;/span&gt;

&lt;span class="ss"&gt;zone &amp;quot;&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot; chaos {&lt;/span&gt;
&lt;span class="ss"&gt;type master&lt;/span&gt;
&lt;span class="ss"&gt;database &amp;quot;&lt;/span&gt;&lt;span class="n"&gt;_builtin&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="err"&gt;&amp;quot;&lt;/span&gt;
&lt;span class="err"&gt;}&lt;/span&gt;
&lt;span class="err"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;"&lt;/p&gt;
&lt;p&gt;Con la configurazione Bind che ho fatto, queste informazioni non sono rivelate alla rete, ma potete provarle facendo una query particolare con dig da un ip in acl "trusted" o, se preferite, su qualche sventurato server (io non l'ho detto):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;dig&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="n"&gt;TXT&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="k"&gt;c&lt;/span&gt; &lt;span class="n"&gt;CHAOS&lt;/span&gt; &lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="n"&gt;HOSTNAME&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="k"&gt;VERSION&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;AUTHORS&lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;BIND&lt;/span&gt; &lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ip&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Il mio risultato :)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[root@newsun][~]&lt;/span&gt;
&lt;span class="na"&gt;06:54:37 # dig -t TXT -c CHAOS VERSION.BIND @127.0.0.1&lt;/span&gt;

&lt;span class="c1"&gt;; DiG 9.8.4-rpz2+rl005.12-P1 ; -t TXT -c CHAOS VERSION.BIND @127.0.0.1&lt;/span&gt;
&lt;span class="c1"&gt;; global options: +cmd&lt;/span&gt;
&lt;span class="c1"&gt;; Got answer:&lt;/span&gt;
&lt;span class="c1"&gt;; HEADER - opcode: QUERY, status: NOERROR, id: 40540&lt;/span&gt;
&lt;span class="c1"&gt;; flags: qr aa rd; QUERY: 1, ANSWER: 1, AUTHORITY: 1, ADDITIONAL: 0&lt;/span&gt;
&lt;span class="c1"&gt;; WARNING: recursion requested but not available&lt;/span&gt;

&lt;span class="c1"&gt;; QUESTION SECTION:&lt;/span&gt;
&lt;span class="na"&gt;VERSION.BIND. CH TXT&lt;/span&gt;

&lt;span class="c1"&gt;; ANSWER SECTION:&lt;/span&gt;
&lt;span class="na"&gt;VERSION.BIND. 0 CH TXT &amp;quot;windows NT&amp;quot;&lt;/span&gt;

&lt;span class="c1"&gt;; AUTHORITY SECTION:&lt;/span&gt;
&lt;span class="na"&gt;VERSION.BIND. 0 CH NS VERSION.BIND.&lt;/span&gt;

&lt;span class="c1"&gt;; Query time: 0 msec&lt;/span&gt;
&lt;span class="c1"&gt;; SERVER: 127.0.0.1#53(127.0.0.1)&lt;/span&gt;
&lt;span class="c1"&gt;; WHEN: Thu Jun 19 06:54:42 2014&lt;/span&gt;
&lt;span class="c1"&gt;; MSG SIZE rcvd: 67&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;come di consueto lascio le referenze:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href="http://d.stavrovski.net/blog/post/how-to-setup-and-configure-a-master-dns-bind-server-in-debian-wheezyjessie"&gt;stavrovski&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://www.hostingtalk.it/come-funziona-il-sistema-dns-e-come-si-gestisce-un-dns-server-con-bind_-c000000zc/"&gt;hostingtalk&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://guide.debianizzati.org/index.php/Un_server_DNS_e_DHCP_su_Debian"&gt;debianizzati&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://www.openlogic.com/wazi/bid/188011/Secure-and-Reliable-Authoritative-DNS-with-BIND"&gt;openlogic&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://www.zytrax.com/books/dns/ch6/"&gt;zytrax&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;</content><category term="bind"></category><category term="dns"></category></entry><entry><title>[parte I] DNS, questo sconosciuto..</title><link href="https://www.j0llyb0x.org/2014/parte-i-dns-questo-sconosciuto.html" rel="alternate"></link><published>2014-06-17T00:00:00+02:00</published><updated>2014-06-17T00:00:00+02:00</updated><author><name>j0lly</name></author><id>tag:www.j0llyb0x.org,2014-06-17:/2014/parte-i-dns-questo-sconosciuto.html</id><summary type="html">&lt;p&gt;Non puoi dire di conoscere una cosa in informatica(in realtà non potresti dirlo mai) finché non ti ci sporchi le mani. &lt;/p&gt;
&lt;p&gt;Cominciamo con un Dry run..
teoria del DNS:
- Il servizio dns è nato perché in passato i pochi siti raggiungibili via internet erano gestiti in un unico foglio …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Non puoi dire di conoscere una cosa in informatica(in realtà non potresti dirlo mai) finché non ti ci sporchi le mani. &lt;/p&gt;
&lt;p&gt;Cominciamo con un Dry run..
teoria del DNS:
- Il servizio dns è nato perché in passato i pochi siti raggiungibili via internet erano gestiti in un unico foglio di testo che associava gli IP ai nomi, più semplici da ricordare.
Con il boom di internet si è reso necessario un approccio più flessibile ed è nato un sistema distribuito di database di carattere "tree" per la gestione dei nomi a dominio: il DNS.&lt;/p&gt;
&lt;p&gt;&lt;img alt="bind" src="https://www.j0llyb0x.org/images/bind-2.png"&gt;&lt;/p&gt;
&lt;p&gt;Il portocollo ha varie implementazioni ma la più usata è senza ombra di dubbio BIND(9) ed è anche la mia scelta (anche se vorrò smanacciare un po con il simpatico dnsmasq che però ha uno scopo e un'implementazione differente da BIND.&lt;/p&gt;
&lt;p&gt;BIND è attualmente la versione 9 ed è in sviluppo dagli anni 80'. questo articolo parla di DNS e, quando si parla di configurazioni si fa riferimento a BIND versione 9.x su ambiente Debian (nella parte II).&lt;/p&gt;
&lt;p&gt;Come ho già detto, DNS è un protocollo implementato a vari livelli, per il quale esistono vari compiti da assolvere.&lt;/p&gt;
&lt;p&gt;Quando viene fatta una query, un NameServer si può comportare nei seguenti modi, che possono essere sovrapposti o separati nei compiti:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;autoritativo&lt;/li&gt;
&lt;li&gt;di cache&lt;/li&gt;
&lt;li&gt;forwarder&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ricorsivo&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;autoritativo&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Nel primo caso, il server possiede dei record DNS (A, TXT, PTR, MX etc..) gestiti direttamente da lui (o a livello secondario come slave), che fornirà su richiesta previa query nella propria cache. come detto, se un server è autoritativo puro, se gli si chiedesse un IP non presente nelle sue tabelle, egli dovrebbe risponderebbe picche (si vedrà che questo non è sempre vero).&lt;/p&gt;
&lt;p&gt;Per fare un esempio pratico, possiamo usare dig (suite dnsutils) è capire meglio cosa sia un server autoritativo per un dominio e come dovrebbe comportarsi:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[&lt;span class="nv"&gt;root&lt;/span&gt;@&lt;span class="nv"&gt;newsun&lt;/span&gt;][&lt;span class="o"&gt;~&lt;/span&gt;] &lt;span class="mi"&gt;04&lt;/span&gt;:&lt;span class="mi"&gt;57&lt;/span&gt;:&lt;span class="mi"&gt;30&lt;/span&gt;
&lt;span class="nv"&gt;dig&lt;/span&gt; &lt;span class="nv"&gt;ANY&lt;/span&gt; &lt;span class="nv"&gt;google&lt;/span&gt;.&lt;span class="nv"&gt;com&lt;/span&gt; @&lt;span class="nv"&gt;ns1&lt;/span&gt;.&lt;span class="nv"&gt;google&lt;/span&gt;.&lt;span class="nv"&gt;com&lt;/span&gt;

&lt;span class="c1"&gt;; DiG 9.8.4-rpz2+rl005.12-P1 ; ANY google.com @ns1.google.com&lt;/span&gt;
&lt;span class="c1"&gt;; global options: +cmd&lt;/span&gt;
&lt;span class="c1"&gt;; Got answer:&lt;/span&gt;
&lt;span class="c1"&gt;; - HEADER - opcode: QUERY, status: NOERROR, id: 49650&lt;/span&gt;
&lt;span class="c1"&gt;; flags: qr aa rd; QUERY: 1, ANSWER: 19, AUTHORITY: 0, ADDITIONAL: 0&lt;/span&gt;
&lt;span class="c1"&gt;; WARNING: recursion requested but not available&lt;/span&gt;

&lt;span class="c1"&gt;; QUESTION SECTION:&lt;/span&gt;
&lt;span class="nv"&gt;google&lt;/span&gt;.&lt;span class="nv"&gt;com&lt;/span&gt;. &lt;span class="nv"&gt;IN&lt;/span&gt; &lt;span class="nv"&gt;ANY&lt;/span&gt;

&lt;span class="c1"&gt;; ANSWER SECTION:&lt;/span&gt;
&lt;span class="nv"&gt;google&lt;/span&gt;.&lt;span class="nv"&gt;com&lt;/span&gt;. &lt;span class="mi"&gt;300&lt;/span&gt; &lt;span class="nv"&gt;IN&lt;/span&gt; &lt;span class="nv"&gt;A&lt;/span&gt; &lt;span class="mi"&gt;74&lt;/span&gt;.&lt;span class="mi"&gt;125&lt;/span&gt;.&lt;span class="mi"&gt;21&lt;/span&gt;.&lt;span class="mi"&gt;113&lt;/span&gt;
&lt;span class="nv"&gt;google&lt;/span&gt;.&lt;span class="nv"&gt;com&lt;/span&gt;. &lt;span class="mi"&gt;300&lt;/span&gt; &lt;span class="nv"&gt;IN&lt;/span&gt; &lt;span class="nv"&gt;A&lt;/span&gt; &lt;span class="mi"&gt;74&lt;/span&gt;.&lt;span class="mi"&gt;125&lt;/span&gt;.&lt;span class="mi"&gt;21&lt;/span&gt;.&lt;span class="mi"&gt;101&lt;/span&gt;
&lt;span class="nv"&gt;google&lt;/span&gt;.&lt;span class="nv"&gt;com&lt;/span&gt;. &lt;span class="mi"&gt;300&lt;/span&gt; &lt;span class="nv"&gt;IN&lt;/span&gt; &lt;span class="nv"&gt;A&lt;/span&gt; &lt;span class="mi"&gt;74&lt;/span&gt;.&lt;span class="mi"&gt;125&lt;/span&gt;.&lt;span class="mi"&gt;21&lt;/span&gt;.&lt;span class="mi"&gt;138&lt;/span&gt;
&lt;span class="nv"&gt;google&lt;/span&gt;.&lt;span class="nv"&gt;com&lt;/span&gt;. &lt;span class="mi"&gt;300&lt;/span&gt; &lt;span class="nv"&gt;IN&lt;/span&gt; &lt;span class="nv"&gt;A&lt;/span&gt; &lt;span class="mi"&gt;74&lt;/span&gt;.&lt;span class="mi"&gt;125&lt;/span&gt;.&lt;span class="mi"&gt;21&lt;/span&gt;.&lt;span class="mi"&gt;102&lt;/span&gt;
&lt;span class="nv"&gt;google&lt;/span&gt;.&lt;span class="nv"&gt;com&lt;/span&gt;. &lt;span class="mi"&gt;300&lt;/span&gt; &lt;span class="nv"&gt;IN&lt;/span&gt; &lt;span class="nv"&gt;A&lt;/span&gt; &lt;span class="mi"&gt;74&lt;/span&gt;.&lt;span class="mi"&gt;125&lt;/span&gt;.&lt;span class="mi"&gt;21&lt;/span&gt;.&lt;span class="mi"&gt;139&lt;/span&gt;
&lt;span class="nv"&gt;google&lt;/span&gt;.&lt;span class="nv"&gt;com&lt;/span&gt;. &lt;span class="mi"&gt;300&lt;/span&gt; &lt;span class="nv"&gt;IN&lt;/span&gt; &lt;span class="nv"&gt;A&lt;/span&gt; &lt;span class="mi"&gt;74&lt;/span&gt;.&lt;span class="mi"&gt;125&lt;/span&gt;.&lt;span class="mi"&gt;21&lt;/span&gt;.&lt;span class="mi"&gt;100&lt;/span&gt;
&lt;span class="nv"&gt;google&lt;/span&gt;.&lt;span class="nv"&gt;com&lt;/span&gt;. &lt;span class="mi"&gt;300&lt;/span&gt; &lt;span class="nv"&gt;IN&lt;/span&gt; &lt;span class="nv"&gt;AAAA&lt;/span&gt; &lt;span class="mi"&gt;2607&lt;/span&gt;:&lt;span class="nv"&gt;f8b0&lt;/span&gt;:&lt;span class="mi"&gt;4002&lt;/span&gt;:&lt;span class="nv"&gt;c06&lt;/span&gt;::&lt;span class="mi"&gt;71&lt;/span&gt;
&lt;span class="nv"&gt;google&lt;/span&gt;.&lt;span class="nv"&gt;com&lt;/span&gt;. &lt;span class="mi"&gt;600&lt;/span&gt; &lt;span class="nv"&gt;IN&lt;/span&gt; &lt;span class="nv"&gt;MX&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="nv"&gt;aspmx&lt;/span&gt;.&lt;span class="nv"&gt;l&lt;/span&gt;.&lt;span class="nv"&gt;google&lt;/span&gt;.&lt;span class="nv"&gt;com&lt;/span&gt;.
&lt;span class="nv"&gt;google&lt;/span&gt;.&lt;span class="nv"&gt;com&lt;/span&gt;. &lt;span class="mi"&gt;86400&lt;/span&gt; &lt;span class="nv"&gt;IN&lt;/span&gt; &lt;span class="nv"&gt;TYPE257&lt;/span&gt; \\# &lt;span class="mi"&gt;19&lt;/span&gt; &lt;span class="mi"&gt;0005697373756573796&lt;/span&gt;&lt;span class="nv"&gt;D616E7465632E636F6D&lt;/span&gt;
&lt;span class="nv"&gt;google&lt;/span&gt;.&lt;span class="nv"&gt;com&lt;/span&gt;. &lt;span class="mi"&gt;345600&lt;/span&gt; &lt;span class="nv"&gt;IN&lt;/span&gt; &lt;span class="nv"&gt;NS&lt;/span&gt; &lt;span class="nv"&gt;ns4&lt;/span&gt;.&lt;span class="nv"&gt;google&lt;/span&gt;.&lt;span class="nv"&gt;com&lt;/span&gt;.
&lt;span class="nv"&gt;google&lt;/span&gt;.&lt;span class="nv"&gt;com&lt;/span&gt;. &lt;span class="mi"&gt;345600&lt;/span&gt; &lt;span class="nv"&gt;IN&lt;/span&gt; &lt;span class="nv"&gt;NS&lt;/span&gt; &lt;span class="nv"&gt;ns3&lt;/span&gt;.&lt;span class="nv"&gt;google&lt;/span&gt;.&lt;span class="nv"&gt;com&lt;/span&gt;.
&lt;span class="nv"&gt;google&lt;/span&gt;.&lt;span class="nv"&gt;com&lt;/span&gt;. &lt;span class="mi"&gt;600&lt;/span&gt; &lt;span class="nv"&gt;IN&lt;/span&gt; &lt;span class="nv"&gt;MX&lt;/span&gt; &lt;span class="mi"&gt;30&lt;/span&gt; &lt;span class="nv"&gt;alt2&lt;/span&gt;.&lt;span class="nv"&gt;aspmx&lt;/span&gt;.&lt;span class="nv"&gt;l&lt;/span&gt;.&lt;span class="nv"&gt;google&lt;/span&gt;.&lt;span class="nv"&gt;com&lt;/span&gt;.
&lt;span class="nv"&gt;google&lt;/span&gt;.&lt;span class="nv"&gt;com&lt;/span&gt;. &lt;span class="mi"&gt;600&lt;/span&gt; &lt;span class="nv"&gt;IN&lt;/span&gt; &lt;span class="nv"&gt;MX&lt;/span&gt; &lt;span class="mi"&gt;40&lt;/span&gt; &lt;span class="nv"&gt;alt3&lt;/span&gt;.&lt;span class="nv"&gt;aspmx&lt;/span&gt;.&lt;span class="nv"&gt;l&lt;/span&gt;.&lt;span class="nv"&gt;google&lt;/span&gt;.&lt;span class="nv"&gt;com&lt;/span&gt;.
&lt;span class="nv"&gt;google&lt;/span&gt;.&lt;span class="nv"&gt;com&lt;/span&gt;. &lt;span class="mi"&gt;600&lt;/span&gt; &lt;span class="nv"&gt;IN&lt;/span&gt; &lt;span class="nv"&gt;MX&lt;/span&gt; &lt;span class="mi"&gt;50&lt;/span&gt; &lt;span class="nv"&gt;alt4&lt;/span&gt;.&lt;span class="nv"&gt;aspmx&lt;/span&gt;.&lt;span class="nv"&gt;l&lt;/span&gt;.&lt;span class="nv"&gt;google&lt;/span&gt;.&lt;span class="nv"&gt;com&lt;/span&gt;.
&lt;span class="nv"&gt;google&lt;/span&gt;.&lt;span class="nv"&gt;com&lt;/span&gt;. &lt;span class="mi"&gt;345600&lt;/span&gt; &lt;span class="nv"&gt;IN&lt;/span&gt; &lt;span class="nv"&gt;NS&lt;/span&gt; &lt;span class="nv"&gt;ns2&lt;/span&gt;.&lt;span class="nv"&gt;google&lt;/span&gt;.&lt;span class="nv"&gt;com&lt;/span&gt;.
&lt;span class="nv"&gt;google&lt;/span&gt;.&lt;span class="nv"&gt;com&lt;/span&gt;. &lt;span class="mi"&gt;345600&lt;/span&gt; &lt;span class="nv"&gt;IN&lt;/span&gt; &lt;span class="nv"&gt;NS&lt;/span&gt; &lt;span class="nv"&gt;ns1&lt;/span&gt;.&lt;span class="nv"&gt;google&lt;/span&gt;.&lt;span class="nv"&gt;com&lt;/span&gt;.
&lt;span class="nv"&gt;google&lt;/span&gt;.&lt;span class="nv"&gt;com&lt;/span&gt;. &lt;span class="mi"&gt;3600&lt;/span&gt; &lt;span class="nv"&gt;IN&lt;/span&gt; &lt;span class="nv"&gt;TXT&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="s"&gt;v=spf1 include:_spf.google.com ip4:216.73.93.70/31 ip4:216.73.93.72/31 ~all&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;span class="nv"&gt;google&lt;/span&gt;.&lt;span class="nv"&gt;com&lt;/span&gt;. &lt;span class="mi"&gt;600&lt;/span&gt; &lt;span class="nv"&gt;IN&lt;/span&gt; &lt;span class="nv"&gt;MX&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt; &lt;span class="nv"&gt;alt1&lt;/span&gt;.&lt;span class="nv"&gt;aspmx&lt;/span&gt;.&lt;span class="nv"&gt;l&lt;/span&gt;.&lt;span class="nv"&gt;google&lt;/span&gt;.&lt;span class="nv"&gt;com&lt;/span&gt;.
&lt;span class="nv"&gt;google&lt;/span&gt;.&lt;span class="nv"&gt;com&lt;/span&gt;. &lt;span class="mi"&gt;86400&lt;/span&gt; &lt;span class="nv"&gt;IN&lt;/span&gt; &lt;span class="nv"&gt;SOA&lt;/span&gt; &lt;span class="nv"&gt;ns1&lt;/span&gt;.&lt;span class="nv"&gt;google&lt;/span&gt;.&lt;span class="nv"&gt;com&lt;/span&gt;. &lt;span class="nv"&gt;dns&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;admin&lt;/span&gt;.&lt;span class="nv"&gt;google&lt;/span&gt;.&lt;span class="nv"&gt;com&lt;/span&gt;. &lt;span class="mi"&gt;2014021800&lt;/span&gt; &lt;span class="mi"&gt;7200&lt;/span&gt; &lt;span class="mi"&gt;1800&lt;/span&gt; &lt;span class="mi"&gt;1209600&lt;/span&gt; &lt;span class="mi"&gt;300&lt;/span&gt;

&lt;span class="c1"&gt;; Query time: 14 msec&lt;/span&gt;
&lt;span class="c1"&gt;; SERVER: 216.239.32.10#53(216.239.32.10)&lt;/span&gt;
&lt;span class="c1"&gt;; WHEN: Tue Jun 17 04:57:31 2014&lt;/span&gt;
&lt;span class="c1"&gt;; MSG SIZE rcvd: 497&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Ecco un esempio di query Ad un NameServer autoritativo per la sua zona; la query è stata fatta all'indirizzo ip del DNS server primario di google, richiedendo qualsiasi record pertitnente al nome a dominio google.com.&lt;/p&gt;
&lt;p&gt;La risposta del server mostra chiaramente che lui stesso (il server contattato tramite dig) è il detentore della zona dns per google.com come si vede nel flag AA (autoritative answer) e dal record SOA/NS per google.com che mostra ns1.google.com come Server DNS autoritativo per il dominio.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;di cache&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Se un server non è autoritativo per la zona, non vuol dire che non possieda in cache dei record DNS, può succedere infatti che tali record siano presenti e la cache è il primo luogo dove il server guarda (a parte la propria zona autoritativa) prima di compiere qualsiasi altra azione. In questo caso la risposta sarà presa dalla cache che in genere viene gestita in concomitanza di Nameservers Forwarder/Ricorsivi.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;forwarder&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Per servire un contenuto dalla cache un NameServer deve prima aver ricevuto il record da qualcuno :) e questo è uno dei tre metodi di interazione che un DNS server può avere con altri Server nel caso gli sia fatta una query alla quale non sa rispondere direttamente. Se il Server è configurato per avere dei forwarders, egli "girerà la query" al DNS server preposto, in attesa della risposta da servire. In genere, se presente, quest'opzione è preferita alla ricorsione diretta. Dall'altro lato, un server Forwarder non è altro che un NameServer Ricorsivo (non vedo l'utilità che non lo sia) che fa da spoiler per un DNs interno in modo da separare fisicamente query interne e query esterne. Ancora un Forwarder può essere impiegato per diminuire l'area di esposizione di una rete interna settando per tutti gli altri NS un unico forwarder che farà le query non autoritative per loro.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ricorsivo&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è qui che entrano in gioco i server NS ricorsivi: Questi server permettono di fare query ricorsive per nomi/IP per i quali non sono autoritativi. Ad esempio, i DNS pubblici di Google, sono NS non autoritativi (nel caso ve lo foste chiesto come me, Google non hosta le sue zone sui server pubblici che ha regalato a noi :) ). Ovviamente questi server avranno anche una cache (a meno di averla disabilitata) ma il succo è che, per ogni record richiesto, a meno di cache, faranno il percorso dell'alberatura DNS fino a fare la query al corretto SOA/NS per quel particolare nome a dominio, restituendo il risultato richiesto. Un server DNS che fa da Forwarder sarà quasi sicuramente ricorsivo e la query in questione può essere osservata sempre utilizzando dig:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;root@newsun&lt;/span&gt;&lt;span class="o"&gt;][&lt;/span&gt;&lt;span class="n"&gt;/etc&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="mi"&gt;05&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;59&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dig&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;google&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;trace&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DiG&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;9.8.4&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rpz2&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;rl005&lt;/span&gt;&lt;span class="mf"&gt;.12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;P1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;google&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;trace&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;global&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nl"&gt;options&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;cmd&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3600000&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;G&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ROOT&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;SERVERS&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;NET&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3600000&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ROOT&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;SERVERS&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;NET&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3600000&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;I&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ROOT&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;SERVERS&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;NET&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3600000&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ROOT&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;SERVERS&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;NET&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3600000&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;H&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ROOT&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;SERVERS&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;NET&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3600000&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;C&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ROOT&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;SERVERS&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;NET&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3600000&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;L&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ROOT&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;SERVERS&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;NET&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3600000&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;D&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ROOT&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;SERVERS&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;NET&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3600000&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;J&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ROOT&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;SERVERS&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;NET&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3600000&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;K&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ROOT&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;SERVERS&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;NET&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3600000&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ROOT&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;SERVERS&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;NET&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3600000&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ROOT&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;SERVERS&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;NET&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3600000&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ROOT&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;SERVERS&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;NET&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Received&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;228&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bytes&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;127.0.0.1&lt;/span&gt;&lt;span class="n"&gt;#53&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;127.0.0.1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;644&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;172800&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gtld&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;servers&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;172800&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gtld&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;servers&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;172800&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gtld&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;servers&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;172800&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gtld&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;servers&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;172800&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gtld&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;servers&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;172800&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gtld&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;servers&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;172800&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gtld&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;servers&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;172800&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gtld&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;servers&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;172800&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gtld&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;servers&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;172800&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gtld&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;servers&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;172800&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gtld&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;servers&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;172800&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gtld&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;servers&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;172800&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gtld&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;servers&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Received&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;500&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bytes&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;192.36.148.17&lt;/span&gt;&lt;span class="n"&gt;#53&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;192.36.148.17&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;693&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="n"&gt;google&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;172800&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ns2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;google&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;google&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;172800&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ns1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;google&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;google&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;172800&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ns3&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;google&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;google&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;172800&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ns4&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;google&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Received&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;164&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bytes&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;192.54.112.30&lt;/span&gt;&lt;span class="n"&gt;#53&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;192.54.112.30&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;429&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="n"&gt;google&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;74.125.21.113&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;google&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;74.125.21.100&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;google&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;74.125.21.138&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;google&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;74.125.21.102&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;google&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;74.125.21.101&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;google&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;IN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;74.125.21.139&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Received&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;124&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bytes&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;216.239.32.10&lt;/span&gt;&lt;span class="n"&gt;#53&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;216.239.32.10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;14&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;In breve, il DNS server (o resolver interno) ha caricato la lista dei root server di internet; successivamente ha lanciato una query ad uno di loro (192.36.148.17 - non ricorsivo) ricevendo la lista dei NameServer autoritativi per lo spazio dei nomi più ampio (.com); ora viene lanciata un'altra query identica, ma come target avremo uno degli NS server autoritativi per la radice .com (192.54.112.30 - sempre non ricorsivo) che restituirà la lista degli NS autoritativi per il successivo spazio dei nomi (.google.); finalmente abbiamo trovato gli indirizzi che "devono" sapere che indirizzo ha google.com; la query viene ora fatta all'NS di google ( 216.239.32.10 - non ricorsivo :) ) che ci restituisce finalmente i record A (default) della nostra query (74.125.21.*) da notare che google usa DNS round robin per il bilanciamento del carico sui frontend, ma questa è un'altra storia :).&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;iterativo&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Alcuni NS (in teoria tutti quelli autoritativi per fattori di sicurezza) non possono essere utilizzati per trovare i record al di fuori delle proprie zone di gestione autoritative. Gli esempi più banali sono appunto i root server di Internet. Questi server mantengono un database autoritativo di tutti i NS che gestiscono lo spazio dei nomi di primo livello (.com,.org,.it etc) ed hanno già un bel da fare a soddisfare le richieste del mondo rispetto a questi indirizzi. Questi ed altri server con grande carico di lavoro si limitano a gestire query iterative per le quali sono direttamente responsabili.&lt;/p&gt;
&lt;p&gt;Come si è visto nell'esempio precedente con dig, i root server non hanno fatto il lavoro per noi, restituendoci il risultato (come farebbe un forwarder o un NS ricorsivo) ma dandoci gli indirizzi del primo livello utile a lui demandato (in questo caso gli indirizzi di chi gestisce i domini sotto .com).&lt;/p&gt;
&lt;p&gt;Questa è una panoramica parziale del mondo DNS e dei tipi di NameServers e sicuramente ci saranno delle imprecisioni che, spero, chi passerà di qua saprà puntualizzare.&lt;/p&gt;
&lt;p&gt;A fondo metto alcune references che mi hanno aiutato a capire come funziona il tutto; lascio per la seconda parte le eventuali configurazioni e i problemi più o meno banali che ho incontrato nei miei esperimenti.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href="http://tools.ietf.org/html/rfc1034"&gt;RFC1034&lt;/a&gt; e &lt;a href="http://tools.ietf.org/html/rfc1035"&gt;RFC1035&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://lia.deis.unibo.it/Courses/ModApplRetiCalc0607/materiale/4dns.pdf"&gt;slide sul DNS&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://www.slashroot.in/difference-between-iterative-and-recursive-dns-query"&gt;differenti tipi di query DNS&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;</content><category term="dns"></category><category term="bind"></category><category term="debian"></category></entry><entry><title>[Serie: OpenNebula] [Arch] [Kvm] Overview e preparativi</title><link href="https://www.j0llyb0x.org/2014/serie-opennebula-arch-kvm-overview-e-preparativi.html" rel="alternate"></link><published>2014-02-02T00:00:00+01:00</published><updated>2014-02-02T00:00:00+01:00</updated><author><name>j0lly</name></author><id>tag:www.j0llyb0x.org,2014-02-02:/2014/serie-opennebula-arch-kvm-overview-e-preparativi.html</id><summary type="html">&lt;p&gt;Col 2014 ho intenzione di dedicarmi ad un progetto molto ambizioso : aprire un datacenter! :)
Ovviamente non ho liquidità e fondi quindi ho deciso di cominciare il progetto Virtualizzando un ambiente OpenNebula via Kvm sul mio portatile Vaio #Arch Based.&lt;/p&gt;
&lt;p&gt;&lt;img alt="opennebula" src="https://www.j0llyb0x.org/images/opennebula-1.jpg"&gt;&lt;/p&gt;
&lt;p&gt;L'dea è di virtualizzare via Kvm delle macchine host L1 che …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Col 2014 ho intenzione di dedicarmi ad un progetto molto ambizioso : aprire un datacenter! :)
Ovviamente non ho liquidità e fondi quindi ho deciso di cominciare il progetto Virtualizzando un ambiente OpenNebula via Kvm sul mio portatile Vaio #Arch Based.&lt;/p&gt;
&lt;p&gt;&lt;img alt="opennebula" src="https://www.j0llyb0x.org/images/opennebula-1.jpg"&gt;&lt;/p&gt;
&lt;p&gt;L'dea è di virtualizzare via Kvm delle macchine host L1 che formeranno il mio private "Cloud".
Gli Host L1 saranno così configurati:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;1/2 Host Storage (non ancora identificati) per la gestione storage degli altri host ed ovviamente dei filesystem dedicati alle VM L2/L3;&lt;/li&gt;
&lt;li&gt;2/3 Host Centos 6.5 per la virtualizzazione che utilizzeranno libvirt, qemu-Kvm ed OpenvSwitch;&lt;/li&gt;
&lt;li&gt;2 Host Centos 6.5 In HA per la gestione della Suite OpenNebula.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In questo Primo articolo parto dai presupposti, riportando le azioni per preparare il setup del mio Host Primario (Arch) per ospitare tutta la virtualizzazione sottostante.
Questa prima parte della serie non è propriamente correlata ad OpenNebula ma è comunque importante ed ho piacere di condividerla nel caso qualche Archers passasse di qua ;).
Per prima cosa do qualche info su pacchetti e tecnologia utilizzata:&lt;/p&gt;
&lt;p&gt;1   ArchLinux Kernel 3.8.8-2-ARCH (&amp;lt;3.10): Non prendetemi per matto, aggiorno i componenti, ma esiste un bug di Kvm che previene l'utilizzo del Nesting Kvm a partire dal kernel 3.10 ed ho quindi dovuto downgradare il mio kernel ad una versione adeguata.
2 Filesystem Btrfs: Anche qua una nota dolente, dato che Btrfs è stupendo per moltissimi aspetti, ma non si può dire che sia performante quando si parla di gestire immagini dischi. Un modo per minimizzare i problemi di performance sono:&lt;/p&gt;
&lt;p&gt;2   Disabilitare il Copy on Write nella directory che ospita i file dischi:  &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;chattr&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;R&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="k"&gt;C&lt;/span&gt; &lt;span class="o"&gt;~/&lt;/span&gt;&lt;span class="n"&gt;Path&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="k"&gt;To&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;VMs&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;Pool&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;3   Riempire le immagini preallocando metadati e spazio in modo da minimizzare la frammentazione:  &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;qemu&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;img&lt;/span&gt; &lt;span class="k"&gt;create&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="n"&gt;qcow2&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;o&lt;/span&gt; &lt;span class="n"&gt;preallocation&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;metadata&lt;/span&gt; &lt;span class="n"&gt;OpenNebula01&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="k"&gt;G&lt;/span&gt;

&lt;span class="n"&gt;ls&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="n"&gt;OpenNebula01&lt;/span&gt;
&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rw&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="c1"&gt;--r-- 1 j0lly j0lly 5369757696 31 dic 01.53 OpenNebula01&lt;/span&gt;
&lt;span class="n"&gt;fallocate&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="mi"&gt;5369757696&lt;/span&gt; &lt;span class="n"&gt;OpenNebula01&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;4   Libvirt config: 
Per poter produrre il laboratorio virtuale OpenNebula è necessario abilitare il nesting Kvm sull'Host principale, in modo da esporre VT ( o AMD-V ) nelle Cpu virtuali all'interno delle VM; il parametro nel Kernel per abilitare il nesting è kvm-intel.nested=1 e può essere caricato al boot via bootloader, via modprobe o, nel caso di Arch, più comodamente aggiungendo il file kvm_nesting.conf nella directory /etc/modprobe.d/ con il contenuto:  &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;options&lt;/span&gt; &lt;span class="n"&gt;kvm&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;intel&lt;/span&gt; &lt;span class="n"&gt;nested&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Un ulteriore accorgimento che consiglio è quello di gestire i pool su dischi/partizioni separate da /, ma in questo modo qemu, che viene startato come utente &lt;em&gt;nobody&lt;/em&gt;, non sarà in grado di traversare le partizioni e non potrà accedere ai pool. Le opzioni sono varie ma io per comodità ho impostato il mio utente locale come owner del processo qemu, in modo da mantenere una configurazione funzionante senza dover utilizzare root per far girare le VM:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$&lt;span class="o"&gt;~&lt;/span&gt; &lt;span class="nv"&gt;grep&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;C2&lt;/span&gt; &lt;span class="nv"&gt;j0lly&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nv"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nv"&gt;libvirt&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nv"&gt;qemu&lt;/span&gt;.&lt;span class="nv"&gt;conf&lt;/span&gt;
# &lt;span class="nv"&gt;user&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="s"&gt;100&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; # &lt;span class="nv"&gt;A&lt;/span&gt; &lt;span class="nv"&gt;user&lt;/span&gt; &lt;span class="nv"&gt;named&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="s"&gt;100&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="nv"&gt;or&lt;/span&gt; &lt;span class="nv"&gt;a&lt;/span&gt; &lt;span class="nv"&gt;user&lt;/span&gt; &lt;span class="nv"&gt;with&lt;/span&gt; &lt;span class="nv"&gt;uid&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;
#
&lt;span class="nv"&gt;user&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="s"&gt;j0lly&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;

# &lt;span class="nv"&gt;The&lt;/span&gt; &lt;span class="nv"&gt;group&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nv"&gt;QEMU&lt;/span&gt; &lt;span class="nv"&gt;processes&lt;/span&gt; &lt;span class="nv"&gt;run&lt;/span&gt; &lt;span class="nv"&gt;by&lt;/span&gt; &lt;span class="nv"&gt;the&lt;/span&gt; &lt;span class="nv"&gt;system&lt;/span&gt; &lt;span class="nv"&gt;instance&lt;/span&gt;. &lt;span class="nv"&gt;It&lt;/span&gt; &lt;span class="nv"&gt;can&lt;/span&gt; &lt;span class="nv"&gt;b&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Ultimo personale accorgimento è quello di aggiungere la variabile al .bashrc (o rc per la vostra shell) in modo da gestire automaticamente l'hypervisor con i vari tools e api di libvirt:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;export&lt;/span&gt; &lt;span class="n"&gt;LIBVIRT_DEFAULT_URI&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;qemu&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;///&lt;/span&gt;&lt;span class="k"&gt;system&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Tutte le configurazioni di base per Libvirt le potete invece trovare sul &lt;a href="https://wiki.archlinux.org/index.php/libvirt"&gt;wiki di Arch&lt;/a&gt; che è sempre impeccabile.
Con questo breve articolo ho spiegato cosa utilizzerò per l'installazione del Cloud virtuale che ospiterà il mio datacenter personale :).
Nel Prossimo aritcolo mi occuperò dell'installazione di OpenNebula e della configurazione in HA tramite Red-Hat Cluster.&lt;/p&gt;
&lt;p&gt;Stay Tuned!&lt;/p&gt;</content><category term="kvm"></category><category term="opennebula"></category><category term="cloud"></category><category term="archlinux"></category></entry><entry><title>[Python] I socket: un Server TCP-IP</title><link href="https://www.j0llyb0x.org/2013/python-i-socket-un-server-tcp-ip.html" rel="alternate"></link><published>2013-06-25T00:00:00+02:00</published><updated>2013-06-25T00:00:00+02:00</updated><author><name>j0lly</name></author><id>tag:www.j0llyb0x.org,2013-06-25:/2013/python-i-socket-un-server-tcp-ip.html</id><summary type="html">&lt;p&gt;Per terminare la mia prima &lt;a href="http://j0llyb0x.org/python-i-socket-client-tcp-ip-06-2013/"&gt;introduzione ai socket&lt;/a&gt;, posto il compendio di un buon client TCP: un server TCP-IP scritto in Pyhton.&lt;/p&gt;
&lt;p&gt;Disclaimer: ricordo che questo "&lt;em&gt;esercizio&lt;/em&gt;" di programmazione è stato scritto in &lt;a href="http://www.binarytides.com/"&gt;questo ottimo blog&lt;/a&gt;, dal quale ruberò sicuramente altri esempi dato che l'autore è davvero molto chiaro e …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Per terminare la mia prima &lt;a href="http://j0llyb0x.org/python-i-socket-client-tcp-ip-06-2013/"&gt;introduzione ai socket&lt;/a&gt;, posto il compendio di un buon client TCP: un server TCP-IP scritto in Pyhton.&lt;/p&gt;
&lt;p&gt;Disclaimer: ricordo che questo "&lt;em&gt;esercizio&lt;/em&gt;" di programmazione è stato scritto in &lt;a href="http://www.binarytides.com/"&gt;questo ottimo blog&lt;/a&gt;, dal quale ruberò sicuramente altri esempi dato che l'autore è davvero molto chiaro e competente.&lt;/p&gt;
&lt;p&gt;&lt;img alt="socket" src="https://www.j0llyb0x.org/images/socket-1.png"&gt;&lt;/p&gt;
&lt;p&gt;Posto anche il Link alle pagine di &lt;a href="http://docs.python.org/2/library/socket.html"&gt;manuale sui sockets&lt;/a&gt; (python 2.7) tanto per non perdere l'abitudine (non si sa mai che qualcuno pensi che servano a qualcosa :P).&lt;/p&gt;
&lt;p&gt;Come nell'articolo precedente, ecco l'indice:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;la costruzione di un client python che si connette ad un server, invia dati sul socket e attende la risposta prima di chiudere la comunicazione;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;la creazione di un server, sempre in python, che si mette in ascolto su una porta e fa da “pappagallo” stampando a schermo quello che riceve dal mittente; anche in multi-threading.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Oggi, per concludere l'introduzione, scrivo e commento il &lt;em&gt;server.&lt;/em&gt;
_discalimer: _usando Archlinux, il mio interprete python di default è python 3.x, e necessito specificare l'interprete adeguato (pyhton2) per questo codice.&lt;/p&gt;
&lt;h3&gt;Il server&lt;/h3&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/usr/bin/env python2&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;socket&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;thread&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;

&lt;span class="n"&gt;HOST&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt; &lt;span class="c1"&gt;# se non metto nulla, significa *.*.*.*&lt;/span&gt;
&lt;span class="n"&gt;PORT&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="c1"&gt;# la porta che preferisco (sopra la 1024)&lt;/span&gt;

&lt;span class="n"&gt;Sock&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AF_INET&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SOCK_STREAM&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39; socket creato &amp;#39;&lt;/span&gt;
&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;Sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;HOST&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;PORT&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;error&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Bind fallito, Errore: &amp;#39;&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;; messaggio: &amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;socket bindato  a ip/porta &amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Come per il client si importano le librerie (rigorosamente standard), e questa volta ne aggiungiamo una che servirà a gestire multiple connessioni in un'ottica di _thread per connection, _cioè un thread (una specie di porcesso [non me ne vogliano i programmatori]) per ogni connessione che un client effettua sul nostro server.&lt;/p&gt;
&lt;p&gt;Viene poi impostato HOST, ovvero l'IP sul quale il server starà in ascolto (nel mi caso tutte le interfaccie possibili) e PORT per la porta di scolto (ricordate di utilizzare una porta oltre 1024 se il server gira senza permessi di root (auspicabile).&lt;/p&gt;
&lt;p&gt;Prima di tutto creiamo il nostro socket con&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Sock&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AF_INET&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SOCK_STREAM&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;che indica una variabile &lt;em&gt;Sock&lt;/em&gt; composta da un socket con protoccolo di rete IP (socket.AF_NET) e di trasporto TCP (socket.SOCK_STREAM).&lt;/p&gt;
&lt;p&gt;Ed in fine, dopo aver stampato a video il nosto successo, facciamo il bind (accoppiamo) il nostro socket a/agli IP selezionati in precedenza:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Sock&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="k"&gt;HOST&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;PORT&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Anche questa volta il _bind _viene fatto bene, utilizzando il metodo standard per la &lt;a href="http://docs.python.org/2/tutorial/errors.html"&gt;gestione degli errori in python&lt;/a&gt;, [try/exept].&lt;/p&gt;
&lt;p&gt;Gratificati del nostro socket appeso ai nostri IP, passiamo alla fase successiva:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/usr/bin/env python2&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;socket&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;thread&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;

&lt;span class="n"&gt;HOST&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt; &lt;span class="c1"&gt;# se non metto nulla, significa *.*.*.*&lt;/span&gt;
&lt;span class="n"&gt;PORT&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="c1"&gt;# la porta che preferisco (sopra la 1024)&lt;/span&gt;

&lt;span class="n"&gt;Sock&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AF_INET&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SOCK_STREAM&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39; socket creato &amp;#39;&lt;/span&gt;
&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="n"&gt;Sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;HOST&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;PORT&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;error&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Bind fallito, Errore: &amp;#39;&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;; messaggio: &amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;socket bindato a ip/porta &amp;#39;&lt;/span&gt;

&lt;span class="n"&gt;Sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;listen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# il socket e in ascolto e gestisce fino a 10 connessioni&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;La cosa si fa interessante, ed ora il socket non è solo &lt;em&gt;bindato&lt;/em&gt;, ma è messo in ascolto, con un parametro "10" che definisce il numero di connessioni da gestire simultaneamente, prima di accodare le richieste.&lt;/p&gt;
&lt;p&gt;Ed ecco che entra in gioco la libreria importata thread importata al principio, con la quale possiamo gestire le dieci connessioni concorrenti senza &lt;em&gt;crushare&lt;/em&gt; il nostro povero server e, quindi, il socket. A differenza di una chiamata client dove all'aumentare delle connessioni aumentano i socket aperti per ogni connessione, il server qui mantiene un solo socket aperto che, grazie al multiplexing, gestisce più connessioni sullo stesso canale (come spiegato in questo illuminante &lt;a href="http://www.python.it/doc/howto/Socket/sockets-it/sockets-it.html"&gt;articolo sui sockets&lt;/a&gt;).&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/usr/bin/env python2&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;socket&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;thread&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;

&lt;span class="n"&gt;HOST&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt; &lt;span class="c1"&gt;# se non metto nulla, significa *.*.*.*&lt;/span&gt;
&lt;span class="n"&gt;PORT&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="c1"&gt;# la porta che preferisco (sopra la 1024)&lt;/span&gt;

&lt;span class="n"&gt;Sock&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AF_INET&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SOCK_STREAM&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39; socket creato &amp;#39;&lt;/span&gt;
&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="n"&gt;Sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;HOST&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;PORT&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;error&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Bind fallito, Errore: &amp;#39;&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;; messaggio: &amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;socket bindato a ip/porta &amp;#39;&lt;/span&gt;

&lt;span class="n"&gt;Sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;listen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# il socket e in ascolto e gestisce fino a 10 connessioni&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;threadconn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;

   &lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;send&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;hey, ecco un server pappagallo&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# solo stringhe&lt;/span&gt;

   &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="c1"&gt;# loop infinito&lt;/span&gt;

    &lt;span class="c1"&gt;# ora rispondiamo ai messaggi&lt;/span&gt;
       &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;recv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

       &lt;span class="n"&gt;reply&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Tnis what u said&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;

       &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
           &lt;span class="k"&gt;break&lt;/span&gt;

       &lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendall&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;reply&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

   &lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="c1"&gt;# usciamo dal loop una volta risposto&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Aggiungiamo un po di carne al fuco, definendo una funzione chiamata threadconn che ci servirà per gestire le nostre multiple connessioni; come input, prenderemo la variabile &lt;em&gt;conn&lt;/em&gt; che più avanti nel codice sarà la nostra connessione singola, e cominciamo inviando  un messaggio a chi si connette.&lt;/p&gt;
&lt;p&gt;Il comando &lt;em&gt;send&lt;/em&gt; invia dati sul socket, ma badate bene, perché è possibile inviare solo stringhe; poco sotto, comincia un loop infinito (while True) nel quale i dati ricevuti vengono salvati in una variabile (in blocchi da 1024 bytes) e rispediti al mittente attraverso il socket. Come protezione (non mi ancora ben chiaro come) viene implementato un meccanismo di uscita nel caso di buffer vuoto. Per terminare ogni "pezzo" di conversazione, la connessione viene chiusa (è importante!).&lt;/p&gt;
&lt;p&gt;Al termine del codice, arriva il cuore del server che, sempre in maniera perpetua (while 1) gestisce le connessioni in entrata.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/usr/bin/env python2&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;socket&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;thread&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;

&lt;span class="n"&gt;HOST&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt; &lt;span class="c1"&gt;# se non metto nulla, significa *.*.*.*&lt;/span&gt;
&lt;span class="n"&gt;PORT&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="c1"&gt;# la porta che preferisco (sopra la 1024)&lt;/span&gt;

&lt;span class="n"&gt;Sock&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AF_INET&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SOCK_STREAM&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39; socket creato &amp;#39;&lt;/span&gt;
&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="n"&gt;Sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;HOST&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;PORT&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;error&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Bind fallito, Errore: &amp;#39;&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;; messaggio: &amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;socket bindato a ip/porta &amp;#39;&lt;/span&gt;

&lt;span class="n"&gt;Sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;listen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# il socket e in ascolto e gestisce fino a 10 connessioni&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;threadconn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;

   &lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;send&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;hey, ecco un server pappagallo&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# solo stringhe&lt;/span&gt;

   &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="c1"&gt;# loop infinito&lt;/span&gt;

    &lt;span class="c1"&gt;# ora rispondiamo ai messaggi&lt;/span&gt;
       &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;recv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

       &lt;span class="n"&gt;reply&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Tnis what u said&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;

       &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
           &lt;span class="k"&gt;break&lt;/span&gt;

       &lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendall&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;reply&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

   &lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="c1"&gt;# usciamo dal loop una volta risposto&lt;/span&gt;

&lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="c1"&gt;# e ora aspettiamo le risposte..&lt;/span&gt;

   &lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;addr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;accept&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

   &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Connessione da&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;addr&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;:&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;addr&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;

   &lt;span class="n"&gt;start_new_thread&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;threadconn&lt;/span&gt; &lt;span class="p"&gt;,(&lt;/span&gt;&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="p"&gt;,))&lt;/span&gt;

&lt;span class="n"&gt;Sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Dopo aver salvato le variabili, inizializziamo il thread col comando &lt;em&gt;start_new_thread&lt;/em&gt; che prende come argomenti la funzione creata sopra:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;start_new_thread&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;threadconn&lt;/span&gt; &lt;span class="p"&gt;,(&lt;/span&gt;&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="p"&gt;,))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Per terminare in bellezza e perché siamo dei bravi &lt;em&gt;scrptatori,&lt;/em&gt; chiudiamo il socket pirma di uscire dal porgramma.&lt;/p&gt;
&lt;p&gt;Ed ecco che abbiamo creato un Client ed un server, che fanno da base per i più sfrenato sogni di gloria con python, i socket e la porgrammazione di rete!&lt;/p&gt;
&lt;p&gt;Alla prossima..&lt;/p&gt;</content><category term="python"></category><category term="socket"></category><category term="tutorial"></category></entry><entry><title>[Python] I Socket: un client TCP-IP</title><link href="https://www.j0llyb0x.org/2013/python-i-socket-un-client-tcp-ip.html" rel="alternate"></link><published>2013-06-18T00:00:00+02:00</published><updated>2013-06-18T00:00:00+02:00</updated><author><name>j0lly</name></author><id>tag:www.j0llyb0x.org,2013-06-18:/2013/python-i-socket-un-client-tcp-ip.html</id><summary type="html">&lt;p&gt;Ho trovato alcune guide molto interessanti per la programmazione dei socket in Python, ed ho deciso di cominciare a studiare un po il linguaggio.&lt;/p&gt;
&lt;p&gt;&lt;img alt="socket" src="https://www.j0llyb0x.org/images/socket-2.jpg"&gt;
Quale situazione migliore se non quella di commentare gli esercizi per fissare il tutto e, per chi fosse interessato, insegnare qualcosa.&lt;/p&gt;
&lt;p&gt;Premetto che il codice e …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Ho trovato alcune guide molto interessanti per la programmazione dei socket in Python, ed ho deciso di cominciare a studiare un po il linguaggio.&lt;/p&gt;
&lt;p&gt;&lt;img alt="socket" src="https://www.j0llyb0x.org/images/socket-2.jpg"&gt;
Quale situazione migliore se non quella di commentare gli esercizi per fissare il tutto e, per chi fosse interessato, insegnare qualcosa.&lt;/p&gt;
&lt;p&gt;Premetto che il codice e la procedure è tutto tranne farina del mio sacco:&lt;/p&gt;
&lt;p&gt;&lt;a href="http://www.binarytides.com/"&gt;Quest blog&lt;/a&gt; ha ottimi articoli sul Networking e, ovviamente, su Python :)&lt;/p&gt;
&lt;p&gt;In particolare ho utilizzato una &lt;a href="http://www.binarytides.com/python-socket-programming-tutorial/"&gt;Guida introduttiva ai Sockets in Python&lt;/a&gt;; fate tesoro del sito, perché è davvero ottimo.&lt;/p&gt;
&lt;p&gt;Per aiutarmi ed aiutarvi, metto anche il link alle pagine di &lt;a href="http://docs.python.org/2/library/socket.html"&gt;manuale sui sockets&lt;/a&gt; (è python 2.7).&lt;/p&gt;
&lt;p&gt;L'articolo sul blog del link è composto di due parti:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;la costruzione di un client python che si connette ad un server, invia dati sul socket e attende la risposta prima di chiudere la comunicazione;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;la creazione di un server, sempre in python, che si mette in ascolto su una porta e fa da "pappagallo" stampando a schermo quello che ricevere dal mittente, anche in multi-threading.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Oggi io descriverò il client, lasciano il server python per la prossima..&lt;/p&gt;
&lt;h3&gt;Il client&lt;/h3&gt;
&lt;p&gt;Ed ecco il mio primo socket:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/usr/bin/env python2&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;socket&lt;/span&gt; &lt;span class="c1"&gt;# :)&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;  &lt;span class="c1"&gt;# per exit code&lt;/span&gt;
&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="c1"&gt;# creo il socket TCP/IP&lt;/span&gt;
    &lt;span class="n"&gt;sockMe&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AF_INET&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SOCK_STREAM&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Failed to create a socket. Error Code: &amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39; , error  message: &amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;il mio primo Socket esiste!&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;La mia intestazione deriva dal fatto che utilizzando Archlinux ho Python3 come interprete di _default _mentre questo codice è stato creato per python 2.x. La maggior parte delle distribuzioni utilizzano python 2.x quindi dovreste poter utilizzare&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Senza stare troppo a divagare, in queste quattro righe di codice si importano le librerie standard pyhton per i &lt;em&gt;sockets&lt;/em&gt; (import socket) e di quelle di sistema (guarda un po) per la gestione dell'I/O, l'imput utente etcetc..&lt;/p&gt;
&lt;p&gt;Visto che, chi ha fatto la guida è una persona colta, lui ha utilizzato un metodo di gestione delle "eccezioni" del tipo: prova a fare &lt;em&gt;questo&lt;/em&gt; e se non riesci, giustificati con &lt;em&gt;questo&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;La forma è try:/except: e come tutte le cose in python gli spazi e l'indentazione contano.&lt;/p&gt;
&lt;p&gt;Quel che si "&lt;em&gt;prova&lt;/em&gt;" (try) a fare è creare un socket, associando la variabile sockMe:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;socket.AF_INET, socket.SOCK_STREAM&lt;/code&gt;
Dove AF_INET sta per protocollo IP e SOCK_STREAM è il portocollo tcp (indovinate cosa è SOCK_DATAGRAM..).&lt;/p&gt;
&lt;p&gt;Andando avanti col codice, aggiungiamo un po di pezzi dato che un socket da solo non fa la felicità..&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/usr/bin/env python2&lt;/span&gt;

&lt;span class="c1"&gt;## My fist approach to sockets&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;socket&lt;/span&gt; &lt;span class="c1"&gt;# :)&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt; &lt;span class="c1"&gt;# for exit code&lt;/span&gt;
&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="c1"&gt;# creo il socket TCP/IP&lt;/span&gt;
    &lt;span class="n"&gt;sockMe&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AF_INET&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SOCK_STREAM&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Failed to create a socket. Error Code: &amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39; , error message: &amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;il mio primo Socket esiste!&amp;#39;&lt;/span&gt;

&lt;span class="n"&gt;host&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;port&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;

&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;remote_ip&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gethostbyname&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;host&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gaierror&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="c1"&gt;# non posso risolvere: non ho internet o il dns non funziona&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Hostname non trovato.&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;L&amp;#39;IP di &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;host&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot; e&amp;#39; &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;remote_ip&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;ed ora connettiamoci...&amp;#39;&lt;/span&gt;

&lt;span class="c1"&gt;# connettiamoci a ip-porta&lt;/span&gt;
&lt;span class="n"&gt;sockMe&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;remote_ip&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Facciamo faville :)&lt;/p&gt;
&lt;p&gt;Ora stiamo usando il socket, connettendoci ad un &lt;em&gt;host&lt;/em&gt; ed una _porta _che definiamo con _argv (_cioè dall'input passando due argomenti allo script tipo "./client.py google.com 80").&lt;/p&gt;
&lt;p&gt;socket.gethostbyname, invece, è il resolver python, che cerca di risolvere l'hostname tramite dns o file /etc/hosts; anche questa volta &lt;em&gt;proviamo&lt;/em&gt; a risolvere e, se tutto fila liscio, eseguiamo un sockMe.connect per aprire la connessione con l'host (risolto come IP) e la porta definiti.&lt;/p&gt;
&lt;p&gt;Ora che abbiamo un bel socket aperto e connesso all'altro capo della linea, perché non inviamo un bel messaggio al nostro interlocutore:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/usr/bin/env python2&lt;/span&gt;

&lt;span class="c1"&gt;## My fist approach to sockets&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;socket&lt;/span&gt; &lt;span class="c1"&gt;# :)&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt; &lt;span class="c1"&gt;# for exit code&lt;/span&gt;
&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="c1"&gt;# creo il socket TCP/IP&lt;/span&gt;
    &lt;span class="n"&gt;sockMe&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AF_INET&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SOCK_STREAM&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Failed to create a socket. Error Code: &amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39; , error message: &amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;il mio primo Socket esiste!&amp;#39;&lt;/span&gt;

&lt;span class="n"&gt;host&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;port&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;

&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
     &lt;span class="n"&gt;remote_ip&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gethostbyname&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;host&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gaierror&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="c1"&gt;# non posso risolvere: non ho internet o il dns non funziona&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Hostname non trovato.&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;L&amp;#39;IP di &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;host&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot; e&amp;#39; &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;remote_ip&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;ed ora connettiamoci...&amp;#39;&lt;/span&gt;

&lt;span class="c1"&gt;# connettiamoci a ip-porta&lt;/span&gt;
&lt;span class="n"&gt;sockMe&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;remote_ip&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="n"&gt;message&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;W000t W000T&amp;quot;&lt;/span&gt;

&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="c1"&gt;#inviamo tutto&lt;/span&gt;
&lt;span class="n"&gt;sockMe&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendall&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Errore! Non ho potuto inviare i pacchetti&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;messaggio consegnato&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Semplicemente, con un altro metodo try/except inviamo il messaggio salvato nel buffer con il comando _sendall. _Questo comando svuota il buffer inviando tutto quello che trova all'altro capo della connessione.&lt;/p&gt;
&lt;p&gt;Ed ora, il tocco finale: riceviamo la risposta, la leggiamo, la stampiamo e in fine chiudiamo la comunicazione da bravi sviluppatori (non vogliamo lasciare appese le sessioni giusto?!).&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/usr/bin/env python2&lt;/span&gt;

&lt;span class="c1"&gt;## My fist approach to sockets&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;socket&lt;/span&gt; &lt;span class="c1"&gt;# :)&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt; &lt;span class="c1"&gt;# for exit code&lt;/span&gt;
&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="c1"&gt;# creo il socket TCP/IP&lt;/span&gt;
&lt;span class="n"&gt;sockMe&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AF_INET&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SOCK_STREAM&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Failed to create a socket. Error Code: &amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39; , error message: &amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;il mio primo Socket esiste!&amp;#39;&lt;/span&gt;

&lt;span class="n"&gt;host&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;port&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;

&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;remote_ip&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gethostbyname&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;host&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gaierror&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="c1"&gt;# non posso risolvere: non ho internet o il dns non funziona&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Hostname non trovato.&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;L&amp;#39;IP di &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;host&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot; e&amp;#39; &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;remote_ip&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;ed ora connettiamoci...&amp;#39;&lt;/span&gt;

&lt;span class="c1"&gt;# connettiamoci a ip-porta&lt;/span&gt;
&lt;span class="n"&gt;sockMe&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;remote_ip&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="n"&gt;message&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;W000t W000T&amp;quot;&lt;/span&gt;

&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="c1"&gt;#inviamo tutto&lt;/span&gt;
&lt;span class="n"&gt;sockMe&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendall&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Errore! Non ho potuto inviare i pacchetti&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;messaggio consegnato&amp;#39;&lt;/span&gt;

&lt;span class="c1"&gt;#e ora ricevo&lt;/span&gt;
&lt;span class="n"&gt;reply&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sockMe&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;recv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;reply&lt;/span&gt;

&lt;span class="n"&gt;sockMe&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;&lt;em&gt;recv&lt;/em&gt; è impostato per ricevere una certa quantità di dati (nel nostro caso 1024 byte). Per concludere in bellezza lo script, la sessione e l'articolo, chiudiamo il nostro socket python invocando la funzione close().&lt;/p&gt;</content><category term="python"></category><category term="socket"></category><category term="tutorial"></category></entry><entry><title>[GUIDA] Bcache, luks e btrfs: Archlinux on steroids [parte II]</title><link href="https://www.j0llyb0x.org/2013/guida-bcache-luks-e-btrfs-archlinux-on-steroids-parte-ii.html" rel="alternate"></link><published>2013-06-15T00:00:00+02:00</published><updated>2013-06-15T00:00:00+02:00</updated><author><name>j0lly</name></author><id>tag:www.j0llyb0x.org,2013-06-15:/2013/guida-bcache-luks-e-btrfs-archlinux-on-steroids-parte-ii.html</id><summary type="html">&lt;p&gt;Ed eccoci per la seconda parte di questa guida, dove tratterò l'installazione Arch con BTRFS, l'aggiunta del caching device ed l'affinamento dell'installazione. La parte su Bcache &amp;amp; crittografia del disco la trovate nella &lt;a href="http://j0llyb0x.org/bcache-luks-e-btrfs-linux-on-steroids-06-2013/"&gt;prima parte della guida&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img alt="bcache" src="https://www.j0llyb0x.org/images/bcache-2.png"&gt;&lt;/p&gt;
&lt;p&gt;I link alle guide:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://wiki.archlinux.org/index.php/Installing_on_Btrfs_root"&gt;https://wiki.archlinux.org/index.php/Installing_on_Btrfs_root&lt;/a&gt; &lt;/li&gt;
&lt;li&gt;&lt;a href="https://wiki.archlinux.org/index.php/Bcache"&gt;https://wiki.archlinux …&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;</summary><content type="html">&lt;p&gt;Ed eccoci per la seconda parte di questa guida, dove tratterò l'installazione Arch con BTRFS, l'aggiunta del caching device ed l'affinamento dell'installazione. La parte su Bcache &amp;amp; crittografia del disco la trovate nella &lt;a href="http://j0llyb0x.org/bcache-luks-e-btrfs-linux-on-steroids-06-2013/"&gt;prima parte della guida&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img alt="bcache" src="https://www.j0llyb0x.org/images/bcache-2.png"&gt;&lt;/p&gt;
&lt;p&gt;I link alle guide:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://wiki.archlinux.org/index.php/Installing_on_Btrfs_root"&gt;https://wiki.archlinux.org/index.php/Installing_on_Btrfs_root&lt;/a&gt; &lt;/li&gt;
&lt;li&gt;&lt;a href="https://wiki.archlinux.org/index.php/Bcache"&gt;https://wiki.archlinux.org/index.php/Bcache&lt;/a&gt; &lt;/li&gt;
&lt;li&gt;&lt;a href="https://wiki.archlinux.org/index.php/Dm-crypt_with_LUKS"&gt;https://wiki.archlinux.org/index.php/Dm-crypt_with_LUKS&lt;/a&gt; &lt;/li&gt;
&lt;li&gt;&lt;a href="http://forums.gentoo.org/viewtopic-t-959542.html"&gt;http://forums.gentoo.org/viewtopic-t-959542.html&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;... E l'indice: &lt;/p&gt;
&lt;p&gt;PARTE I&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;installazione Arch minimale su ssd&lt;ul&gt;
&lt;li&gt;base install con archiso&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;compilazione del kernel e patch per l'inclusione del modulo bcache&lt;ul&gt;
&lt;li&gt;instalazione dei pacchetti "&lt;a href="https://aur.archlinux.org/packages/linux-bcache-git/"&gt;linux-bcache-git&lt;/a&gt;" e "&lt;a href="https://aur.archlinux.org/packages/bcache-tools-git/"&gt;bcache-tools-git&lt;/a&gt;"&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;preparazione dell'hdd&lt;ul&gt;
&lt;li&gt;creazione del volume bcache di backend&lt;/li&gt;
&lt;li&gt;encryption della partizione&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;PARTE II&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;clone dell'installazione Arch da ssd a hdd&lt;ul&gt;
&lt;li&gt;creazione del fs BTRFS&lt;/li&gt;
&lt;li&gt;sync dell'installazione precedente&lt;/li&gt;
&lt;li&gt;modifica dei files fstab ed affini&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;termine installazione&lt;ul&gt;
&lt;li&gt;chroot e modifica del bootloader&lt;/li&gt;
&lt;li&gt;inclusione dell'hook in mkinitcpio.conf&lt;/li&gt;
&lt;li&gt;eliminare Arch sull'ssd&lt;/li&gt;
&lt;li&gt;creare il device di cache&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;PARTE III&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Bonus:&lt;ul&gt;
&lt;li&gt;CryptoSwap + hibernation&lt;/li&gt;
&lt;li&gt;UsbKeyFile per l'autenticazione&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Eravamo rimasti nella Prima parte con un volume crittografato aperto e mappato in /dev/mapper/btrfs&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;┌──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j0lly@TheH0le&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="err"&gt;──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;~&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="err"&gt;└──&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cryptsetup&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;luksOpen&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dev&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bcache0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;btrfs&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="n"&gt;Btrfs_&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;è&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;il&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;_device&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mapper_&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;che&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;daremo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;alla&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;partizione&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;una&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;volta&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;aperta&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Per&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;formattare&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;il&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;device&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;installate&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;btrfs&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;progs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;se&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ancora&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;non&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;lo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;avete&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fatto&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cominciate&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;definendo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;il&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;vostro&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;_layout_&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;per&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;le&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;partizioni&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;che&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;volete&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;gestire&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Per&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;prima&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cosa&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;create&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;il&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;_Root&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;device_&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;con&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;il&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nl"&gt;comando&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="err"&gt;┌──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j0lly@TheH0le&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="err"&gt;──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;~&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="err"&gt;└──&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mkfs&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;btrfs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;L&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;btrfs_container&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dev&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mapper&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;btrfs&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;La procedura seguente intende utilizzare tutte le ultime features che btrfs consente, tra cui:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;la possibilità di creare &lt;em&gt;snapshots&lt;/em&gt; di qualsiasi partizione (anche l'intero filesystem);&lt;/li&gt;
&lt;li&gt;la gestione separata dei &lt;em&gt;subvolumes&lt;/em&gt; in maniera dinamica;&lt;/li&gt;
&lt;li&gt;la compressione trasparente dei dati sul filesystem.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Quest'ultima novità di questo stupendo &lt;em&gt;filesystem&lt;/em&gt; è vale da sola tutta la fatica spesa: la compressione permette di salvare spazio sul disco, velocizzare la lettura dei files e permette il funzionamento impostandolo per singolo &lt;em&gt;subvolume&lt;/em&gt;!  Quindi, montate il filesystem root e create i vostri volumi come fareste in lvm, non dimenticando la compressione ;):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;┌──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j0lly@TheH0le&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="err"&gt;──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;~&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="err"&gt;└──&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mount&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;o&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;defaults&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;noatime&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dev&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mapper&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;btrfs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mnt&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mnt&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Prima di tutto, create la directory di &lt;em&gt;snapshot:&lt;/em&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;┌──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j0lly@TheH0le&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="err"&gt;──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;/mnt&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="err"&gt;└──&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mkdir&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;__snapshot&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Poi create un &lt;em&gt;subvolume&lt;/em&gt; che fungerà da root del sistema:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;┌──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j0lly@TheH0le&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="err"&gt;──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;~&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="err"&gt;└──&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;btrfs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;subvol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;create&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;__active&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Anche in questo caso la nomenclatura è presa dal &lt;a href="https://wiki.archlinux.org/index.php/Installing_on_Btrfs_root"&gt;Wiki Arch&lt;/a&gt;, per mantenere la compatibilità con gli strumenti al momento disponibili su Arch. Ora smontate pure il vostro &lt;em&gt;filesystem&lt;/em&gt;, e preparatevi alla magia:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;┌──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j0lly@TheH0le&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="err"&gt;──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;~&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="err"&gt;└──&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mount&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;o&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;defaults&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;noatime&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nf"&gt;compress&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;lzo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;subvol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;__active&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dev&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mapper&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;btrfs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mnt&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Ora  il &lt;em&gt;subvolume&lt;/em&gt; __active è montato e pronto per gestire l'intera installazione; notate l'opzione compress= che permette di comprimere i dati (il formato lzo sembra essere il miglior compromesso tra compressione e consumo di cpu); tenete presente che la compressione del filesystem funziona in &lt;em&gt;realtime&lt;/em&gt; per la scrittura dei dati, quindi è il caso che la attiviate fin da subito e in maniera persistente (se volete utilizzarla) o avrete parti del &lt;em&gt;filesystem&lt;/em&gt; compresse ed altre no. Ora potete creare tutti i &lt;em&gt;subvolume&lt;/em&gt; che preferite; sono molto flessibili e consiglio di utilizzarli in maniera estensiva; io ho fatto così:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;┌──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j0lly@TheH0le&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="err"&gt;──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;~&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="err"&gt;└──&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;btrfs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;subvol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;list&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="n"&gt;ID&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;256&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;gen&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;8545&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;top&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;level&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;path&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;__active&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="n"&gt;ID&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;259&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;gen&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;8433&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;top&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;level&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;256&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;path&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="n"&gt;ID&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;260&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;gen&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;8567&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;top&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;level&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;256&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;path&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;var&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="n"&gt;ID&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;265&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;gen&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;8567&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;top&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;level&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;256&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;path&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;j0lly&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="n"&gt;ID&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;266&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;gen&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3697&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;top&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;level&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;256&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;path&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;j0lly&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;images&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="n"&gt;ID&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;267&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;gen&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;8449&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;top&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;level&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;256&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;path&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;j0lly&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;music&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Le opzioni di mount sono propagate anche ai figli, se non specificato altrimenti. Sulla mia "nuova" root ho poi &lt;em&gt;restorato&lt;/em&gt; il sistema &lt;em&gt;backuppato&lt;/em&gt; precedentemente, per risparmiare un paio di comandi e non installare da zero. È il momento di affinare le configurazioni.; non dimenticatevi di popolare /etc/fstab. Il mio è così:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;┌──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j0lly@TheH0le&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="err"&gt;──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;~&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="err"&gt;└──&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;fstab&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nl"&gt;fstab&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;static&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;file&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;system&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;information&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="k"&gt;file&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;system&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;dir&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;type&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;options&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="k"&gt;dump&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;pass&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="n"&gt;LABEL&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;btrfs_container&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;btrfs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rw&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;space_cache&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;thread_pool&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;noatime&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;subvol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;__active&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nf"&gt;compress&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;lzo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dev&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sda3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;boot&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ext4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;defaults&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dev&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mapper&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cryptswap&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;none&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;swap&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;defaults&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Tenete presente un paio di accorgimenti:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;non è necessario montare i &lt;em&gt;subvolume&lt;/em&gt; dentro al vostro volume root (nel mio caso __active) perchè verranno montati in automatico;&lt;/li&gt;
&lt;li&gt;non dimenticate di specificare opzioni come subvol e compress (se volete utilizzarli;&lt;/li&gt;
&lt;li&gt;btrfs non necessita assolutamente di fsck all'avvio, quindi mettete 0 nella seconda colonna delle partizioni btrfs;&lt;/li&gt;
&lt;li&gt;vorrete probabilmente montare la partizione di boot (esterna e non crittografata).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Siamo quasi-quasi a buon punto; manca da rigenerare il ramdisk e reinstallare il bootloader, quindi montate la partizione di boot (che io ho riutilizzato dall'installazione ponte sulla ssd) ed entrate in chroot. Reinstallate Grub ed aggiornate le entry ( per non rischiare, potreste aggiungere una stringa di boot per l'ssd. in caso qualcosa andasse storto). Prima di ricreare il grub.cfg, editate /etc/default/grub per aggiungere questi parametri non ancora gestiti da Grub:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;┌──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j0lly@TheH0le&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="err"&gt;──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;~&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="err"&gt;└──&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="k"&gt;default&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;grub&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="n"&gt;GRUB_DEFAULT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GRUB_TIMEOUT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="n"&gt;GRUB_DISTRIBUTOR&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;Arch&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="n"&gt;GRUB_CMDLINE_LINUX_DEFAULT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;quiet&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="n"&gt;GRUB_CMDLINE_LINUX&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;cryptdevice=/dev/bcache0:btrfs1 cryptkey=/dev/disk/by-label/Rec_Me:ext4:/xxxxxxxxxxxxx resume=/dev/mapper/cryptswap&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;...&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;cryptdevice: specificate il device bcache da utilizzare per LUKS: se non usate il label in fstab, ricordate di allineare il nome che date al container.&lt;/li&gt;
&lt;li&gt;cryptkey: questo è il &lt;em&gt;path&lt;/em&gt; per la chiave automatica (parleremo dopo di questo) per non immettere la password all'avvio.&lt;/li&gt;
&lt;li&gt;resume: anche questo sarà utilizzato succcessivamente; è il path del device di resume dall'ibernazione.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Per l'hook in mkinitcpio, modificate la configurazione aggiungendo le righe seguenti in /etc/mkinitcpio.conf:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;┌──&lt;span class="o"&gt;[&lt;/span&gt;j0lly@TheH0le&lt;span class="o"&gt;]&lt;/span&gt;──&lt;span class="o"&gt;[&lt;/span&gt;~&lt;span class="o"&gt;]&lt;/span&gt; 
└── cat /etc/mkinitcpio.conf 
&lt;span class="c1"&gt;# vim:set ft=sh &lt;/span&gt;
&lt;span class="c1"&gt;# MODULES &lt;/span&gt;
&lt;span class="c1"&gt;# The following modules are loaded before any boot hooks are &lt;/span&gt;
&lt;span class="c1"&gt;# run. Advanced users may wish to specify all system modules &lt;/span&gt;
&lt;span class="c1"&gt;# in this array. For instance: &lt;/span&gt;
&lt;span class="c1"&gt;# MODULES=&amp;quot;piix ide_disk reiserfs&amp;quot; &lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="nv"&gt;MODULES&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class="nv"&gt;MODULES&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;crc32c dm_mod&amp;quot;&lt;/span&gt; 
&lt;span class="o"&gt;[&lt;/span&gt;...&lt;span class="o"&gt;]&lt;/span&gt;   
&lt;span class="nv"&gt;HOOKS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;base udev modconf block bcache encrypt openswap resume btrfs filesystems keyboard keymap&amp;quot;&lt;/span&gt; 
&lt;span class="o"&gt;[&lt;/span&gt;...&lt;span class="o"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Non ricordo assolutamente dove ho letto dei moduli crc32 e dm_mod, ma quando avrò tempo di testare un ramdisk senza di essi farò un aggiornamento. Riguardo gli &lt;em&gt;HOOK&lt;/em&gt;, cercate di pensare alla vostra configurazione; nel mio caso l'ordine cronologico è: bcache encrypt btrfs. importanete: Openswap e resume sono hook che ho aggiunto successivamente e che verranno documentati nella terza parte della guida e non dovreste utilizzarli adesso (anche perchè openswap è uno script creato appositamente per l'apertura del volume swap criptato e potrebbe darvi noie al boot). Ora ricreate &lt;em&gt;l'initrfs&lt;/em&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;┌──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j0lly@TheH0le&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="err"&gt;──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;~&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="err"&gt;└──&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mkinitcpio&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;L&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;bcache&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;git&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;boot&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;initramfs&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;bcache&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Uscite dal chroot, incrociate le dita e.... rebootate. Se tutto è andato bene avrete avviato il vostro nuovo sistema! Dovreste essere sulla vostra partizione bcache, aperta con luks e montata in / con btrfs! Il peggio è fatto e potete bervi una birra ;).
Se il vostro sistema è stabile, potete eliminare la vecchia installazione sull'ssd o, meglio ancora, potete creare la partizione/iso di &lt;em&gt;recovery (_non mi stanco di ripeterlo: È IMPORTANTE!) facendo un altro _sync&lt;/em&gt; dall'installazione ancora presente.
Quando sarete pronti formattate il disco e create una partizione; in base alla disponibilità di spazio che avete sull'SSD e se segliete di avere lo &lt;em&gt;swap&lt;/em&gt;, potete decidere di utilizzare tutto il disco SSD come raw device (io ho tenuto 8Gb di spazio per lo swap).
Ora potete creare e registrate il &lt;em&gt;caching&lt;/em&gt; device, registrandolo al &lt;em&gt;backing&lt;/em&gt; device già esistente e funzionante; i devices di &lt;em&gt;cache&lt;/em&gt; possono essere collegati, registrati e scollegati a caldo, anche se bcache0 esiste già.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;┌──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j0lly@TheH0le&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="err"&gt;──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;~&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="err"&gt;└──&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;make&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;bcache&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;--cache --block 512 /dev/sdb1&lt;/span&gt;

&lt;span class="err"&gt;┌──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j0lly@TheH0le&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="err"&gt;──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;~&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="err"&gt;└──&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;d893f034&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1440&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="n"&gt;a8c&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;bb40&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;ae82e01bc7d6&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;block&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bcache0&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bcache&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;attach&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;l'UUID lo trovate sotto /sys/fs/bcacahe/&lt;UUID&gt;. Ora che tutto è al suo posto, un reboot finale non guasta, per verificare che funzioni correttamente. Se siete abbastanza temerari, potete abilitare il writeback nel device: l'SSD fa da &lt;em&gt;cache&lt;/em&gt; anche in scrittura, aumentando prestazioni ma, indubbiamente, aggiungendo ulteriori rischi di perdita di dati ( per attivate, &lt;em&gt;echo writeback &amp;gt; /sys/block/sda/sda*/bcache/cache_mode&lt;/em&gt; ).&lt;/p&gt;
&lt;p&gt;Suggerimento:
Mi capitato alcune volte durante alcune modifiche che il device bcache non partisse all'avvio (non è sicuramente una tecnologia "matura" ;)) e quindi riporto la soluzione trovata direttamente sulla wiki Arch e Gentoo per fare un recovery della partizione e fixare il porbema da dentro (spesso basta ri-registrare il cahing device:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;cat&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;block&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sda&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sda3&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bcache&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;running&lt;/span&gt;
&lt;span class="mi"&gt;0&lt;/span&gt;
&lt;span class="n"&gt;echo&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;block&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sda&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sda3&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bcache&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;running&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Tenete presente che se avete abilitato il &lt;em&gt;writeback&lt;/em&gt; e c'erano dati non salvati, quei dati verranno persi :(.
Con questo ho terminato anche la seconda parte della guida.
Nella terza ed ultima parte scriverò come creare un device di swap da utilizzare per l'ibernazione in maniera sicura crittografando il partizione, e il metodo utilizzato da me per ovviare alle continue richieste di password all'avvio tramite una chiave salvata su un dispositivo esterno (chiavetta usb).&lt;/p&gt;
&lt;p&gt;That's all, alla porssima!&lt;/p&gt;</content><category term="archlinux"></category><category term="bcache"></category><category term="kernel"></category><category term="internals"></category></entry><entry><title>[GUIDA] Bcache, luks e btrfs: Archlinux on steroids [parte I]</title><link href="https://www.j0llyb0x.org/2013/guida-bcache-luks-e-btrfs-archlinux-on-steroids-parte-i.html" rel="alternate"></link><published>2013-06-14T00:00:00+02:00</published><updated>2013-06-14T00:00:00+02:00</updated><author><name>j0lly</name></author><id>tag:www.j0llyb0x.org,2013-06-14:/2013/guida-bcache-luks-e-btrfs-archlinux-on-steroids-parte-i.html</id><summary type="html">&lt;p&gt;Per inaugurare il ritorno ad Archlinux, ho deciso di scrivere un articolo sulla mia attuale installazione! Ho deciso di scrivere questa guida per chiunque voglia cimentarsi con il nuovissimo modulo Kernel (che sarà ufficialmente supportato solo dalla versione 3.10) bcache, che introduce il caching dinamico di un hard disk …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Per inaugurare il ritorno ad Archlinux, ho deciso di scrivere un articolo sulla mia attuale installazione! Ho deciso di scrivere questa guida per chiunque voglia cimentarsi con il nuovissimo modulo Kernel (che sarà ufficialmente supportato solo dalla versione 3.10) bcache, che introduce il caching dinamico di un hard disk col supporto di una SSD.&lt;/p&gt;
&lt;p&gt;&lt;img alt="bcache" src="https://www.j0llyb0x.org/images/bcache-1.jpg"&gt;&lt;/p&gt;
&lt;p&gt;Il modulo in questione è pensato per chi ha una piccola SSD (magari saldata sulla motherboard come me) da sfruttare al meglio. Fino a poco tempo fa installavo la &lt;em&gt;Root&lt;/em&gt; direttamente su SSD, per lasciare la &lt;em&gt;Home&lt;/em&gt; sull'HDD. È vero che spesso nella &lt;em&gt;Home&lt;/em&gt; esistono files come iso, musica, video, immagini e vari file binari che non giovano delle scritture random delle SSD, ma il caching può comunque servire a velocizzare tutti i files di configurazione all'interno della &lt;em&gt;Home&lt;/em&gt; del nostro utente. Visto che ero in ballo con una bella installazione complessa, ho deciso di fare le cose per bene, aggiungendo una &lt;em&gt;full encryption&lt;/em&gt; del disco e un &lt;em&gt;filesystem&lt;/em&gt; che, posso dirlo, sembra davvero una scelta azzeccatissima: btrfs! Ho utilizzato un paio di guide poco complesse da seguire, ma non credo esista qualcosa in italiano per cui ho deciso di raccogliere tutto in una guida.&lt;/p&gt;
&lt;p&gt;PARTE I&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;installazione Arch minimale su ssd&lt;/li&gt;
&lt;li&gt;base install con archiso&lt;/li&gt;
&lt;li&gt;compilazione del kernel e patch per l'inclusione del modulo bcache&lt;/li&gt;
&lt;li&gt;instalazione dei pacchetti "&lt;a href="https://aur.archlinux.org/packages/linux-bcache-git/"&gt;linux-bcache-git&lt;/a&gt;" e "&lt;a href="https://aur.archlinux.org/packages/bcache-tools-git/"&gt;bcache-tools-git&lt;/a&gt;"&lt;/li&gt;
&lt;li&gt;preparazione dell'hdd&lt;/li&gt;
&lt;li&gt;creazione del volume bcache di backend&lt;/li&gt;
&lt;li&gt;encryption della partizione&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;PARTE II&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;clone dell'installazione Arch da ssd a hdd&lt;/li&gt;
&lt;li&gt;creazione del fs BTRFS&lt;/li&gt;
&lt;li&gt;sync dell'installazione precedente&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;modifica dei files fstab ed affini&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Termine installazione&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;chroot e modifica del bootloader&lt;/li&gt;
&lt;li&gt;inclusione dell'hook in mkinitcpio.conf&lt;/li&gt;
&lt;li&gt;eliminare Arch sull'ssd&lt;/li&gt;
&lt;li&gt;creare il device di cache&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;PARTE III&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Bonus:&lt;/li&gt;
&lt;li&gt;CryptoSwap + hibernation&lt;/li&gt;
&lt;li&gt;UsbKeyFile per l'autenticazione&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;E qui le guide:&lt;/p&gt;
&lt;p&gt;&lt;a href="https://wiki.archlinux.org/index.php/Installing_on_Btrfs_root"&gt;https://wiki.archlinux.org/index.php/Installing_on_Btrfs_root&lt;/a&gt; 
&lt;a href="https://wiki.archlinux.org/index.php/Bcache"&gt;https://wiki.archlinux.org/index.php/Bcache&lt;/a&gt; 
&lt;a href="https://wiki.archlinux.org/index.php/Dm-crypt_with_LUKS"&gt;https://wiki.archlinux.org/index.php/Dm-crypt_with_LUKS&lt;/a&gt; 
&lt;a href="http://forums.gentoo.org/viewtopic-t-959542.html"&gt;http://forums.gentoo.org/viewtopic-t-959542.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Prima di tutto.. la mia attuale configurazione:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;┌──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j0lly@TheH0le&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="err"&gt;──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;~&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="err"&gt;└──&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;uname&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;mnr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="n"&gt;TheH0le&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;3.9.0&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;ARCH&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;01423&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;gbfd2858&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;dirty&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x86_64&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;HDD 500Gb + SSD 24Gb&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;┌──&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j0lly&lt;/span&gt;&lt;span class="p"&gt;@&lt;/span&gt;&lt;span class="n"&gt;TheH0le&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="err"&gt;──&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="err"&gt;└──&lt;/span&gt; &lt;span class="n"&gt;lsblk&lt;/span&gt;

&lt;span class="n"&gt;NAME&lt;/span&gt; &lt;span class="nl"&gt;MAJ&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;MIN&lt;/span&gt; &lt;span class="n"&gt;RM&lt;/span&gt; &lt;span class="n"&gt;SIZE&lt;/span&gt; &lt;span class="n"&gt;RO&lt;/span&gt; &lt;span class="n"&gt;TYPE&lt;/span&gt; &lt;span class="n"&gt;MOUNTPOINT&lt;/span&gt;

&lt;span class="n"&gt;sda&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="mi"&gt;465&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="n"&gt;G&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;disk&lt;/span&gt;
&lt;span class="err"&gt;├─&lt;/span&gt;&lt;span class="n"&gt;sda1&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;part&lt;/span&gt;                            &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;GRUB&lt;/span&gt; &lt;span class="n"&gt;RESERVED&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="err"&gt;├─&lt;/span&gt;&lt;span class="n"&gt;sda2&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="mi"&gt;509&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;part&lt;/span&gt;                          &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;UEFI&lt;/span&gt; &lt;span class="n"&gt;RESERVED&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="err"&gt;├─&lt;/span&gt;&lt;span class="n"&gt;sda3&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="mi"&gt;500&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;part&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;boot&lt;/span&gt;
&lt;span class="err"&gt;├─&lt;/span&gt;&lt;span class="n"&gt;sda4&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="n"&gt;G&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;part&lt;/span&gt;                            &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;RECOVER&lt;/span&gt; &lt;span class="n"&gt;PARTITION&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="err"&gt;├─&lt;/span&gt;&lt;span class="n"&gt;sda5&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="mi"&gt;455&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="n"&gt;G&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;part&lt;/span&gt;
&lt;span class="err"&gt;└─&lt;/span&gt;&lt;span class="n"&gt;bcache0&lt;/span&gt; &lt;span class="mi"&gt;254&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="mi"&gt;455&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="n"&gt;G&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;disk&lt;/span&gt;
    &lt;span class="err"&gt;└─&lt;/span&gt;&lt;span class="n"&gt;btrfs1&lt;/span&gt; &lt;span class="mi"&gt;253&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="mi"&gt;455&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="n"&gt;G&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;crypt&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;
&lt;span class="n"&gt;sdb&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="n"&gt;G&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;disk&lt;/span&gt;
&lt;span class="err"&gt;├─&lt;/span&gt;&lt;span class="n"&gt;sdb1&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;17&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="n"&gt;G&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;part&lt;/span&gt;
    &lt;span class="err"&gt;└─&lt;/span&gt;&lt;span class="n"&gt;cryptswap&lt;/span&gt; &lt;span class="mi"&gt;253&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="n"&gt;G&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;crypt&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;SWAP&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="err"&gt;└─&lt;/span&gt;&lt;span class="n"&gt;sdb2&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="mi"&gt;14&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="n"&gt;G&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;part&lt;/span&gt;
    &lt;span class="err"&gt;└─&lt;/span&gt;&lt;span class="n"&gt;bcache0&lt;/span&gt; &lt;span class="mi"&gt;254&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="mi"&gt;455&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="n"&gt;G&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;disk&lt;/span&gt;
        &lt;span class="err"&gt;└─&lt;/span&gt;&lt;span class="n"&gt;btrfs1&lt;/span&gt; &lt;span class="mi"&gt;253&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="mi"&gt;455&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="n"&gt;G&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;crypt&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Per cominciare ho preparato il disco seguendo i consigli della guida Arch su &lt;a href="http://evilpiepirate.org/git/linux-bcache.git/tree/Documentation/bcache.txt?h=bcache-dev"&gt;bcache&lt;/a&gt;: fare un'installazione base sull'SSD, per poi allineare il tutto sull'HDD; la procedura sembrerebbe macchinosa ma, dato che per &lt;em&gt;bootare&lt;/em&gt; un disco preparato per il &lt;em&gt;caching&lt;/em&gt; con bcache è necessario un modulo kernel che non è attualmente supportato nella versione mainstream del kernel, è necessario compilarlo da un ambiente Linux preesistente e, dato che per Arch abbiamo un comodo pacchetto su AUR che applica le patch desiderate, la scelta si può fare ad occhi chiusi ;).&lt;/p&gt;
&lt;p&gt;Se siete in grado di produrre una iso con un kernel patchato (che velocizzerebbe l'installazione e manterrebbe un sistema "recovery" su chiavetta) siete sicuramente avvantaggiati e, dato che ho smadonnato per due giorni cercando di mettere il kernel nella maledetta iso arch, non sarò io a spiegarvi come (dato che ho fallito miseramente). Prima di tutto installiamo Arch dalla Iso (procedure ben documentata nel &lt;a href="https://wiki.archlinux.org/index.php/Beginners'_Guide_(Italiano)"&gt;wiki&lt;/a&gt;). Non perdete tempo in fronzoli per l'installazione su SSD dato che servirà da ponte per la vera installazione; l'unico accorgimento che posso dare è quello di creare una partizione di boot da riciclare per l'altra installazione (io l'ho messa su HDD). Dopo aver terminato e restartato il nuovo sistema da SSD, potete procedere scaricando i pacchetti AUR per compilarli:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;┌──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j0lly@TheH0le&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="err"&gt;──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;~&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="err"&gt;└──&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mkdir&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sources&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sources&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="err"&gt;┌──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j0lly@TheH0le&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="err"&gt;──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;~/sources&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="err"&gt;└──&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;wget&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nl"&gt;https&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="n"&gt;aur&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;archlinux&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;org&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;packages&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;li&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;bcache&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;git&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;bcache&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;git&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tar&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gz&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;O&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tar&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;xzvf&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="err"&gt;┌──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j0lly@TheH0le&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="err"&gt;──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;~/sources&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="err"&gt;└──&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;wget&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nl"&gt;https&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="n"&gt;aur&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;archlinux&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;org&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;packages&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bcache&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;tools&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;git&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bcache&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;tools&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;git&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tar&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gz&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;O&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tar&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;xzvf&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Controllate le dipendenze dei pacchetti (ce n'è qualcuna), e quando siete pronti lanciate makepkg -s. dopo un'estenuante attesa avrete il vostro bel kernel _patchato; _installatelo, aggiornate il conf di grub (grub-mkconfig) e fate un reboot con il kernel nuovo di zecca...&lt;/p&gt;
&lt;p&gt;Il mio schema di partizionamento è stato dettato da alcuni importanti fattori, con accorgimenti da tenere in considerazione:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;MBR è anni luce indietro rispetto a GPT e non vedo ragione di usare una tecnologia obsoleta.&lt;/li&gt;
&lt;li&gt;Dato che il mio Bios è buggato, non posso utilizzare UEFI, ripiegando sul booting old style installando il bootloader nell'MBR: se utilizzate come me l'accoppiata GPT-BIOS, ricordatevi di creare una piccola partizione all'inizio del disco da lasciare a Grub, con gdisk (gptdisk) di almeno un paio di Mb. &lt;/li&gt;
&lt;li&gt;Altra importantissima considerazione è che Grub (e nessun bootloader che io conosca) non è in grado di leggere direttamente da dischi criptati col modulo dm-crypt ne tanto meno attraverso bcache. Quindi, preparatevi una partizione di boot per contenere il vostro kernel e ramdisk che verranno letti da Grub all'avvio.&lt;/li&gt;
&lt;li&gt;Quarto accorgimento e potenzialmente più importante di tutti: fatevi una partizione di  1Gb o due per un sistema di &lt;em&gt;recovery!&lt;/em&gt; (se siete in grado e preferite, usate una iso patchata); fidatevi, parlo per esperienza personale: se utilizzate tre &lt;em&gt;layer&lt;/em&gt; di astrazione di cui due a livello sperimentale, è il caso che abbiate un sistema di &lt;em&gt;recovery&lt;/em&gt; a portata di mano, se no col cavolo che accedete ai vostri dati.&lt;/li&gt;
&lt;li&gt;Quinto ed ultimo accorgimento: se state pensando all'ibernazione, tenete a mente che btrfs non se la fila bene con partizioni e file di &lt;em&gt;swap&lt;/em&gt;; gioco forza, dovrete creare un'altra partizione fuori dal volume btrfs; potete mantenere una partizione separata sul disco oppure, come ho fatto io, prendendo dello spazio dall'ssd.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Dopo aver deciso il layout_ create le partizioni sull'HDD con gdisk. Per generare il &lt;em&gt;container&lt;/em&gt; (la partizione che tiene i dati, in contrapposizione con quella che fa da cache) detto _backing device, _utilizzate il tool make-bcache:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;┌──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j0lly@TheH0le&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="err"&gt;──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;~&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="err"&gt;└──&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;make&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;bcache&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;--bdev --block 512 /dev/sd*&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Con questa sintassi bcache-tool formatta una partizione (o un disk raw) per il formato bcache, aggiungendo i suo metadata ed headers. Ho specificato 512 come block size perché la mia ssd dava problemi con il default block size, ma è il caso che leggiate la &lt;a href="http://bcache.evilpiepirate.org/Design/"&gt;documentazione&lt;/a&gt; e le possibili implicazioni. Alla creazione, il device viene automaticamente registrato e nella directory &lt;em&gt;/dev&lt;/em&gt; avrete un nuovo &lt;em&gt;Block Device&lt;/em&gt; chiamato /dev/bcache*. La registrazione dei &lt;em&gt;devices&lt;/em&gt; bcache va fatta ad ogni boot, questo anche per facilitare l'aggiunta o la cancellazione di &lt;em&gt;caching devices&lt;/em&gt; (ssd); non preoccupatevi però, perché nel pacchetto bcache-tools è compreso un &lt;em&gt;hook&lt;/em&gt; per il kernel da dare in pasto a mkinitcpio che registrerà automaticamente tutti i vostri device bcache al boot. Il parametro da appendere in /etc/mkinitcpio.conf è, manco a dirlo, bcache:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;[...]&lt;/span&gt; &lt;span class="n"&gt;block&lt;/span&gt; &lt;span class="n"&gt;bcache&lt;/span&gt; 
&lt;span class="p"&gt;[...]&lt;/span&gt; &lt;span class="n"&gt;filesystems&lt;/span&gt; 
&lt;span class="p"&gt;[...]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Bcache va posizionato dopo l'&lt;em&gt;Hook&lt;/em&gt; dei &lt;em&gt;block devices&lt;/em&gt;, ma prima dei &lt;em&gt;filesystems&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Il dispositivo bcache è pronto ed è giunto il momento di utilizzare cryptsetup per cifrare la partizione, dove creerete più avanti il filesystem con btrfs. Per creare un volume crittografato, dovete utilizzare la &lt;em&gt;suite&lt;/em&gt; cryptsetup. Le ozioni sono molte e dell'alto della mia ignoranza ho preferito mantenere lo standard della guida Arch su Luks (nei riferimenti):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;┌──[&lt;span class="nv"&gt;j0lly&lt;/span&gt;@&lt;span class="nv"&gt;TheH0le&lt;/span&gt;]──[&lt;span class="o"&gt;~&lt;/span&gt;]
└── &lt;span class="nv"&gt;cryptsetup&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="nv"&gt;cipher&lt;/span&gt; &lt;span class="nv"&gt;aes&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;xts&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;plain64&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="nv"&gt;key&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;size&lt;/span&gt; &lt;span class="mi"&gt;512&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="nv"&gt;hash&lt;/span&gt; &lt;span class="nv"&gt;sha512&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="nv"&gt;iter&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;time&lt;/span&gt; &lt;span class="mi"&gt;5000&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="nv"&gt;use&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="k"&gt;random&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="nv"&gt;verify&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;passphrase&lt;/span&gt; &lt;span class="nv"&gt;luksFormat&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nv"&gt;dev&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nv"&gt;bacache0&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Salvatevi la password in un antro oscuro e non disperate: è sempre bene avere una &lt;em&gt;password "incazzata"&lt;/em&gt; per il &lt;em&gt;recovery;&lt;/em&gt; tanto meglio anzi, dato che Luks permette di avere fino ad 8 "chiavi" per apre i contenitori cifrati; è perfino possibile utilizzare immagini e binari e, mettendoli su una chiavetta per essere letti in automatico all'avvio, potrete scordarvi della password in tranquillità (sempre che le abbiate salvate in un luogo sicuro ;)).&lt;/p&gt;
&lt;p&gt;Ok, ora che abbiamo il nostro container cifrato, lo possiamo aprire:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;┌──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j0lly@TheH0le&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="err"&gt;──&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;~&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="err"&gt;└──&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cryptsetup&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;luksOpen&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dev&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bcache0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;btrfs&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Dove _btrfs _sta significare il nome del device mapper che verrà creato all'apertura del volume (/dev/mapper/btrfs).
La prima parte della guida termina qui, ma la seconda è già quasi pronta ;)
Per chi volesse cominciare subito, ricordatevi di segnare la password per il volume crittografato, oltre a tutti i nomi simbolici che avete dato nella vostra configurazione.&lt;/p&gt;
&lt;p&gt;A presto!&lt;/p&gt;</content><category term="archlinux"></category><category term="bcache"></category><category term="kernel"></category><category term="internals"></category></entry><entry><title>Export Mysql Database Structure Without Data</title><link href="https://www.j0llyb0x.org/2013/export-mysql-database-structure-without-data.html" rel="alternate"></link><published>2013-01-19T00:00:00+01:00</published><updated>2013-01-19T00:00:00+01:00</updated><author><name>j0lly</name></author><id>tag:www.j0llyb0x.org,2013-01-19:/2013/export-mysql-database-structure-without-data.html</id><summary type="html">&lt;p&gt;Sometimes you can get in need of your favourite Database clone, but you do not need all the garbage of your 3 years old data.&lt;/p&gt;
&lt;p&gt;&lt;img alt="mysql" src="https://www.j0llyb0x.org/images/mysql-1.gif"&gt;&lt;/p&gt;
&lt;p&gt;Well, a part for a Looong DBMS constructs to cancel every peace of data from your tables, you can simply dump your DB with the …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Sometimes you can get in need of your favourite Database clone, but you do not need all the garbage of your 3 years old data.&lt;/p&gt;
&lt;p&gt;&lt;img alt="mysql" src="https://www.j0llyb0x.org/images/mysql-1.gif"&gt;&lt;/p&gt;
&lt;p&gt;Well, a part for a Looong DBMS constructs to cancel every peace of data from your tables, you can simply dump your DB with the _--no-data _switch. This option is there right to dump a Mysql DB structure without the data!&lt;/p&gt;
&lt;p&gt;Simply as:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;mysqldump&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;User&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;DBname&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;--no-data | gzip &amp;gt;  MyDBBackup.gz&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;And here we go, we have a new and shiny compressed DB Structure without data.
Just to conclude, we can now create the new DB perhaps we can &lt;em&gt;DROP&lt;/em&gt; the old one and restore it (remember to take a full backup before this) with&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;gzip&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;MyDBBackup&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gz&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mysql&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;DBname&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</content><category term="mysql"></category></entry><entry><title>MediaWiki &amp; MySql installation: Pwned by Charset</title><link href="https://www.j0llyb0x.org/2013/mediawiki-mysql-installation-pwned-by-charset.html" rel="alternate"></link><published>2013-01-08T00:00:00+01:00</published><updated>2013-01-08T00:00:00+01:00</updated><author><name>j0lly</name></author><id>tag:www.j0llyb0x.org,2013-01-08:/2013/mediawiki-mysql-installation-pwned-by-charset.html</id><summary type="html">&lt;p&gt;It's some days i'm dealing with a beast: Upgrading some MediaWiki sites inexplicably hosted on a Winzoz platform.&lt;/p&gt;
&lt;p&gt;&lt;img alt="mediawiki" src="https://www.j0llyb0x.org/images/mediawiki-1.png"&gt;&lt;/p&gt;
&lt;p&gt;The process is a pain and i'm spending hours to understand why, for example my Localsettings.php was not read from the stupid IIS server giving me odds messages in the PHP …&lt;/p&gt;</summary><content type="html">&lt;p&gt;It's some days i'm dealing with a beast: Upgrading some MediaWiki sites inexplicably hosted on a Winzoz platform.&lt;/p&gt;
&lt;p&gt;&lt;img alt="mediawiki" src="https://www.j0llyb0x.org/images/mediawiki-1.png"&gt;&lt;/p&gt;
&lt;p&gt;The process is a pain and i'm spending hours to understand why, for example my Localsettings.php was not read from the stupid IIS server giving me odds messages in the PHP logs:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Fatal&lt;/span&gt; &lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;impossibile&lt;/span&gt; &lt;span class="n"&gt;aprire&lt;/span&gt; &lt;span class="n"&gt;file&lt;/span&gt; &lt;span class="n"&gt;blabla&lt;/span&gt; &lt;span class="n"&gt;blabla&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;I'm very noob at Windows and i'm unconfortable on checking privilages in graphical windows; turned out that copying the config files previously backupped, from a storage server, erased all the IIS user permissions from my MediaWiki folder...&lt;/p&gt;
&lt;p&gt;This is not the funny part of the story while the fight on a Mysql database became a real nightmare!&lt;/p&gt;
&lt;p&gt;I spent almost 4 hours in madness looking at the problem which was preventing me to make a fresh install of a new MediaWiki release.&lt;/p&gt;
&lt;p&gt;The web installer was getting n error message during the db setup.&lt;/p&gt;
&lt;p&gt;The Mysql server is running on a Linux machine and my user got a strong yet human randomized password (by me) full of beautiful leters, numbers and symbols; while others MediaWiki were using the same mechanisms, my newly created user was dull to any call of the web installation script. I tried everything:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Setting the right privileges to the user @ the right host: fail&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Use the root user to perform the opeartion: it actually creates the DB but fail on the user creation (probably because the user root was already created)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;i tried to dump a DB from another Wiki site and populating the new one with the already dumped data; i gave permission to the user i created and... you know waht: fail!!&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I was very frustrated because everything seems good: good permissions on Mysql server, good permission on Wiki files and folders...&lt;/p&gt;
&lt;p&gt;After some other tries I figured out was my stupid random password!&lt;/p&gt;
&lt;p&gt;I wrote it with a shiny, undetectable £ symbols, that wasn't properly saved or parsed in the Mysql schema due to the Charset of the MySql.&lt;/p&gt;
&lt;p&gt;I've lost a bunch of hours for a stupid symbol; remember: check the charset in use when you set a strong password; this time i had the root access and no problems, but guess what if I had set that password for the Root instead?&lt;/p&gt;
&lt;p&gt;So, double check the charset and, to do so in the Mysql simply type status from mysql terminal should look like this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Connection&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Localhost&lt;/span&gt; &lt;span class="n"&gt;via&lt;/span&gt; &lt;span class="n"&gt;UNIX&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;
&lt;span class="n"&gt;Server&lt;/span&gt; &lt;span class="n"&gt;characterset&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;latin1&lt;/span&gt;
&lt;span class="n"&gt;Db&lt;/span&gt; &lt;span class="n"&gt;characterset&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;latin1&lt;/span&gt;
&lt;span class="n"&gt;Client&lt;/span&gt; &lt;span class="n"&gt;characterset&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;utf8&lt;/span&gt;
&lt;span class="n"&gt;Conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;characterset&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;utf8&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;I hope somebody fallen in my situation could find this infos useful, at least to avoid loosing 4 hours to install a MediaWiki site!&lt;/p&gt;</content><category term="mediawiki"></category><category term="mysql"></category></entry><entry><title>WR703N costruire porta seriale e installare openwrt</title><link href="https://www.j0llyb0x.org/2012/wr703n-costruire-porta-seriale-e-installare-openwrt.html" rel="alternate"></link><published>2012-10-17T00:00:00+02:00</published><updated>2012-10-17T00:00:00+02:00</updated><author><name>j0lly</name></author><id>tag:www.j0llyb0x.org,2012-10-17:/2012/wr703n-costruire-porta-seriale-e-installare-openwrt.html</id><summary type="html">&lt;p&gt;Dopo mesi d'assenza ho trovato la forza per ricominciare a scrivere, e questa volta parlerò di come installare openwrt su un WR703N, grazie anche ad una porta seriale.&lt;/p&gt;
&lt;p&gt;Da qualche giorno mi è arrivato un simpatico router microscopico della TP-Link: il &lt;a href="http://www.tp-link.com.cn/pages/product-detail.asp?d=225"&gt;WR703N&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img alt="WR703N" src="https://www.j0llyb0x.org/images/openwrt-1.jpg"&gt;&lt;/p&gt;
&lt;p&gt;Questo aggeggio miniaturizzato è più piccolo di una …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Dopo mesi d'assenza ho trovato la forza per ricominciare a scrivere, e questa volta parlerò di come installare openwrt su un WR703N, grazie anche ad una porta seriale.&lt;/p&gt;
&lt;p&gt;Da qualche giorno mi è arrivato un simpatico router microscopico della TP-Link: il &lt;a href="http://www.tp-link.com.cn/pages/product-detail.asp?d=225"&gt;WR703N&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img alt="WR703N" src="https://www.j0llyb0x.org/images/openwrt-1.jpg"&gt;&lt;/p&gt;
&lt;p&gt;Questo aggeggio miniaturizzato è più piccolo di una scatola di caramelle, ma possiede tante qualità tra cui, che ci si può installare Linux e divertirsi un casino!&lt;/p&gt;
&lt;p&gt;La prima cosa che ho fatto infatti è stato installare l'ultima release di Openwrt: &lt;a href="http://downloads.openwrt.org/attitude_adjustment/"&gt;attitude_adjustment&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Come dal &lt;a href="http://wiki.openwrt.org/toh/tp-link/tl-wr703n"&gt;wiki&lt;/a&gt;, questo piccolo portento monta 32MB di ram, 4MB nand e un processore atheros da 400Mhz!&lt;/p&gt;
&lt;p&gt;Sempre dal wiki, si può vedere che esistono una valanga di progetti correlati:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Dalla semplice aggiunta di una &lt;a href="http://wiki.villagetelco.org/index.php?title=Building_a_Serial_Port_for_TL-WR703N"&gt;porta seriale;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Alla creazione di un &lt;a href="https://forum.openwrt.org/viewtopic.php?id=34188"&gt;hub usb&lt;/a&gt;;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;L'utilizzo della porta &lt;a href="https://forum.openwrt.org/viewtopic.php?id=35682"&gt;micro-usb anche come seriale&lt;/a&gt; O.o (complicato);&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;E il mio referito: il &lt;a href="http://www.minipwner.com/"&gt;minipwner&lt;/a&gt;!&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Insomma, si può tramutare questo piccolo gioiello da &lt;a href="http://www.ebay.it/sch/i.html?LH_AvailTo=101&amp;amp;_nkw=tp-link+tl-wr703n&amp;amp;_trkparms=65%253A12%257C66%253A2%257C39%253A1%257C72%253A6366&amp;amp;rt=nc&amp;amp;_trksid=p3286.c0.m14&amp;amp;_sop=15&amp;amp;_sc=1"&gt;20€&lt;/a&gt; in un hub di rete mobile che, all'occorrenza, può anche diventare una stazione di Pentest.&lt;/p&gt;
&lt;p&gt;Questo è proprio il tipo di progetto da Hacker nel quale mi volevo cimentare. Il mio esperimento, al momento della scrittura di quest'articolo, non è ancora terminato, quindi racconterò fino a dove sono arrivato, dato che di intoppi se ne possono trovare a iosa!&lt;/p&gt;
&lt;p&gt;Per prima cosa mi sono sbarazzato del sistema OEM della TP-Link, facendo l'upload di un trunk di Openwrt che ora non è nemmeno disponibile (assimilato nella beta di &lt;a href="http://downloads.openwrt.org/attitude_adjustment/"&gt;attitude_adjustment&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;Ovviamente come tutti i trunk che si rispettino il boot usciva con errore, lasciando la piccola schedina verde a lampeggiare senza vita. Io non sapevo cosa stesse succedendo, dato che non c'è nessun uscita monitor e non sapevo come avviare in &lt;em&gt;failsafe&lt;/em&gt; mode.&lt;/p&gt;
&lt;p&gt;Per risolvere mi sono subito dato da fare per munirmi di una connessione seriale e poter vedere da terminale cosa non andava nel mio router. Per prima cosa, mi sono munito di un chip usb-rs232 che si può trovare sempre su ebay a 2/3 €; io ho acquistato &lt;a href="http://www.ebay.it/itm/USB-2-0-to-UART-TTL-6PIN-Connector-Module-Serial-Converter-CP2102-New-/190685792376?pt=LH_DefaultDomain_0&amp;amp;hash=item2c65c24878#ht_3725wt_1275"&gt;questo&lt;/a&gt;, che è stato letto senza problemi dalla mia Arch come CP210x. Ne esistono una marea, anche per meno di 1€, vedete voi se il chip va bene.&lt;/p&gt;
&lt;p&gt;La cosa difficile di saldare sti tre benedetti connettori è che la scheda è talmente piccola che anche la saldatura è in condizioni davvero difficili. La foto mostra i punti dove saldare RX,TX e GND (ricordate di collegare i fili in maniera pari: Dx-Dx Rx-Rx) che sono davvero minuscoli.&lt;/p&gt;
&lt;p&gt;&lt;img alt="WR703NSerial" src="https://www.j0llyb0x.org/images/openwrt-2.jpg"&gt;&lt;/p&gt;
&lt;p&gt;Facendo come nell'immagine, si può anche alimentare il wr703n direttamente con la seriale, ma questa è una cosa che non mi interessava ed ho preferito attaccare solamente i tre cavi di connessione principali.&lt;/p&gt;
&lt;p&gt;Con la nuova connessione seriale ho potuto vedermi il boot del router, grazie a &lt;a href="http://en.wikipedia.org/wiki/Minicom"&gt;minicom&lt;/a&gt; settata con questi parametri:&lt;/p&gt;
&lt;p&gt;&lt;img alt="minicom" src="https://www.j0llyb0x.org/images/openwrt-3.png"&gt;&lt;/p&gt;
&lt;p&gt;Ed ecco il boot! Ho dimenticato di catturare una schermata, ma il boot si fermava sempre dopo aver tentato di caricare il modulo per usb 2.0 ehci. In realtà ero un pò disperato, non sapendo come comportarmi. La provvidenza è però arrivata: un paio di giorni dopo è arrivatala la &lt;a href="http://downloads.openwrt.org/attitude_adjustment/12.09-beta/ar71xx/generic/"&gt;release beta&lt;/a&gt; ufficiale che, dopo avr installato, ha risolto tutti i problemi. Fortunatamente infatti, avevo installato la versione con un filesystem ro come lo Squashfs, che permette di mantenere alcune funzionalità anche se si dovesse avere problemi col sistema.&lt;/p&gt;
&lt;p&gt;Nel WR703N, per entrare in modalità failsafe, è necessario che U-BOOT si inizializzi; dopo circa un paio di secondi dal caricamento del Kernel Openwrt lascia una finestra di 1 secondo circa per schiacciare la combinazione &lt;em&gt;F&lt;/em&gt;+Enter ed entrare in 'modalità sicura'.&lt;/p&gt;
&lt;p&gt;&lt;img alt="failsafe" src="https://www.j0llyb0x.org/images/openwrt-4.png"&gt;&lt;/p&gt;
&lt;p&gt;Dalla modalità sicura ho fatto un Telnet a 192.168.1.1 attaccando un cavo ethernet, creato una password di root&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;passwd&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;e fatto un scp:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;scp&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;~/&lt;/span&gt;&lt;span class="n"&gt;openwrtfile&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;sysupgrade&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bin&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;root&lt;/span&gt;&lt;span class="nv"&gt;@openwrt&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nl"&gt;lan&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;fileblahblah&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bin&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Ho fatto un bel upgrade e tanti saluti. Se doveste incontrare problemi insormontabili (dubito) c'è sempre il vecchio metodo del flash via &lt;a href="http://wiki.openwrt.org/doc/howto/generic.flashing.tftp"&gt;tftp&lt;/a&gt;: il WR703N ha U-BOOT con un client incorporato; usate quindi la guida generica e poi deviate nella parte con client tftp... Per entrare nel bootloader all'avvio dovete digitare 'tpl'+&lt;em&gt;enter&lt;/em&gt; nel mezzo secondo dopo aver dato corrente al router; vi apparirà una schermata come questa, da dove potrete seguire la guida per il flash via bootloader&lt;/p&gt;
&lt;p&gt;&lt;img alt="u-boot" src="https://www.j0llyb0x.org/images/openwrt-5.png"&gt;&lt;/p&gt;
&lt;p&gt;Ora che abbiamo Openwrt installato e funzionante.... è ora di riposare perché c'ho messo 4 ore di smadonnate e quindi il SETUP e la futura costruzione del minipowner sarà per i prossimi articoli.&lt;/p&gt;
&lt;p&gt;Spero sia stato utile anche perchè non ho trovato molto in lingua italiana riguardo a questo gioiellino e a come fare quello che sto facendo.&lt;/p&gt;
&lt;p&gt;Alla fase  2: _SETUP e tuning _di openwrt &lt;a href="http://downloads.openwrt.org/attitude_adjustment/"&gt;attitude_adjustment&lt;/a&gt;.&lt;/p&gt;</content><category term="openwrt"></category><category term="seriale"></category><category term="hacking"></category><category term="hardware"></category></entry><entry><title>Fast connection sharing</title><link href="https://www.j0llyb0x.org/2012/fast-connection-sharing.html" rel="alternate"></link><published>2012-03-29T00:00:00+02:00</published><updated>2012-03-29T00:00:00+02:00</updated><author><name>j0lly</name></author><id>tag:www.j0llyb0x.org,2012-03-29:/2012/fast-connection-sharing.html</id><summary type="html">&lt;p&gt;recentemente ho avuto la necessità di condividere una connessione 3g con 9 tra pc e mac avendo solamente il mio portatile e una chiavetta umts. Data la mia ignoranza ho dovuto smanettare per un paio di giorni, ma alla fine sono arrivato ad una conclusione decente della quale vorrei rendervi …&lt;/p&gt;</summary><content type="html">&lt;p&gt;recentemente ho avuto la necessità di condividere una connessione 3g con 9 tra pc e mac avendo solamente il mio portatile e una chiavetta umts. Data la mia ignoranza ho dovuto smanettare per un paio di giorni, ma alla fine sono arrivato ad una conclusione decente della quale vorrei rendervi partecipi. Ovviamente, questo metodo è adattabile per qualsiasi tipo condivisione, sul quale farò una guida un poco più generale. Nella pratica i passaggi che ho seguito sono essenzialmente 3:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;connettersi alla linea 3g:&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;preparare la scheda wireless alla condivisione;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;preparare l'OS a condividere la connessione;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Prima di tutto è necessario connettersi con un'interfaccia ad internet; per far ciò io ho utilizzato una&lt;/p&gt;
&lt;p&gt;chiavetta 3g, e con l'ausilio di &lt;a href="http://freecode.com/projects/wvdial"&gt;wvdial&lt;/a&gt; (&lt;a href="http://www.linuxcommand.org/man_pages/wvdial1.html"&gt;qui&lt;/a&gt; il README)ho allacciato una connessione ppp0 (point-to-point) al mio provider. Per l'utilizzo di wvdial è necessario settare i parametri specifici per ogni provider; fortunatamente ho trovato &lt;a href="http://www.istitutomajorana.it/index.php?option=com_content&amp;amp;task=view&amp;amp;id=1229&amp;amp;Itemid=69"&gt;questa&lt;/a&gt; pagina dove si possono trovare le configurazioni per le principali compagnie italiane.&lt;/p&gt;
&lt;p&gt;Fatto ciò si può passare alla messa a punto della scheda di rete che servirà a condividere la connessione con altri dispositivi.&lt;/p&gt;
&lt;p&gt;La scheda può essere di qualsiasi tipo, anche virtuale, ma nel mio caso avevo necessità di connettere 9 pc in una stanza, quindi ho usato la mia scheda wi-fi.&lt;/p&gt;
&lt;p&gt;Per prima cosa bisogna attivare l'interfaccia e assegnare un indirizzo e una maschera di rete; in secondo luogo va messa in ad-hoc mode (sarebbe stato meglio in master mode, ma non tutte le schede lo supportano) e selezionare un &lt;em&gt;essid&lt;/em&gt; per la connessione; in fine mettere una protezione: quest'ultimo passo è facoltativo perché l'unica protezione possibile via iwconfig è di tipo wep, tra l'altro non compatibile con tutti i sistemi, infatti io ho optato per una soluzione di filtraggio di indirizzi mac via iptables.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# &lt;span class="nv"&gt;Put&lt;/span&gt; &lt;span class="nv"&gt;the&lt;/span&gt; &lt;span class="nv"&gt;interface&lt;/span&gt; &lt;span class="nv"&gt;in&lt;/span&gt; &lt;span class="nv"&gt;Ad&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;hoc&lt;/span&gt; &lt;span class="nv"&gt;mode&lt;/span&gt;
&lt;span class="nv"&gt;iwconfig&lt;/span&gt; &lt;span class="nv"&gt;wlan0&lt;/span&gt; &lt;span class="nv"&gt;mode&lt;/span&gt; &lt;span class="nv"&gt;Ad&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;Hoc&lt;/span&gt;

# &lt;span class="nv"&gt;Set&lt;/span&gt; &lt;span class="nv"&gt;the&lt;/span&gt; &lt;span class="nv"&gt;essid&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nv"&gt;the&lt;/span&gt; &lt;span class="nv"&gt;access&lt;/span&gt; &lt;span class="nv"&gt;point&lt;/span&gt;
&lt;span class="nv"&gt;iwconfig&lt;/span&gt; &lt;span class="nv"&gt;wlan0&lt;/span&gt; &lt;span class="nv"&gt;essid&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="s"&gt;_youressid_&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;

# &lt;span class="nv"&gt;Set&lt;/span&gt; &lt;span class="nv"&gt;auto&lt;/span&gt; &lt;span class="nv"&gt;channel&lt;/span&gt;
&lt;span class="nv"&gt;iwconfig&lt;/span&gt; &lt;span class="nv"&gt;wlan0&lt;/span&gt; &lt;span class="nv"&gt;channel&lt;/span&gt; &lt;span class="nv"&gt;auto&lt;/span&gt;

# &lt;span class="nv"&gt;Set&lt;/span&gt; &lt;span class="nv"&gt;the&lt;/span&gt; &lt;span class="nv"&gt;security&lt;/span&gt; &lt;span class="ss"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;WEP&lt;/span&gt;&lt;span class="ss"&gt;)&lt;/span&gt;

# &lt;span class="nv"&gt;Set&lt;/span&gt; &lt;span class="nv"&gt;Key&lt;/span&gt;
&lt;span class="nv"&gt;iwconfig&lt;/span&gt; &lt;span class="nv"&gt;wlan0&lt;/span&gt; &lt;span class="nv"&gt;key&lt;/span&gt; &lt;span class="nv"&gt;restricted&lt;/span&gt; &lt;span class="nv"&gt;s&lt;/span&gt;:&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="s"&gt;_yourpassword_&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;

# &lt;span class="nv"&gt;Set&lt;/span&gt; &lt;span class="nv"&gt;encryption&lt;/span&gt;
&lt;span class="nv"&gt;iwconfig&lt;/span&gt; &lt;span class="nv"&gt;wlan0&lt;/span&gt; &lt;span class="nv"&gt;key&lt;/span&gt; &lt;span class="nv"&gt;on&lt;/span&gt;

&lt;span class="nv"&gt;ifconfig&lt;/span&gt; &lt;span class="nv"&gt;wlan0&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="s"&gt;_chosenip_&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;24&lt;/span&gt; &lt;span class="nv"&gt;netmask&lt;/span&gt; &lt;span class="mi"&gt;255&lt;/span&gt;.&lt;span class="mi"&gt;255&lt;/span&gt;.&lt;span class="mi"&gt;255&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="nv"&gt;up&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Ovviamente dovete sostituire a wlan0 il nome della vostra interfaccia, e scegliere essid, password e indirizzo ip per l'interfaccia.&lt;/p&gt;
&lt;p&gt;Un passaggio opzionale è quello di gestire i clients con un server  DHCP, usando dnsmasq:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bin&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dnsmasq&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="k"&gt;C&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dev&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="k"&gt;null&lt;/span&gt; &lt;span class="err"&gt;\&lt;/span&gt;
&lt;span class="c1"&gt;--domain-needed \&lt;/span&gt;
&lt;span class="c1"&gt;--bogus-priv \&lt;/span&gt;
&lt;span class="c1"&gt;--interface=wlan0 \&lt;/span&gt;
&lt;span class="c1"&gt;--dhcp-option=6,8.8.8.8,8.8.4.4 \&lt;/span&gt;
&lt;span class="c1"&gt;--listen-address=&amp;quot;_chosenip_&amp;quot; \&lt;/span&gt;
&lt;span class="c1"&gt;--dhcp-range=&amp;quot;_chosenrange_&amp;quot;,12h&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Potete passare questo codice in uno script ed eseguirlo; da notare che in listen-address è necessario mettere lo stesso indirizzo usato in precedenza, mentre in dhcp-range bisogna semplicemente scegliere il numero e l'intervallo di indirizzi da assegnare tramite dhcp (per esempio 192.168.1.2,192.168.1.254).&lt;/p&gt;
&lt;p&gt;Ora che avete una connessione attiva ed un'interfaccia correttamente settata per fare da access point, non vi resta che organizzare l'OS in maniera da condividere la connessione:&lt;/p&gt;
&lt;p&gt;per prima cosa bisogna impostare il kernel in maniera da forwardare il traffico con questo comando:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt; &lt;span class="n"&gt;sysctl&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;w&lt;/span&gt; &lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ipv4&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ip_forward&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Dove 1 sta per attivo e 0 per inibito. In secondo luogo bisogna utilizzare iptables per forwardare un'interfaccia verso l'altra, e per creare una nat sull'interfaccia connessa ad internet. In questo caso consideriamo ppp0 l'interfaccia connessa ad internet mentre wlan0 quella che farà da access point:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;sudo&lt;/span&gt; &lt;span class="n"&gt;iptables&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="n"&gt;nat&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="n"&gt;POSTROUTING&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;o&lt;/span&gt; &lt;span class="n"&gt;ppp0&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="n"&gt;MASQUERADE&lt;/span&gt;

&lt;span class="n"&gt;sudo&lt;/span&gt; &lt;span class="n"&gt;iptables&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="k"&gt;FORWARD&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="n"&gt;wlan0&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="n"&gt;ACCEPT&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;per correttezza, qua è segnata una policy ACCEPT all, mentre sarebbe molto meglio, come ho anch'io fatto, impostare una policy per accettare uno ad uno i pc tramite indirizzo mac, e successivamente una policy DROP all per le rimanenti connessioni:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;sudo&lt;/span&gt; &lt;span class="n"&gt;iptables&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="k"&gt;FORWARD&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="n"&gt;wlan0&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="n"&gt;mac&lt;/span&gt; &lt;span class="c1"&gt;--mac-source &amp;quot;_macaddresstoaccept_&amp;quot; -j ACCEPT&lt;/span&gt;
&lt;span class="n"&gt;sudo&lt;/span&gt; &lt;span class="n"&gt;iptables&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="k"&gt;FORWARD&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="n"&gt;wlan0&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="k"&gt;DROP&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Ricordatevi che è importante inserire prima i filtri agli indirizzi mac, e poi la policy deny, se no iptables bloccherà tutto prima ancora di leggere quali indirizzi accettare.&lt;/p&gt;
&lt;p&gt;Sinceramente, ho collezionato un paio di scripts trovati in rete (sfortunatamente non ho recuperato tutte le fonti) e le ho modificate per le mie necessità, quindi vi posto lo script che, tra l'altro, spero di sviluppare per rendere un poco più carino e utile.&lt;/p&gt;
&lt;p&gt;&lt;a href="http://pastebin.com/AzA4NHYM"&gt;Qui&lt;/a&gt; il link, (alla riga 61 c'è  un riferimento ad impostazioni iptables salvate con anche una lista di mac address)  non dimenticate di renderlo eseguibile e di lanciarlo con privilegi di root.&lt;/p&gt;
&lt;p&gt;Fatemi sapere se lo trovate utile, e soprattutto se avete qualche suggerimento per migliorarlo.
P.S.&lt;/p&gt;
&lt;p&gt;Ammetto che la limitazione di una protezione wep o mac filtering è molto limitante, ma lo script è per uno sharing volante; cercherò di implementare l'uso di protezione wpa, o più semplicemente farò un tutorial per l'uso di &lt;a href="http://hostap.epitest.fi/hostapd/"&gt;hostapd&lt;/a&gt; che implementa già moltissime &lt;em&gt;features&lt;/em&gt;.&lt;/p&gt;</content><category term="bash"></category><category term="network"></category></entry><entry><title>Downgrade a package in ubuntu [clean way]</title><link href="https://www.j0llyb0x.org/2012/downgrade-a-package-in-ubuntu-clean-way.html" rel="alternate"></link><published>2012-02-22T10:20:00+01:00</published><updated>2012-02-22T10:20:00+01:00</updated><author><name>j0lly</name></author><id>tag:www.j0llyb0x.org,2012-02-22:/2012/downgrade-a-package-in-ubuntu-clean-way.html</id><summary type="html">&lt;p&gt;Da ora in avanti sarò terrorizzato dagli update: Semplice update di php-cgi=il server diventa immensamente lento, le pagine php non si aprono più, e con un traffico di 2 persone il server cade!!
Bene, per chi necessitasse come me un metodo rapido per il downgrade su piattaforma Debian, non …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Da ora in avanti sarò terrorizzato dagli update: Semplice update di php-cgi=il server diventa immensamente lento, le pagine php non si aprono più, e con un traffico di 2 persone il server cade!!
Bene, per chi necessitasse come me un metodo rapido per il downgrade su piattaforma Debian, non c'è niente di più facile:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;#&lt;/span&gt; &lt;span class="n"&gt;apt&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="k"&gt;cache&lt;/span&gt; &lt;span class="n"&gt;showpkg&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;pacchetto&lt;/span&gt; &lt;span class="n"&gt;da&lt;/span&gt; &lt;span class="n"&gt;downgradare&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Scegliere la versione che più ci aggrada, ed installarla:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;apt&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="k"&gt;get&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;install&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;package&lt;/span&gt;&lt;span class="o"&gt;]=&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="err"&gt;°&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;di&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;verione&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Tutto qui, anche se devo dire che ci ho messo un po per capire che era stato il pacchetto appena installato e non un problema da qualche altra parte nelle configurazioni.&lt;/p&gt;</content><category term="ubuntu"></category><category term="apt"></category><category term="debian"></category></entry><entry><title>[GUIDA] DNS Tunnel with Iodine PARTE II</title><link href="https://www.j0llyb0x.org/2012/guida-dns-tunnel-with-iodine-parte-ii.html" rel="alternate"></link><published>2012-01-15T00:00:00+01:00</published><updated>2012-01-15T00:00:00+01:00</updated><author><name>j0lly</name></author><id>tag:www.j0llyb0x.org,2012-01-15:/2012/guida-dns-tunnel-with-iodine-parte-ii.html</id><summary type="html">&lt;p&gt;Se non sapete cos'è un DNS o un tunnel, leggetevi &lt;a href="http://j0llyb0x.org/intro-dns-tunnel-con-iodine-01-2012/"&gt;l'articolo&lt;/a&gt; introduttivo sul DNS tunneling.&lt;/p&gt;
&lt;p&gt;Prima di tutto presentiamo Iodine:&lt;/p&gt;
&lt;blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;This&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;piece&lt;/span&gt; &lt;span class="k"&gt;of&lt;/span&gt; &lt;span class="n"&gt;software&lt;/span&gt; &lt;span class="n"&gt;that&lt;/span&gt; &lt;span class="n"&gt;lets&lt;/span&gt; &lt;span class="n"&gt;you&lt;/span&gt; &lt;span class="n"&gt;tunnel&lt;/span&gt; &lt;span class="n"&gt;IPv4&lt;/span&gt; &lt;span class="k"&gt;data&lt;/span&gt; &lt;span class="n"&gt;through&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;DNS&lt;/span&gt;
&lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt; &lt;span class="n"&gt;This&lt;/span&gt; &lt;span class="n"&gt;can&lt;/span&gt; &lt;span class="n"&gt;be&lt;/span&gt; &lt;span class="n"&gt;usable&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="n"&gt;different&lt;/span&gt; &lt;span class="n"&gt;situations&lt;/span&gt; &lt;span class="k"&gt;where&lt;/span&gt; &lt;span class="n"&gt;internet&lt;/span&gt; &lt;span class="k"&gt;access&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
&lt;span class="n"&gt;firewalled&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;but&lt;/span&gt; &lt;span class="n"&gt;DNS …&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/blockquote&gt;</summary><content type="html">&lt;p&gt;Se non sapete cos'è un DNS o un tunnel, leggetevi &lt;a href="http://j0llyb0x.org/intro-dns-tunnel-con-iodine-01-2012/"&gt;l'articolo&lt;/a&gt; introduttivo sul DNS tunneling.&lt;/p&gt;
&lt;p&gt;Prima di tutto presentiamo Iodine:&lt;/p&gt;
&lt;blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;This&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;piece&lt;/span&gt; &lt;span class="k"&gt;of&lt;/span&gt; &lt;span class="n"&gt;software&lt;/span&gt; &lt;span class="n"&gt;that&lt;/span&gt; &lt;span class="n"&gt;lets&lt;/span&gt; &lt;span class="n"&gt;you&lt;/span&gt; &lt;span class="n"&gt;tunnel&lt;/span&gt; &lt;span class="n"&gt;IPv4&lt;/span&gt; &lt;span class="k"&gt;data&lt;/span&gt; &lt;span class="n"&gt;through&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;DNS&lt;/span&gt;
&lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt; &lt;span class="n"&gt;This&lt;/span&gt; &lt;span class="n"&gt;can&lt;/span&gt; &lt;span class="n"&gt;be&lt;/span&gt; &lt;span class="n"&gt;usable&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="n"&gt;different&lt;/span&gt; &lt;span class="n"&gt;situations&lt;/span&gt; &lt;span class="k"&gt;where&lt;/span&gt; &lt;span class="n"&gt;internet&lt;/span&gt; &lt;span class="k"&gt;access&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
&lt;span class="n"&gt;firewalled&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;but&lt;/span&gt; &lt;span class="n"&gt;DNS&lt;/span&gt; &lt;span class="n"&gt;queries&lt;/span&gt; &lt;span class="k"&gt;are&lt;/span&gt; &lt;span class="n"&gt;allowed&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;/blockquote&gt;
&lt;p&gt;Andate nella &lt;a href="http://code.kryo.se/iodine/"&gt;homepage&lt;/a&gt; e scaricate l'ultima versione, disponibile per praticamente tutti i sistemi operativi!&lt;/p&gt;
&lt;p&gt;Se siete su OSX avete un paio di opzioni; o vi installate una macchina virtuale con &lt;a href="https://www.virtualbox.org/"&gt;virtualbox&lt;/a&gt;, magari &lt;a href="http://www.backtrack-linux.org/"&gt;Back|Track&lt;/a&gt; così iodine ve lo trovate già dentro, o vi scaricate Xcode dall'apple store e procedete con un semplice "sudo &lt;em&gt;make &amp;amp; make install&lt;/em&gt;", oppure vi installate &lt;a href="https://github.com/mxcl/homebrew"&gt;homebrew&lt;/a&gt; e lo utilizzate da lì. Queste sono le opzioni che ritengo più comode per avere questo programma in OSX.&lt;/p&gt;
&lt;p&gt;Tenete conto che il programma è formato da due parti, il client e il server; ovviamente dovete avere un computer con un Iodine server in attesa di una connessione, come ne ho parlato nel post precedente.&lt;/p&gt;
&lt;p&gt;I comandi per lanciare il server (Iodined) sono:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;iodined&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;miodominio&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;L'ip è la maschera che darete alla vostra rete virtuale (o tunnel), mentre il dominio è quello fittizio al quale il server è stato delegato (x.yourdomain.org).&lt;/p&gt;
&lt;p&gt;P.S. è necessario possedere i permessi di amministratore per gestire iodine;&lt;/p&gt;
&lt;p&gt;P.P.S Sul server (linux) dovrete anche settare l'ip forwarding se volete usare un tunnel ssh direttamente dalla stessa macchina dove gira Iodined; da root digitate:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;echo&lt;/span&gt; &lt;span class="ss"&gt;&amp;quot;1&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;proc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ipv4&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ip_forward&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Ora non vi resta che lanciare il client dalla macchina dalla quale volete instaurare il tunnel &lt;em&gt;et voilà&lt;/em&gt;, tunnel servito!&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;sudo&lt;/span&gt; &lt;span class="n"&gt;iodine&lt;/span&gt; &lt;span class="n"&gt;ipserveriodined&lt;/span&gt;  &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;miodominio&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Ora, tutto questo procedimento risulterebbe inutile se la rete fosse patchata, quindi è sempre buona norma darsi conto di che tipo di rete abbiamo di fronte. Le possibilità sono pressappoco tre:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;il gateway permette query DNS di ogni tipo e senza restrizioni: non è nemmeno necessario avere un dominio perché è sufficiente dare un nome fittizio da ricercare (es.&lt;em&gt; iodined 10.0.0.1 pinco.pallino&lt;/em&gt; e ovviamente lo stesso per il client);&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;il gateway permette query DNS solamente ad alcuni server o solo al server DNS interno: in questo caso bisogna utilizzare il metodo esposto prima, con la particolarità che se il server DNS utilizzabile è solo quello del gateway (99% delle volte è il classico 192.168.1.1) bisognerà impostare quello come indirizzo per il tunnel (es. iodine 192.168.1.1 a.mydomain.com);&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;La terza opzione è che il muro sia solido e ben costruito, e quindi vi attaccate e pagate il provider 5 € per mezz'ora di internet!&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Per capire il livello di sicurezza bastano un paio di &lt;em&gt;nslookup&lt;/em&gt; o &lt;em&gt;dig&lt;/em&gt; come spiegato &lt;a href="http://dev.kryo.se/iodine/wiki/HowtoSetup"&gt;qua&lt;/a&gt;!&lt;/p&gt;
&lt;p&gt;Questo è all'incirca quanto si deve sapere per avere un tunnel sempre pronto a portata di mano. Alcuni accorgimenti da seguire potrebbero essere:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;utilizzare la funzione password implementata in Iodine, anche se è una protezione piuttosto blanda;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;limitare le connessioni al server Iodined;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;l'accorgimento più importante è comunque utilizzare una connessione ssh per criptare il flusso di dati che, per questo protocollo, resterebbero se no sempre in chiaro!&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Quindi, per concludere le operazioni, il comando ssh per instaurare un "tunnel nel tunnel" è:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;ssh&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;fN&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;CD&lt;/span&gt; &lt;span class="n"&gt;xxxx&lt;/span&gt; &lt;span class="n"&gt;username&lt;/span&gt;&lt;span class="mf"&gt;@10.0.0.1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;I comandi stanno a significare che ssh deve andare in background (-f) anche senza comandi (-N) e deve instaurare una connessione compressa (-C) e fare un bind (-D) sulla porta locale xxxx (scegliete una porta non standard, magari alta come una 64000 o giù di lì).&lt;/p&gt;
&lt;p&gt;Ecco fatto, ora settate per bene il proxy sul vostro browser con la porta da voi scelta ed avrete una navigazione criptata e free, provare per credere!&lt;/p&gt;
&lt;p&gt;allego schermata:&lt;/p&gt;
&lt;p&gt;&lt;img alt="settings" src="https://www.j0llyb0x.org/images/iodine2-1.jpg"&gt;&lt;/p&gt;
&lt;p&gt;o con firerefox&lt;/p&gt;
&lt;p&gt;&lt;img alt="settings" src="https://www.j0llyb0x.org/images/iodine2-2.jpg"&gt;&lt;/p&gt;
&lt;p&gt;per chrome la questione è un poco più complicata: dalle impostazioni proxy, venite reindirizzati alle preferenze generali di connessione del vostro sistema operativo e se cambiate il proxy questo vale per qualsiasi connessione e non solo per il browser; per questo, con chrome, vi consiglio un'estensione semplice semplice che vi permette di gestire il proxy solo per la navigazione: &lt;a href="https://chrome.google.com/webstore/detail/caehdcpeofiiigpdhbabniblemipncjj"&gt;proxy switchy&lt;/a&gt; vi permette di aggiungere il vostro bel socks proxy.&lt;/p&gt;
&lt;p&gt;&lt;img alt="switchy" src="https://www.j0llyb0x.org/images/iodine2-3.png"&gt;&lt;/p&gt;
&lt;p&gt;Molto bene, ore siete pronti per navigare in tranquillità!&lt;/p&gt;
&lt;p&gt;fonti:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href="http://bottiger.org/wrote/29-Tunneling-traffic-through-DNS-using-Iodine-for-fun-and-profit"&gt;bottiger.org&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://otacon22.wordpress.com/2011/02/05/dns-tunneling/"&gt;octacon22&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://sadevil.org/blog/2008/07/07/iodine-dns-tunnel-on-your-mac-to-escape-those-evil-firewalls/"&gt;sadevil&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://dev.kryo.se/iodine/wiki/HowtoSetup"&gt;kryo.se&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;</content><category term="iodine"></category><category term="dns"></category><category term="hacking"></category></entry><entry><title>[GUIDA] DNS Tunnel con Iodine PARTE I</title><link href="https://www.j0llyb0x.org/2012/guida-dns-tunnel-con-iodine-parte-i.html" rel="alternate"></link><published>2012-01-05T00:00:00+01:00</published><updated>2012-01-05T00:00:00+01:00</updated><author><name>j0lly</name></author><id>tag:www.j0llyb0x.org,2012-01-05:/2012/guida-dns-tunnel-con-iodine-parte-i.html</id><summary type="html">&lt;p&gt;Per chi non lo sapesse, un tunnel DNS è una maniera per trasportare dati derivanti da altri protocolli attraverso  la porta 53 UDP, cioè poter far passare qualsiasi connessione (ad esempio ssh od http)  attraverso una porta non convenzionale cioè..... un bel proxy tunnel che bypassa qualsiasi restrizione sulla porta …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Per chi non lo sapesse, un tunnel DNS è una maniera per trasportare dati derivanti da altri protocolli attraverso  la porta 53 UDP, cioè poter far passare qualsiasi connessione (ad esempio ssh od http)  attraverso una porta non convenzionale cioè..... un bel proxy tunnel che bypassa qualsiasi restrizione sulla porta 80/433 (un hotspot per intenderci).&lt;/p&gt;
&lt;p&gt;Per le note legali, ricordo di leggere il &lt;a href="http://j0llyb0x.org/disclaimer/"&gt;disclamer&lt;/a&gt; del blog&lt;/p&gt;
&lt;p&gt;Alt, un passo indietro: cosa è un DNS?&lt;/p&gt;
&lt;p&gt;Il Domain Name System è il sistema mondiale, attivo dal 1987, per identificare gli IP delle macchine tramite nomi a dominio, molto più leggibili e memorizzabili dalla mente umana.&lt;/p&gt;
&lt;p&gt;Ammetto che l'argomento non è nuovo; in realtà già nel 2000 se ne parlava in alcuni ambienti e nel 2005  Dan Kaminsky aveva già realizzato un programma in perl per l'implementazione del protocollo utilizzato per questo tipo di tunnel, il "NSTX" (Name Server Transfer Protocol) chiamato OzymanDNS.&lt;/p&gt;
&lt;p&gt;Il programma che utilizzo e del quale parlerò è &lt;a href="http://code.kryo.se/iodine/"&gt;Iodin&lt;/a&gt;&lt;a href="http://code.kryo.se/iodine/"&gt;e&lt;/a&gt;, già inserito in molte distro di pentest come &lt;a href="http://www.backtrack-linux.org/backtrack/backtrack-5-release/"&gt;BackTrack&lt;/a&gt; e soprattutto nella maggioranza dei repository di qualsiasi distro con una community minimamente attiva. Il programma è utilizzabile su praticamente qualsiasi piattaforma (io l'ho provato su Linux, OSX e Windows) e, dai post letti qua e là per il web è ad oggi l'implementazione del protocollo NSTX che riesce a garantire più stabilità e prestazioni rispetto ad altre &lt;a href="http://en.cship.org/wiki/DNS_tunnel"&gt;alternative&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Ma come funziona Il DNS è perché dovremmo parlarne in questo ambito?&lt;/p&gt;
&lt;p&gt;Allora, il Domain Name System è il più grande database distribuito del pianeta che serve; la sua funzione è principalmente di associare a ciascun ip fisico un nome di dominio che serva ad identificarlo e memorizzarlo più facilmente per l'essere umano. queste richieste possono essere fatte da programmi o da altri server DNS; questo perché, come detto prima, il sistema è formato in maniera distribuita e gerarchica dove esistono 13 Root server che si occupano dei domini di 1° livello (&lt;em&gt;.org, &lt;/em&gt;.com, *.net etc.) e demandano ad altri server la risoluzione dei domini di 2°, 3° livello e così via.&lt;/p&gt;
&lt;p&gt;&lt;img alt="dns" src="https://www.j0llyb0x.org/images/iodine-1.png"&gt;&lt;/p&gt;
&lt;p&gt;La domanda sorge spontanea: e cosa ce ne facciamo di sta roba?&lt;/p&gt;
&lt;p&gt;Semplice, con un pò di settaggi potremo avere il nostro tunnel personale, poco controllato e perfettamente criptato, per navigare in tutta sicurezza in giro per il globo.&lt;/p&gt;
&lt;p&gt;Forse sono stato un po ottimista, ma ad oggi (più di 11 anni dalla scoperta) sono poche le compagnie che controllano questo tipo di cose.&lt;/p&gt;
&lt;p&gt;La parte più difficile da settare per questo tipo di tunnel è proprio il nameserver e i records del dominio, quindi cominceremo proprio da qua!&lt;/p&gt;
&lt;p&gt;Nel mio caso ho acquistato un dominio su Godaddy per 6$ l'anno (assicuratevi che il vostro registrar vi dia il controllo sui record DNS del vostro dominio o andate &lt;a href="https://web.gratisdns.dk/"&gt;qua&lt;/a&gt; per farveli hostare) ed ho semplicemente aggiunto un subdominio (ns.miodominio.com) con un A record, ed l'ho assegnato come nameserver per un subdominio fittizio (x.miodominio.com); in questo modo, in qualsiasi parte del mondo io sia, se faccio una quary per il subdominio fittizio (x.miodominio.com), i vari server DNS finiranno per chiedere al mio subdominio (ns.miodominio.com) dove esso sia!&lt;/p&gt;
&lt;p&gt;&lt;img alt="screen" src="https://www.j0llyb0x.org/images/iodine-2.png"&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="screen" src="https://www.j0llyb0x.org/images/iodine-3.png"&gt;&lt;/p&gt;
&lt;p&gt;ovviamente al posto di &lt;em&gt;yourip&lt;/em&gt; ci sarà il vostro ip statico (magari comprato tramite un &lt;a href="http://www.lowendbox.com/"&gt;vps economico&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;Ora che avete settato questi parametri non vi resta che attendere, perché per delegare ns.miodominio.com come nameserver per x.miodominio.com esso deve essere "propagato" verso i DNS server superiori e ci potrebbe volere fino ad 1 giorno o 2, anche se in genere il processo viene eseguito in meno di un'ora.&lt;/p&gt;
&lt;p&gt;Bene, questa era la parte più complicata e che mi è costata un poco intendere al principio, ma ora che siamo pronti potremo utilizzare vari metodi per sfruttare questo tunnel.&lt;/p&gt;
&lt;p&gt;PS&lt;/p&gt;
&lt;p&gt;Se state cercando di hostare il vostro fake DNS server su un router o su qualsiasi sistema con IP dinamico, potete saltare la parte del record A e settare come NS record il vostro dominio &lt;a href="http://www.no-ip.com/"&gt;no-ip&lt;/a&gt; o &lt;a href="http://dyn.com/dns/dyndns-free/"&gt;dyndns&lt;/a&gt; che punta al benedetto server.&lt;/p&gt;
&lt;p&gt;&lt;img alt="screen" src="https://www.j0llyb0x.org/images/iodine-4.png"&gt;&lt;/p&gt;
&lt;p&gt;Della parte tecnica rispetto a Iodine ne parlerò nel prossimo articolo perché questo mi sembra già abbastanza denso e lunghetto...&lt;/p&gt;
&lt;p&gt;fonti:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href="http://www.h-i-r.net/2010/03/dns-tunneling-part-1-intro-and.html"&gt;hir.net&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://dnstunnel.de/"&gt;dnstunnel&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://www.slideshare.net/bsideslondon/dns-tunnelling-its-all-in-the-name"&gt;slideshare&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://bottiger.org/wrote/29-Tunneling-traffic-through-DNS-using-Iodine-for-fun-and-profit"&gt;bottiger&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;</content><category term="iodine"></category><category term="hacking"></category><category term="dns"></category></entry><entry><title>Disable WordPress buggy plugins</title><link href="https://www.j0llyb0x.org/2011/disable-wordpress-buggy-plugins.html" rel="alternate"></link><published>2011-12-27T00:00:00+01:00</published><updated>2011-12-27T00:00:00+01:00</updated><author><name>j0lly</name></author><id>tag:www.j0llyb0x.org,2011-12-27:/2011/disable-wordpress-buggy-plugins.html</id><summary type="html">&lt;p&gt;Ieri mentre cercavo di scrivere il mio primo post ho attivato un plugin non compatibile con il tema; il risultato è stato una schermata bianca che mi impedisce di disattivare il plugin galeotto!&lt;/p&gt;
&lt;p&gt;La prima cosa che si dovrebbe fare è  rinominare la cartella dei plugins all'interno di WordPress; in …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Ieri mentre cercavo di scrivere il mio primo post ho attivato un plugin non compatibile con il tema; il risultato è stato una schermata bianca che mi impedisce di disattivare il plugin galeotto!&lt;/p&gt;
&lt;p&gt;La prima cosa che si dovrebbe fare è  rinominare la cartella dei plugins all'interno di WordPress; in questo modo tutti i plugins saranno disattivati.&lt;/p&gt;
&lt;p&gt;Se però la vostra situazione è un pò più complicata, o non avete un servizio ftp/ssh attivo, potete disabilitare i plugins direttamente con una query al database di Wordpress; dopo qualche minuto di ricerca infatti ho trovato &lt;a href="http://perishablepress.com/press/2008/02/18/quickly-disable-or-enable-all-wordpress-plugins-via-the-database/"&gt;questa&lt;/a&gt; pagina nella quale spiega come fare.&lt;/p&gt;
&lt;p&gt;Per chi non mastica l'inglese (O.o) o non sa cos'è &lt;a href="http://translate.googleusercontent.com/translate_c?hl=it&amp;amp;ie=UTF8&amp;amp;prev=_t&amp;amp;rurl=translate.google.com&amp;amp;sl=en&amp;amp;tl=it&amp;amp;u=http://perishablepress.com/press/2008/02/18/quickly-disable-or-enable-all-wordpress-plugins-via-the-database/&amp;amp;usg=ALkJrhgOisBtO965xi0uML6RZYnNn0VtZA"&gt;google translate&lt;/a&gt;e (o.O) riassumo in due righe:&lt;/p&gt;
&lt;p&gt;Entrando in PhpMyAdmin bisogna fare questa query (tasto query del menu superiore dopo aver selezionato il database corretto) nel database di WordPress:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;UPDATE&lt;/span&gt; &lt;span class="nt"&gt;wp_options&lt;/span&gt; &lt;span class="nt"&gt;SET&lt;/span&gt; &lt;span class="nt"&gt;option_value&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;a:0:{}&amp;#39;&lt;/span&gt; &lt;span class="nt"&gt;WHERE&lt;/span&gt; &lt;span class="nt"&gt;option_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;active_plugins&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Tutto qui, La vostra dashboard sarà di nuovo operativa e potrete riattivare i plugins da essa, eliminando o editando il plugin non compatibile.&lt;/p&gt;
&lt;p&gt;Qualcuno potrà dire: "Io non ho phpMyAdmin, come cazzo faccio a fare la query??"&lt;/p&gt;
&lt;p&gt;Bene, niente di più facile, basta andare in shell e connettersi al database:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nv"&gt;mysql&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;u&lt;/span&gt; &lt;span class="nv"&gt;tuoutente&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;p&lt;/span&gt; &lt;span class="nv"&gt;tuapassword&lt;/span&gt;
&lt;span class="k"&gt;show&lt;/span&gt; &lt;span class="nv"&gt;databases&lt;/span&gt;&lt;span class="c1"&gt;;&lt;/span&gt;
&lt;span class="nv"&gt;use&lt;/span&gt; &lt;span class="nv"&gt;tuodatabase&lt;/span&gt;
&lt;span class="nv"&gt;SELECT&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="nv"&gt;FROM&lt;/span&gt; &lt;span class="nv"&gt;wp_options&lt;/span&gt; &lt;span class="nv"&gt;WHERE&lt;/span&gt; &lt;span class="nv"&gt;options_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;active_plugins&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="c1"&gt;;&lt;/span&gt;
&lt;span class="nv"&gt;UPDATE&lt;/span&gt; &lt;span class="nv"&gt;wp_options&lt;/span&gt; &lt;span class="nv"&gt;SET&lt;/span&gt; &lt;span class="nv"&gt;options_value&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;a:0:{}&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="nv"&gt;WHERE&lt;/span&gt; &lt;span class="nv"&gt;options_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;active_plugins&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Personalmente preferisco il secondo metodo, più diretto ed elegante, a mio parere.&lt;/p&gt;</content><category term="wordpress"></category><category term="mysql"></category><category term="sql"></category></entry></feed>